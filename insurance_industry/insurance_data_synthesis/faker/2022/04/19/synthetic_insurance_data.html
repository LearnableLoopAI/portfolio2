<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Synthetic Insurance Data</h1><p class="page-description">Using the faker package to generate synthetic data</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-04-19T00:00:00-05:00" itemprop="datePublished">
        Apr 19, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      24 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Insurance_Industry">Insurance_Industry</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Insurance_Data_Synthesis">Insurance_Data_Synthesis</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#faker">faker</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#1-PROBLEM">1 PROBLEM </a></li>
<li class="toc-entry toc-h1"><a href="#2-SOLUTION">2 SOLUTION </a></li>
<li class="toc-entry toc-h1"><a href="#3-IMPLEMENTATION">3 IMPLEMENTATION </a>
<ul>
<li class="toc-entry toc-h2"><a href="#3.1-Disease-Drug-mappings">3.1 Disease-Drug mappings </a></li>
<li class="toc-entry toc-h2"><a href="#3.2-Synthesize-diagnoses-table">3.2 Synthesize diagnoses table </a></li>
<li class="toc-entry toc-h2"><a href="#3.3-Synthesize-medications-table">3.3 Synthesize medications table </a></li>
<li class="toc-entry toc-h2"><a href="#3.4-Synthesize-claim_diagnosis-table">3.4 Synthesize claim_diagnosis table </a></li>
<li class="toc-entry toc-h2"><a href="#3.5-Synthesize-members-table">3.5 Synthesize members table </a></li>
<li class="toc-entry toc-h2"><a href="#3.6-Synthesize-payers-table">3.6 Synthesize payers table </a></li>
<li class="toc-entry toc-h2"><a href="#3.7-Synthesize-claims-table">3.7 Synthesize claims table </a></li>
<li class="toc-entry toc-h2"><a href="#3.8-Synthesize-member-diagnoses-table">3.8 Synthesize member-diagnoses table </a></li>
<li class="toc-entry toc-h2"><a href="#3.9-Inspect-synthesized-files">3.9 Inspect synthesized files </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-04-19-synthetic_insurance_data.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1-PROBLEM">
<a class="anchor" href="#1-PROBLEM" aria-hidden="true"><span class="octicon octicon-link"></span></a>1 PROBLEM<a class="anchor-link" href="#1-PROBLEM"> </a>
</h1>
<p>It is not always beneficial to make use of pre-existing datasets in the development of data products. To test a system under development, here are some problems that may come along:</p>
<ul>
<li>
<p>Data pipelines could be complicated entities that need to be tested thoroughly. The steps in such pipelines are not only for machine learning purposes but are often much broader, converting massive data sources, combining them, and presenting them for machine learning activities.</p>
</li>
<li>
<p>The amount of data in existing data sets may not be enough.</p>
</li>
<li>
<p>When testing for data cleaning and preprocessing functionality, there might be a need to test for specific conditions and anomalies that might not be sufficiently represented in an existing data set.</p>
</li>
<li>
<p>Confidentiality of data might be a real constraint. One example of this is intelectual property (IP) that needs to remain confidential. There are also items like social security numbers, credit card numbers, medical information, and other personal information.</p>
</li>
</ul>
<p>Existing data sets might be enhanced and adapted but this approach could be cost prohibitive. There is also the challenge to locate a starting data set to work from.</p>
<p>To address many of these needs one approach that comes to mind is to make up the data making use of a process called generation or synthesis. Such data is referred to as synthetic data. This approach has its own set of challenges but sometimes these are much less than searching for a good enough data set. A number of software systems exist that will generate very usable data. Such data might not be as ideal for machine learning purposes than data generated by real systems, but in the areas described above, may actually be more ideal.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2-SOLUTION">
<a class="anchor" href="#2-SOLUTION" aria-hidden="true"><span class="octicon octicon-link"></span></a>2 SOLUTION<a class="anchor-link" href="#2-SOLUTION"> </a>
</h1>
<p>In this project we will make use of the python faker package to help generate synthetic data. Not only do we want to generate 'clean' data, but we might choose to also introduce some anomalies and noise to make the synthetic data more realistic. This also gives us good control over the testing requirements of the system under construction.</p>
<p>From the faker package's documentation site, <a href="https://faker.readthedocs.io/">https://faker.readthedocs.io/</a>, we see that:</p>
<p>Faker is a Python package that generates fake data for you. Whether you need to bootstrap your database, create good-looking XML documents, fill-in your persistence to stress test it, or anonymize data taken from a production service, Faker is for you.</p>
<p>In our present context, we are going to generate synthetic data to populate a database representing the operations of a simple company that processes medical insurance claims. Figure 1 shows the UML diagram of the data model used by this company.</p>
<p><img src="/images/copied_from_nb/../images/SyntheticInsuranceData.png" alt="Figure 1 UML diagram of the data model" title="Figure 1 UML diagram of the data model"></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install faker
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: faker in /usr/local/lib/python3.7/dist-packages (13.6.0)
Requirement already satisfied: typing-extensions&gt;=3.10.0.2 in /usr/local/lib/python3.7/dist-packages (from faker) (4.2.0)
Requirement already satisfied: python-dateutil&gt;=2.4 in /usr/local/lib/python3.7/dist-packages (from faker) (2.8.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.4-&gt;faker) (1.15.0)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">faker</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'1.3.5'</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'1.21.6'</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="3-IMPLEMENTATION">
<a class="anchor" href="#3-IMPLEMENTATION" aria-hidden="true"><span class="octicon octicon-link"></span></a>3 IMPLEMENTATION<a class="anchor-link" href="#3-IMPLEMENTATION"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will generate data in dataframes and store each dataframe to a .csv file. These files can then be used to setup tables in a SQL database. During generation/synthesis we will make use of:</p>
<ul>
<li>faker functionality</li>
<li>pre-arranged data sources, e.g. list of insurance payers, and list of mappings between diseases and drugs</li>
</ul>
<p>After each table generation/synthesis, the table will be corrupted by</p>
<ul>
<li>introducing some missing values randomly</li>
<li>duplicating some rows randomly</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># setup Faker</span>
<span class="n">fake</span> <span class="o">=</span> <span class="n">faker</span><span class="o">.</span><span class="n">Faker</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># corruption functionality</span>
<span class="k">def</span> <span class="nf">corrupt_with_missing_values</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">missing_entry</span><span class="o">=</span><span class="s1">'N/A'</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
    <span class="n">missing_vals</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">prob</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">sample_cols</span><span class="p">)]</span> <span class="o">=</span> <span class="n">missing_entry</span>
            <span class="n">missing_vals</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of rows affected: </span><span class="si">{</span><span class="n">missing_vals</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>            
    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">corrupt_with_duplicate_rows</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
    <span class="n">dups</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>    
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">prob</span><span class="p">:</span>
            <span class="n">dups</span> <span class="o">=</span> <span class="n">dups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:])</span>
            <span class="c1">#dups = pd.concat([dups, df.loc[index, :]])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of duplicates added: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dups</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">dups</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.1-Disease-Drug-mappings">
<a class="anchor" href="#3.1-Disease-Drug-mappings" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.1 Disease-Drug mappings<a class="anchor-link" href="#3.1-Disease-Drug-mappings"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_dis_drg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s2">/DISEASE_DRUG_MAPPINGS.csv"</span><span class="p">)</span>
<span class="n">df_dis_drg</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-1620ba33-d151-49af-b2ca-1e36ded0f3cd">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>api_num</th>
      <th>disease</th>
      <th>drug</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Alkylating Agent Cystitis</td>
      <td>sodium bicarbonate</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Alkylating Agent Cystitis</td>
      <td>citric acid / sodium citrate</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Abdominal Distension</td>
      <td>bethanechol</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Abdominal Distension</td>
      <td>pamabrom</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Abdominal Distension</td>
      <td>bethanechol</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14678</th>
      <td>14677</td>
      <td>Zollinger-Ellison Syndrome</td>
      <td>lansoprazole</td>
    </tr>
    <tr>
      <th>14679</th>
      <td>14678</td>
      <td>Zollinger-Ellison Syndrome</td>
      <td>ranitidine</td>
    </tr>
    <tr>
      <th>14680</th>
      <td>14679</td>
      <td>Zollinger-Ellison Syndrome</td>
      <td>rabeprazole</td>
    </tr>
    <tr>
      <th>14681</th>
      <td>14680</td>
      <td>Zollinger-Ellison Syndrome</td>
      <td>cimetidine</td>
    </tr>
    <tr>
      <th>14682</th>
      <td>14681</td>
      <td>Zollinger-Ellison Syndrome</td>
      <td>esomeprazole</td>
    </tr>
  </tbody>
</table>
<p>14683 rows × 3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1620ba33-d151-49af-b2ca-1e36ded0f3cd')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-1620ba33-d151-49af-b2ca-1e36ded0f3cd button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-1620ba33-d151-49af-b2ca-1e36ded0f3cd');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.2-Synthesize-diagnoses-table">
<a class="anchor" href="#3.2-Synthesize-diagnoses-table" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2 Synthesize diagnoses table<a class="anchor-link" href="#3.2-Synthesize-diagnoses-table"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_dia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_dis_drg</span><span class="p">[</span><span class="s1">'disease'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">df_dia</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-26d50429-ef87-4c65-8f54-10019c427bf3">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alkylating Agent Cystitis</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Abdominal Distension</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Abdominal Distension Prior to Abdominal X-ray</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Abdominal Radiological Procedure</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Abnormal Uterine Bleeding</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>1503</th>
      <td>Xerostomia</td>
    </tr>
    <tr>
      <th>1504</th>
      <td>X-Linked Hypophosphatemia</td>
    </tr>
    <tr>
      <th>1505</th>
      <td>Yellow Fever Prophylaxis</td>
    </tr>
    <tr>
      <th>1506</th>
      <td>Zinc Deficiency</td>
    </tr>
    <tr>
      <th>1507</th>
      <td>Zollinger-Ellison Syndrome</td>
    </tr>
  </tbody>
</table>
<p>1508 rows × 1 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-26d50429-ef87-4c65-8f54-10019c427bf3')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-26d50429-ef87-4c65-8f54-10019c427bf3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-26d50429-ef87-4c65-8f54-10019c427bf3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_dia</span> <span class="o">=</span> <span class="n">df_dia</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_dia</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'diagnosis'</span><span class="p">]</span>
<span class="n">df_dia</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-aebd5bdb-ae97-4c55-bb7b-04dbc4bcae8a">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>diagnosis</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Alkylating Agent Cystitis</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Abdominal Distension</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Abdominal Distension Prior to Abdominal X-ray</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Abdominal Radiological Procedure</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Abnormal Uterine Bleeding</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1503</th>
      <td>1503</td>
      <td>Xerostomia</td>
    </tr>
    <tr>
      <th>1504</th>
      <td>1504</td>
      <td>X-Linked Hypophosphatemia</td>
    </tr>
    <tr>
      <th>1505</th>
      <td>1505</td>
      <td>Yellow Fever Prophylaxis</td>
    </tr>
    <tr>
      <th>1506</th>
      <td>1506</td>
      <td>Zinc Deficiency</td>
    </tr>
    <tr>
      <th>1507</th>
      <td>1507</td>
      <td>Zollinger-Ellison Syndrome</td>
    </tr>
  </tbody>
</table>
<p>1508 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-aebd5bdb-ae97-4c55-bb7b-04dbc4bcae8a')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-aebd5bdb-ae97-4c55-bb7b-04dbc4bcae8a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-aebd5bdb-ae97-4c55-bb7b-04dbc4bcae8a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_dia</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/diagnoses.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.3-Synthesize-medications-table">
<a class="anchor" href="#3.3-Synthesize-medications-table" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3 Synthesize medications table<a class="anchor-link" href="#3.3-Synthesize-medications-table"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_med</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_dis_drg</span><span class="p">[</span><span class="s1">'drug'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">df_med</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-017c4fd2-be93-4be6-9483-eb03d8ee6350">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>sodium bicarbonate</td>
    </tr>
    <tr>
      <th>1</th>
      <td>citric acid / sodium citrate</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bethanechol</td>
    </tr>
    <tr>
      <th>3</th>
      <td>pamabrom</td>
    </tr>
    <tr>
      <th>4</th>
      <td>vasopressin</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>1610</th>
      <td>zinc acetate</td>
    </tr>
    <tr>
      <th>1611</th>
      <td>trientine</td>
    </tr>
    <tr>
      <th>1612</th>
      <td>glycerin</td>
    </tr>
    <tr>
      <th>1613</th>
      <td>burosumab</td>
    </tr>
    <tr>
      <th>1614</th>
      <td>yellow fever vaccine</td>
    </tr>
  </tbody>
</table>
<p>1615 rows × 1 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-017c4fd2-be93-4be6-9483-eb03d8ee6350')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-017c4fd2-be93-4be6-9483-eb03d8ee6350 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-017c4fd2-be93-4be6-9483-eb03d8ee6350');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_med</span> <span class="o">=</span> <span class="n">df_med</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_med</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'medication'</span><span class="p">]</span>
<span class="n">df_med</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-1a539454-f9fd-4a0e-a0ea-407e2a964b12">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>medication</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>sodium bicarbonate</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>citric acid / sodium citrate</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>bethanechol</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>pamabrom</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>vasopressin</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1610</th>
      <td>1610</td>
      <td>zinc acetate</td>
    </tr>
    <tr>
      <th>1611</th>
      <td>1611</td>
      <td>trientine</td>
    </tr>
    <tr>
      <th>1612</th>
      <td>1612</td>
      <td>glycerin</td>
    </tr>
    <tr>
      <th>1613</th>
      <td>1613</td>
      <td>burosumab</td>
    </tr>
    <tr>
      <th>1614</th>
      <td>1614</td>
      <td>yellow fever vaccine</td>
    </tr>
  </tbody>
</table>
<p>1615 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1a539454-f9fd-4a0e-a0ea-407e2a964b12')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-1a539454-f9fd-4a0e-a0ea-407e2a964b12 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-1a539454-f9fd-4a0e-a0ea-407e2a964b12');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_med</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/medications.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.4-Synthesize-claim_diagnosis-table">
<a class="anchor" href="#3.4-Synthesize-claim_diagnosis-table" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4 Synthesize claim_diagnosis table<a class="anchor-link" href="#3.4-Synthesize-claim_diagnosis-table"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_dis_drg</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-ef958327-e08b-4a3b-8b61-68133b17342a">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>api_num</th>
      <th>disease</th>
      <th>drug</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Alkylating Agent Cystitis</td>
      <td>sodium bicarbonate</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Alkylating Agent Cystitis</td>
      <td>citric acid / sodium citrate</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Abdominal Distension</td>
      <td>bethanechol</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Abdominal Distension</td>
      <td>pamabrom</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Abdominal Distension</td>
      <td>bethanechol</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14678</th>
      <td>14677</td>
      <td>Zollinger-Ellison Syndrome</td>
      <td>lansoprazole</td>
    </tr>
    <tr>
      <th>14679</th>
      <td>14678</td>
      <td>Zollinger-Ellison Syndrome</td>
      <td>ranitidine</td>
    </tr>
    <tr>
      <th>14680</th>
      <td>14679</td>
      <td>Zollinger-Ellison Syndrome</td>
      <td>rabeprazole</td>
    </tr>
    <tr>
      <th>14681</th>
      <td>14680</td>
      <td>Zollinger-Ellison Syndrome</td>
      <td>cimetidine</td>
    </tr>
    <tr>
      <th>14682</th>
      <td>14681</td>
      <td>Zollinger-Ellison Syndrome</td>
      <td>esomeprazole</td>
    </tr>
  </tbody>
</table>
<p>14683 rows × 3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ef958327-e08b-4a3b-8b61-68133b17342a')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ef958327-e08b-4a3b-8b61-68133b17342a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ef958327-e08b-4a3b-8b61-68133b17342a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">diameds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">df_dis_drg</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">dia</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">'disease'</span><span class="p">];</span> <span class="n">med</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">'drug'</span><span class="p">]</span>
    <span class="n">dia_id</span> <span class="o">=</span> <span class="n">df_dia</span><span class="p">[</span><span class="n">df_dia</span><span class="p">[</span><span class="s1">'diagnosis'</span><span class="p">]</span><span class="o">==</span><span class="n">dia</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">med_id</span> <span class="o">=</span> <span class="n">df_med</span><span class="p">[</span><span class="n">df_med</span><span class="p">[</span><span class="s1">'medication'</span><span class="p">]</span><span class="o">==</span><span class="n">med</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">diameds</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">'diagnosis_id'</span><span class="p">:</span><span class="n">dia_id</span><span class="p">,</span>
        <span class="s1">'medication_id'</span><span class="p">:</span><span class="n">med_id</span><span class="p">},</span>
    <span class="p">)</span>
<span class="n">df_diamed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">diameds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_diamed</span> <span class="o">=</span> <span class="n">df_diamed</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_diamed</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'diagnosis_id'</span><span class="p">,</span> <span class="s1">'medication_id'</span><span class="p">]</span>
<span class="n">df_diamed</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-bdaddc45-ad77-430a-bb83-2f16a426899c">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>diagnosis_id</th>
      <th>medication_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14678</th>
      <td>14678</td>
      <td>1507</td>
      <td>219</td>
    </tr>
    <tr>
      <th>14679</th>
      <td>14679</td>
      <td>1507</td>
      <td>684</td>
    </tr>
    <tr>
      <th>14680</th>
      <td>14680</td>
      <td>1507</td>
      <td>397</td>
    </tr>
    <tr>
      <th>14681</th>
      <td>14681</td>
      <td>1507</td>
      <td>489</td>
    </tr>
    <tr>
      <th>14682</th>
      <td>14682</td>
      <td>1507</td>
      <td>396</td>
    </tr>
  </tbody>
</table>
<p>14683 rows × 3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bdaddc45-ad77-430a-bb83-2f16a426899c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bdaddc45-ad77-430a-bb83-2f16a426899c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bdaddc45-ad77-430a-bb83-2f16a426899c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_diamed</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/claim_diagnosis.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.5-Synthesize-members-table">
<a class="anchor" href="#3.5-Synthesize-members-table" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.5 Synthesize members table<a class="anchor-link" href="#3.5-Synthesize-members-table"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_name_parts</span><span class="p">(</span><span class="n">name_string</span><span class="p">):</span>
    <span class="n">name_parts</span> <span class="o">=</span> <span class="n">name_string</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_parts</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">name_parts</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Not used: </span><span class="si">{</span><span class="n">name_parts</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_members</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">fake_members</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
        <span class="n">prof</span> <span class="o">=</span> <span class="n">fake</span><span class="o">.</span><span class="n">profile</span><span class="p">()</span>
        <span class="c1">#last and first names</span>
        <span class="n">name_parts</span> <span class="o">=</span> <span class="n">get_name_parts</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s1">'name'</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">name_parts</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="k">continue</span>
        <span class="c1">#previous names</span>
        <span class="n">prev_name_prob</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="n">cur_gender</span> <span class="o">=</span> <span class="n">prof</span><span class="p">[</span><span class="s1">'sex'</span><span class="p">]</span>
            <span class="n">prof_prev_name</span> <span class="o">=</span> <span class="n">fake</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">sex</span><span class="o">=</span><span class="n">cur_gender</span><span class="p">)</span>
            <span class="n">prev_name_parts</span> <span class="o">=</span> <span class="n">get_name_parts</span><span class="p">(</span><span class="n">prof_prev_name</span><span class="p">[</span><span class="s1">'name'</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">prev_name_parts</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
                <span class="n">prev_name</span> <span class="o">=</span> <span class="s1">''</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prev_name</span> <span class="o">=</span> <span class="n">prev_name_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">' '</span><span class="o">+</span><span class="n">prev_name_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prev_name</span> <span class="o">=</span> <span class="s1">''</span>
        <span class="n">fake_members</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">'last_name'</span><span class="p">:</span> <span class="n">name_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">'first_name'</span><span class="p">:</span> <span class="n">name_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">'previous_name'</span><span class="p">:</span><span class="n">prev_name</span><span class="p">,</span>
            <span class="s1">'birth_date'</span><span class="p">:</span><span class="n">prof</span><span class="p">[</span><span class="s1">'birthdate'</span><span class="p">],</span>
            <span class="s1">'sex'</span><span class="p">:</span><span class="n">prof</span><span class="p">[</span><span class="s1">'sex'</span><span class="p">],</span>
            <span class="s1">'address'</span><span class="p">:</span><span class="n">prof</span><span class="p">[</span><span class="s1">'address'</span><span class="p">],</span>
            <span class="s1">'phone_number'</span><span class="p">:</span><span class="n">fake</span><span class="o">.</span><span class="n">phone_number</span><span class="p">(),</span>
            <span class="s1">'email_address'</span><span class="p">:</span><span class="n">prof</span><span class="p">[</span><span class="s1">'mail'</span><span class="p">],</span>
            <span class="s1">'user_name'</span><span class="p">:</span><span class="n">prof</span><span class="p">[</span><span class="s1">'username'</span><span class="p">],</span>
            <span class="s1">'blood_group'</span><span class="p">:</span><span class="n">prof</span><span class="p">[</span><span class="s1">'blood_group'</span><span class="p">],</span>
            <span class="s1">'job'</span><span class="p">:</span><span class="n">prof</span><span class="p">[</span><span class="s1">'job'</span><span class="p">],</span>
            <span class="s1">'employer'</span><span class="p">:</span><span class="n">prof</span><span class="p">[</span><span class="s1">'company'</span><span class="p">],</span>
            <span class="s1">'ssn'</span><span class="p">:</span><span class="n">prof</span><span class="p">[</span><span class="s1">'ssn'</span><span class="p">],</span>
        <span class="p">})</span>
    <span class="k">return</span> <span class="n">fake_members</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_mem</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">make_members</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Not used: ['Thomas', 'Barber', 'DVM']
Not used: ['Mr.', 'Willie', 'Mcclure']
Not used: ['Mr.', 'Robert', 'Graham']
Not used: ['Dr.', 'Kathleen', 'Pope']
Not used: ['Mrs.', 'Brenda', 'Phillips']
Not used: ['Eric', 'Gonzales', 'MD']
Not used: ['Mr.', 'William', 'Berry', 'MD']
Not used: ['Dr.', 'Paul', 'Thomas']
Not used: ['Mr.', 'Joshua', 'Hudson']
Not used: ['Jennifer', 'Hughes', 'DDS']
Not used: ['Dr.', 'Jared', 'Patton', 'MD']
Not used: ['Dakota', 'Brown', 'MD']
Not used: ['Dr.', 'Kristi', 'Edwards']
Not used: ['Jamie', 'Gutierrez', 'DDS']
Not used: ['Mr.', 'Joseph', 'Maddox']
Not used: ['Alicia', 'Jenkins', 'DDS']
Not used: ['Michelle', 'Hays', 'MD']
Not used: ['Mr.', 'Kevin', 'Knight', 'MD']
Not used: ['Jesus', 'Thomas', 'DDS']
Not used: ['Mr.', 'Robert', 'Evans']
Not used: ['David', 'Bishop', 'PhD']
Not used: ['Kristin', 'Foster', 'MD']
Not used: ['Diane', 'Bush', 'DVM']
Not used: ['Mr.', 'Jack', 'Wise']
Not used: ['Mr.', 'Phillip', 'Garcia']
Not used: ['Mr.', 'Terry', 'Tran', 'Jr.']
Not used: ['Amanda', 'Medina', 'PhD']
Not used: ['Ethan', 'Allen', 'Jr.']
Not used: ['Elizabeth', 'Hall', 'DDS']
Not used: ['Rebecca', 'Villegas', 'DVM']
Not used: ['Phillip', 'Sullivan', 'Jr.']
Not used: ['Casey', 'Schultz', 'MD']
Not used: ['Alan', 'Ross', 'DDS']
Not used: ['Mrs.', 'Brenda', 'Mann']
Not used: ['Miss', 'Theresa', 'Harris']
Not used: ['Dr.', 'Lisa', 'Lee']
Not used: ['Mrs.', 'Erika', 'Benjamin', 'DVM']
Not used: ['Dr.', 'Jose', 'Daniels', 'MD']
Not used: ['Brooke', 'Sparks', 'MD']
Not used: ['Samantha', 'Williams', 'MD']
Not used: ['Miss', 'Lori', 'Armstrong']
Not used: ['Patricia', 'Smith', 'MD']
Not used: ['Shirley', 'Oliver', 'DDS']
Not used: ['Mrs.', 'Sandra', 'Young']
Not used: ['Jennifer', 'Schneider', 'MD']
Not used: ['Mr.', 'Jacob', 'King']
Not used: ['Dr.', 'Michael', 'Johnson']
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_mem</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-b2da0d38-a902-4770-ad75-d498d430b6de">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>last_name</th>
      <th>first_name</th>
      <th>previous_name</th>
      <th>birth_date</th>
      <th>sex</th>
      <th>address</th>
      <th>phone_number</th>
      <th>email_address</th>
      <th>user_name</th>
      <th>blood_group</th>
      <th>job</th>
      <th>employer</th>
      <th>ssn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lee</td>
      <td>Kristi</td>
      <td></td>
      <td>2013-12-08</td>
      <td>F</td>
      <td>Unit 2222 Box 6087\nDPO AA 60968</td>
      <td>524.030.6359</td>
      <td>goodmanrobert@gmail.com</td>
      <td>jonathan50</td>
      <td>B-</td>
      <td>Solicitor</td>
      <td>Rodriguez, Williams and York</td>
      <td>606-93-4627</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Diaz</td>
      <td>Donna</td>
      <td></td>
      <td>1910-01-29</td>
      <td>F</td>
      <td>USNV Roberts\nFPO AA 87961</td>
      <td>001-264-368-5096x956</td>
      <td>sreyes@yahoo.com</td>
      <td>richardmartin</td>
      <td>B-</td>
      <td>Nature conservation officer</td>
      <td>Buchanan PLC</td>
      <td>526-27-0606</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Shaw</td>
      <td>Lisa</td>
      <td></td>
      <td>1949-05-13</td>
      <td>F</td>
      <td>912 Lynch Neck\nPort Scott, MI 23397</td>
      <td>001-471-078-6036x44316</td>
      <td>dennis07@gmail.com</td>
      <td>jeffrey89</td>
      <td>AB+</td>
      <td>Clinical biochemist</td>
      <td>Mccarthy, Martinez and Patrick</td>
      <td>786-42-1164</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Harvey</td>
      <td>Michelle</td>
      <td></td>
      <td>2003-02-26</td>
      <td>F</td>
      <td>76165 Jasmine Squares\nCarlosborough, VT 78356</td>
      <td>001-746-273-4473</td>
      <td>jill66@yahoo.com</td>
      <td>josephallen</td>
      <td>AB-</td>
      <td>Environmental health practitioner</td>
      <td>Martinez, Reese and Ford</td>
      <td>012-98-3366</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Odom</td>
      <td>Shawn</td>
      <td></td>
      <td>2005-06-22</td>
      <td>M</td>
      <td>473 Elliott Trail\nBarneschester, KY 77207</td>
      <td>001-234-240-8768x5475</td>
      <td>tmccann@gmail.com</td>
      <td>jillianlopez</td>
      <td>A+</td>
      <td>Furniture designer</td>
      <td>Salazar-Bailey</td>
      <td>502-86-0544</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>952</th>
      <td>Flores</td>
      <td>Jamie</td>
      <td></td>
      <td>1947-11-09</td>
      <td>F</td>
      <td>5351 Jill Coves Suite 930\nEast David, MN 62503</td>
      <td>732.751.4409</td>
      <td>yolandafuentes@hotmail.com</td>
      <td>crosbyerin</td>
      <td>A-</td>
      <td>Geochemist</td>
      <td>Rogers Group</td>
      <td>473-53-3476</td>
    </tr>
    <tr>
      <th>953</th>
      <td>Barnes</td>
      <td>Tina</td>
      <td></td>
      <td>1996-09-17</td>
      <td>F</td>
      <td>110 Mark Gateway\nEast Jeffrey, CA 52738</td>
      <td>(330)510-4233x903</td>
      <td>janethall@gmail.com</td>
      <td>richard79</td>
      <td>O-</td>
      <td>Plant breeder/geneticist</td>
      <td>Huffman Inc</td>
      <td>387-99-7895</td>
    </tr>
    <tr>
      <th>954</th>
      <td>Martin</td>
      <td>Stacy</td>
      <td></td>
      <td>1978-03-14</td>
      <td>F</td>
      <td>95725 Raymond Walks\nHaleyport, CA 94212</td>
      <td>806-345-7941x41066</td>
      <td>angela09@hotmail.com</td>
      <td>wlopez</td>
      <td>AB-</td>
      <td>Site engineer</td>
      <td>Allen Group</td>
      <td>591-85-1746</td>
    </tr>
    <tr>
      <th>955</th>
      <td>Thompson</td>
      <td>Katherine</td>
      <td></td>
      <td>2003-05-19</td>
      <td>F</td>
      <td>942 Jennifer Common Apt. 549\nNicholasmouth, C...</td>
      <td>(781)464-1259</td>
      <td>john33@gmail.com</td>
      <td>jason63</td>
      <td>A+</td>
      <td>Drilling engineer</td>
      <td>Fisher Group</td>
      <td>853-19-0052</td>
    </tr>
    <tr>
      <th>956</th>
      <td>Rodriguez</td>
      <td>Anthony</td>
      <td></td>
      <td>1997-06-10</td>
      <td>M</td>
      <td>682 Jensen Key\nLake Jessicashire, MO 51992</td>
      <td>001-580-568-1299</td>
      <td>lharris@gmail.com</td>
      <td>hensonmichael</td>
      <td>AB+</td>
      <td>Engineer, electronics</td>
      <td>Atkinson, Hahn and James</td>
      <td>608-60-9685</td>
    </tr>
  </tbody>
</table>
<p>957 rows × 13 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b2da0d38-a902-4770-ad75-d498d430b6de')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b2da0d38-a902-4770-ad75-d498d430b6de button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b2da0d38-a902-4770-ad75-d498d430b6de');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">orig_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_mem</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df_mem</span> <span class="o">=</span> <span class="n">df_mem</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_mem</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="o">+</span> <span class="n">orig_cols</span>
<span class="n">df_mem</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-c2a65dfb-ca8f-4374-8323-e5b220647075">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>last_name</th>
      <th>first_name</th>
      <th>previous_name</th>
      <th>birth_date</th>
      <th>sex</th>
      <th>address</th>
      <th>phone_number</th>
      <th>email_address</th>
      <th>user_name</th>
      <th>blood_group</th>
      <th>job</th>
      <th>employer</th>
      <th>ssn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Lee</td>
      <td>Kristi</td>
      <td></td>
      <td>2013-12-08</td>
      <td>F</td>
      <td>Unit 2222 Box 6087\nDPO AA 60968</td>
      <td>524.030.6359</td>
      <td>goodmanrobert@gmail.com</td>
      <td>jonathan50</td>
      <td>B-</td>
      <td>Solicitor</td>
      <td>Rodriguez, Williams and York</td>
      <td>606-93-4627</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Diaz</td>
      <td>Donna</td>
      <td></td>
      <td>1910-01-29</td>
      <td>F</td>
      <td>USNV Roberts\nFPO AA 87961</td>
      <td>001-264-368-5096x956</td>
      <td>sreyes@yahoo.com</td>
      <td>richardmartin</td>
      <td>B-</td>
      <td>Nature conservation officer</td>
      <td>Buchanan PLC</td>
      <td>526-27-0606</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Shaw</td>
      <td>Lisa</td>
      <td></td>
      <td>1949-05-13</td>
      <td>F</td>
      <td>912 Lynch Neck\nPort Scott, MI 23397</td>
      <td>001-471-078-6036x44316</td>
      <td>dennis07@gmail.com</td>
      <td>jeffrey89</td>
      <td>AB+</td>
      <td>Clinical biochemist</td>
      <td>Mccarthy, Martinez and Patrick</td>
      <td>786-42-1164</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Harvey</td>
      <td>Michelle</td>
      <td></td>
      <td>2003-02-26</td>
      <td>F</td>
      <td>76165 Jasmine Squares\nCarlosborough, VT 78356</td>
      <td>001-746-273-4473</td>
      <td>jill66@yahoo.com</td>
      <td>josephallen</td>
      <td>AB-</td>
      <td>Environmental health practitioner</td>
      <td>Martinez, Reese and Ford</td>
      <td>012-98-3366</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Odom</td>
      <td>Shawn</td>
      <td></td>
      <td>2005-06-22</td>
      <td>M</td>
      <td>473 Elliott Trail\nBarneschester, KY 77207</td>
      <td>001-234-240-8768x5475</td>
      <td>tmccann@gmail.com</td>
      <td>jillianlopez</td>
      <td>A+</td>
      <td>Furniture designer</td>
      <td>Salazar-Bailey</td>
      <td>502-86-0544</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>952</th>
      <td>952</td>
      <td>Flores</td>
      <td>Jamie</td>
      <td></td>
      <td>1947-11-09</td>
      <td>F</td>
      <td>5351 Jill Coves Suite 930\nEast David, MN 62503</td>
      <td>732.751.4409</td>
      <td>yolandafuentes@hotmail.com</td>
      <td>crosbyerin</td>
      <td>A-</td>
      <td>Geochemist</td>
      <td>Rogers Group</td>
      <td>473-53-3476</td>
    </tr>
    <tr>
      <th>953</th>
      <td>953</td>
      <td>Barnes</td>
      <td>Tina</td>
      <td></td>
      <td>1996-09-17</td>
      <td>F</td>
      <td>110 Mark Gateway\nEast Jeffrey, CA 52738</td>
      <td>(330)510-4233x903</td>
      <td>janethall@gmail.com</td>
      <td>richard79</td>
      <td>O-</td>
      <td>Plant breeder/geneticist</td>
      <td>Huffman Inc</td>
      <td>387-99-7895</td>
    </tr>
    <tr>
      <th>954</th>
      <td>954</td>
      <td>Martin</td>
      <td>Stacy</td>
      <td></td>
      <td>1978-03-14</td>
      <td>F</td>
      <td>95725 Raymond Walks\nHaleyport, CA 94212</td>
      <td>806-345-7941x41066</td>
      <td>angela09@hotmail.com</td>
      <td>wlopez</td>
      <td>AB-</td>
      <td>Site engineer</td>
      <td>Allen Group</td>
      <td>591-85-1746</td>
    </tr>
    <tr>
      <th>955</th>
      <td>955</td>
      <td>Thompson</td>
      <td>Katherine</td>
      <td></td>
      <td>2003-05-19</td>
      <td>F</td>
      <td>942 Jennifer Common Apt. 549\nNicholasmouth, C...</td>
      <td>(781)464-1259</td>
      <td>john33@gmail.com</td>
      <td>jason63</td>
      <td>A+</td>
      <td>Drilling engineer</td>
      <td>Fisher Group</td>
      <td>853-19-0052</td>
    </tr>
    <tr>
      <th>956</th>
      <td>956</td>
      <td>Rodriguez</td>
      <td>Anthony</td>
      <td></td>
      <td>1997-06-10</td>
      <td>M</td>
      <td>682 Jensen Key\nLake Jessicashire, MO 51992</td>
      <td>001-580-568-1299</td>
      <td>lharris@gmail.com</td>
      <td>hensonmichael</td>
      <td>AB+</td>
      <td>Engineer, electronics</td>
      <td>Atkinson, Hahn and James</td>
      <td>608-60-9685</td>
    </tr>
  </tbody>
</table>
<p>957 rows × 14 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c2a65dfb-ca8f-4374-8323-e5b220647075')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c2a65dfb-ca8f-4374-8323-e5b220647075 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c2a65dfb-ca8f-4374-8323-e5b220647075');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_mem</span> <span class="o">=</span> <span class="n">corrupt_with_missing_values</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df_mem</span><span class="p">,</span> <span class="n">sample_cols</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">'first_name'</span><span class="p">,</span> <span class="s1">'birth_date'</span><span class="p">,</span> <span class="s1">'sex'</span><span class="p">,</span> <span class="s1">'address'</span><span class="p">,</span> <span class="s1">'phone_number'</span><span class="p">,</span> <span class="s1">'email_address'</span><span class="p">,</span> 
        <span class="s1">'user_name'</span><span class="p">,</span> <span class="s1">'blood_group'</span><span class="p">,</span> <span class="s1">'job'</span><span class="p">,</span> <span class="s1">'employer'</span><span class="p">,</span> <span class="s1">'ssn'</span><span class="p">],</span> <span class="n">missing_entry</span><span class="o">=</span><span class="s1">'NA'</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">df_mem</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of rows affected: 104
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-0700c381-fcc3-4152-9690-037c80d9782e">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>last_name</th>
      <th>first_name</th>
      <th>previous_name</th>
      <th>birth_date</th>
      <th>sex</th>
      <th>address</th>
      <th>phone_number</th>
      <th>email_address</th>
      <th>user_name</th>
      <th>blood_group</th>
      <th>job</th>
      <th>employer</th>
      <th>ssn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Lee</td>
      <td>Kristi</td>
      <td></td>
      <td>2013-12-08</td>
      <td>F</td>
      <td>Unit 2222 Box 6087\nDPO AA 60968</td>
      <td>524.030.6359</td>
      <td>goodmanrobert@gmail.com</td>
      <td>jonathan50</td>
      <td>B-</td>
      <td>Solicitor</td>
      <td>Rodriguez, Williams and York</td>
      <td>606-93-4627</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Diaz</td>
      <td>Donna</td>
      <td></td>
      <td>1910-01-29</td>
      <td>F</td>
      <td>USNV Roberts\nFPO AA 87961</td>
      <td>001-264-368-5096x956</td>
      <td>sreyes@yahoo.com</td>
      <td>richardmartin</td>
      <td>B-</td>
      <td>Nature conservation officer</td>
      <td>Buchanan PLC</td>
      <td>526-27-0606</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Shaw</td>
      <td>Lisa</td>
      <td></td>
      <td>1949-05-13</td>
      <td>F</td>
      <td>912 Lynch Neck\nPort Scott, MI 23397</td>
      <td>001-471-078-6036x44316</td>
      <td>dennis07@gmail.com</td>
      <td>jeffrey89</td>
      <td>AB+</td>
      <td>Clinical biochemist</td>
      <td>Mccarthy, Martinez and Patrick</td>
      <td>786-42-1164</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Harvey</td>
      <td>Michelle</td>
      <td></td>
      <td>2003-02-26</td>
      <td>F</td>
      <td>76165 Jasmine Squares\nCarlosborough, VT 78356</td>
      <td>001-746-273-4473</td>
      <td>jill66@yahoo.com</td>
      <td>josephallen</td>
      <td>AB-</td>
      <td>Environmental health practitioner</td>
      <td>Martinez, Reese and Ford</td>
      <td>012-98-3366</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Odom</td>
      <td>Shawn</td>
      <td></td>
      <td>2005-06-22</td>
      <td>M</td>
      <td>473 Elliott Trail\nBarneschester, KY 77207</td>
      <td>001-234-240-8768x5475</td>
      <td>tmccann@gmail.com</td>
      <td>jillianlopez</td>
      <td>A+</td>
      <td>Furniture designer</td>
      <td>Salazar-Bailey</td>
      <td>502-86-0544</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>952</th>
      <td>952</td>
      <td>Flores</td>
      <td>Jamie</td>
      <td></td>
      <td>1947-11-09</td>
      <td>F</td>
      <td>5351 Jill Coves Suite 930\nEast David, MN 62503</td>
      <td>732.751.4409</td>
      <td>yolandafuentes@hotmail.com</td>
      <td>crosbyerin</td>
      <td>A-</td>
      <td>Geochemist</td>
      <td>Rogers Group</td>
      <td>473-53-3476</td>
    </tr>
    <tr>
      <th>953</th>
      <td>953</td>
      <td>Barnes</td>
      <td>Tina</td>
      <td></td>
      <td>1996-09-17</td>
      <td>F</td>
      <td>110 Mark Gateway\nEast Jeffrey, CA 52738</td>
      <td>(330)510-4233x903</td>
      <td>janethall@gmail.com</td>
      <td>richard79</td>
      <td>O-</td>
      <td>Plant breeder/geneticist</td>
      <td>Huffman Inc</td>
      <td>387-99-7895</td>
    </tr>
    <tr>
      <th>954</th>
      <td>954</td>
      <td>Martin</td>
      <td>Stacy</td>
      <td></td>
      <td>1978-03-14</td>
      <td>F</td>
      <td>95725 Raymond Walks\nHaleyport, CA 94212</td>
      <td>806-345-7941x41066</td>
      <td>angela09@hotmail.com</td>
      <td>wlopez</td>
      <td>AB-</td>
      <td>Site engineer</td>
      <td>Allen Group</td>
      <td>591-85-1746</td>
    </tr>
    <tr>
      <th>955</th>
      <td>955</td>
      <td>Thompson</td>
      <td>Katherine</td>
      <td></td>
      <td>2003-05-19</td>
      <td>F</td>
      <td>942 Jennifer Common Apt. 549\nNicholasmouth, C...</td>
      <td>(781)464-1259</td>
      <td>john33@gmail.com</td>
      <td>jason63</td>
      <td>A+</td>
      <td>Drilling engineer</td>
      <td>Fisher Group</td>
      <td>853-19-0052</td>
    </tr>
    <tr>
      <th>956</th>
      <td>956</td>
      <td>Rodriguez</td>
      <td>Anthony</td>
      <td></td>
      <td>1997-06-10</td>
      <td>M</td>
      <td>682 Jensen Key\nLake Jessicashire, MO 51992</td>
      <td>001-580-568-1299</td>
      <td>lharris@gmail.com</td>
      <td>hensonmichael</td>
      <td>AB+</td>
      <td>Engineer, electronics</td>
      <td>Atkinson, Hahn and James</td>
      <td>608-60-9685</td>
    </tr>
  </tbody>
</table>
<p>957 rows × 14 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0700c381-fcc3-4152-9690-037c80d9782e')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0700c381-fcc3-4152-9690-037c80d9782e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0700c381-fcc3-4152-9690-037c80d9782e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_mem</span> <span class="o">=</span> <span class="n">corrupt_with_duplicate_rows</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df_mem</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">df_mem</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of duplicates added: 31
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-9979eb07-2972-4953-8e73-38278d853438">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>last_name</th>
      <th>first_name</th>
      <th>previous_name</th>
      <th>birth_date</th>
      <th>sex</th>
      <th>address</th>
      <th>phone_number</th>
      <th>email_address</th>
      <th>user_name</th>
      <th>blood_group</th>
      <th>job</th>
      <th>employer</th>
      <th>ssn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>Lee</td>
      <td>Kristi</td>
      <td></td>
      <td>2013-12-08</td>
      <td>F</td>
      <td>Unit 2222 Box 6087\nDPO AA 60968</td>
      <td>524.030.6359</td>
      <td>goodmanrobert@gmail.com</td>
      <td>jonathan50</td>
      <td>B-</td>
      <td>Solicitor</td>
      <td>Rodriguez, Williams and York</td>
      <td>606-93-4627</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>Diaz</td>
      <td>Donna</td>
      <td></td>
      <td>1910-01-29</td>
      <td>F</td>
      <td>USNV Roberts\nFPO AA 87961</td>
      <td>001-264-368-5096x956</td>
      <td>sreyes@yahoo.com</td>
      <td>richardmartin</td>
      <td>B-</td>
      <td>Nature conservation officer</td>
      <td>Buchanan PLC</td>
      <td>526-27-0606</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>Shaw</td>
      <td>Lisa</td>
      <td></td>
      <td>1949-05-13</td>
      <td>F</td>
      <td>912 Lynch Neck\nPort Scott, MI 23397</td>
      <td>001-471-078-6036x44316</td>
      <td>dennis07@gmail.com</td>
      <td>jeffrey89</td>
      <td>AB+</td>
      <td>Clinical biochemist</td>
      <td>Mccarthy, Martinez and Patrick</td>
      <td>786-42-1164</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>Harvey</td>
      <td>Michelle</td>
      <td></td>
      <td>2003-02-26</td>
      <td>F</td>
      <td>76165 Jasmine Squares\nCarlosborough, VT 78356</td>
      <td>001-746-273-4473</td>
      <td>jill66@yahoo.com</td>
      <td>josephallen</td>
      <td>AB-</td>
      <td>Environmental health practitioner</td>
      <td>Martinez, Reese and Ford</td>
      <td>012-98-3366</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.0</td>
      <td>Odom</td>
      <td>Shawn</td>
      <td></td>
      <td>2005-06-22</td>
      <td>M</td>
      <td>473 Elliott Trail\nBarneschester, KY 77207</td>
      <td>001-234-240-8768x5475</td>
      <td>tmccann@gmail.com</td>
      <td>jillianlopez</td>
      <td>A+</td>
      <td>Furniture designer</td>
      <td>Salazar-Bailey</td>
      <td>502-86-0544</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>813</th>
      <td>813.0</td>
      <td>Perkins</td>
      <td>Taylor</td>
      <td></td>
      <td>1984-07-11</td>
      <td>F</td>
      <td>PSC 8911, Box 2686\nAPO AA 31832</td>
      <td>2821264681</td>
      <td>cory49@hotmail.com</td>
      <td>gjohnson</td>
      <td>AB-</td>
      <td>Forensic psychologist</td>
      <td>Carr PLC</td>
      <td>499-63-7334</td>
    </tr>
    <tr>
      <th>875</th>
      <td>875.0</td>
      <td>Smith</td>
      <td>Adam</td>
      <td></td>
      <td>2000-10-29</td>
      <td>M</td>
      <td>76743 Jean Trail Apt. 235\nJohnsonview, WA 92986</td>
      <td>608-361-5927x867</td>
      <td>nguyensara@yahoo.com</td>
      <td>zjackson</td>
      <td>B+</td>
      <td>Adult nurse</td>
      <td>Boyd-Kennedy</td>
      <td>NA</td>
    </tr>
    <tr>
      <th>918</th>
      <td>918.0</td>
      <td>Bowman</td>
      <td>Ashley</td>
      <td></td>
      <td>2002-01-24</td>
      <td>F</td>
      <td>5287 Mary Vista Apt. 468\nLake Ronald, IL 19853</td>
      <td>1735222944</td>
      <td>andrewcastillo@hotmail.com</td>
      <td>austinregina</td>
      <td>AB-</td>
      <td>Computer games developer</td>
      <td>Morton, Zimmerman and Browning</td>
      <td>571-72-7246</td>
    </tr>
    <tr>
      <th>940</th>
      <td>940.0</td>
      <td>Cook</td>
      <td>Laura</td>
      <td></td>
      <td>1992-01-07</td>
      <td>F</td>
      <td>3457 Tammy Street Apt. 183\nMichelleville, OR ...</td>
      <td>7150104395</td>
      <td>jamescarey@gmail.com</td>
      <td>coxjeremy</td>
      <td>AB-</td>
      <td>Scientific laboratory technician</td>
      <td>Cain-Williams</td>
      <td>144-96-3501</td>
    </tr>
    <tr>
      <th>941</th>
      <td>941.0</td>
      <td>Williams</td>
      <td>Christine</td>
      <td></td>
      <td>1972-07-21</td>
      <td>F</td>
      <td>19357 Nichols Lights\nWest Katherine, MT 79155</td>
      <td>264.857.5155</td>
      <td>christopherrodriguez@hotmail.com</td>
      <td>uhendrix</td>
      <td>O+</td>
      <td>Broadcast engineer</td>
      <td>Barber-Shea</td>
      <td>782-72-4233</td>
    </tr>
  </tbody>
</table>
<p>988 rows × 14 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9979eb07-2972-4953-8e73-38278d853438')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9979eb07-2972-4953-8e73-38278d853438 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9979eb07-2972-4953-8e73-38278d853438');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_mem</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/members.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.6-Synthesize-payers-table">
<a class="anchor" href="#3.6-Synthesize-payers-table" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.6 Synthesize payers table<a class="anchor-link" href="#3.6-Synthesize-payers-table"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_payer_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/PAYERS.csv'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">df_payer_names</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-19864583-3aaf-4045-96fc-2eb4e5cbdadd">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aardvark Claims</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ability Clinical Technologies</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Allegro Medical Billing</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Allenton Medical Devices</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Allied Medical Billing</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>132</th>
      <td>Stellar Physicians Group</td>
    </tr>
    <tr>
      <th>133</th>
      <td>Streamlined Hospital Supplies</td>
    </tr>
    <tr>
      <th>134</th>
      <td>The Aegis Partners</td>
    </tr>
    <tr>
      <th>135</th>
      <td>Vital Heart Medical Co.</td>
    </tr>
    <tr>
      <th>136</th>
      <td>Vital Payments</td>
    </tr>
  </tbody>
</table>
<p>137 rows × 1 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-19864583-3aaf-4045-96fc-2eb4e5cbdadd')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-19864583-3aaf-4045-96fc-2eb4e5cbdadd button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-19864583-3aaf-4045-96fc-2eb4e5cbdadd');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_payers</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">fake_payers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
        <span class="n">prof</span> <span class="o">=</span> <span class="n">fake</span><span class="o">.</span><span class="n">profile</span><span class="p">()</span>
        <span class="n">fake_payers</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">'name'</span><span class="p">:</span><span class="n">df_payer_names</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">'address'</span><span class="p">:</span><span class="n">prof</span><span class="p">[</span><span class="s1">'address'</span><span class="p">],</span>
            <span class="s1">'phone_number'</span><span class="p">:</span><span class="n">fake</span><span class="o">.</span><span class="n">phone_number</span><span class="p">(),</span>
        <span class="p">})</span>
    <span class="k">return</span> <span class="n">fake_payers</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_pay</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">make_payers</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_pay</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-0330cdf7-bfa6-48ad-b4e8-399fd40e9158">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>address</th>
      <th>phone_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Priority Medical</td>
      <td>09525 Hernandez Ports\nStephanieside, SC 03000</td>
      <td>505.041.1354</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Patients Remit</td>
      <td>060 Andrews Inlet\nPeterberg, ND 01067</td>
      <td>625.389.8174x4641</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Atlas Recovery Inc.</td>
      <td>86728 Susan Knoll\nPort Billy, AK 61552</td>
      <td>(756)107-7716</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Premium Pulse</td>
      <td>444 Alicia Crest Apt. 512\nZunigabury, MD 68141</td>
      <td>(706)825-7011x401</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cyma Associates</td>
      <td>PSC 1686, Box 0526\nAPO AA 66075</td>
      <td>264-562-7324x3978</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>The Good Digits</td>
      <td>5801 Tonya Mount\nGibsonmouth, VT 72279</td>
      <td>918.434.7526x947</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Procure Payments</td>
      <td>377 Marshall Fork Suite 006\nSouth Joshua, OR ...</td>
      <td>635-672-9837x9067</td>
    </tr>
    <tr>
      <th>97</th>
      <td>All aboard Medical Transport</td>
      <td>PSC 0645, Box 3038\nAPO AA 64291</td>
      <td>408.647.4734x9067</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Lifeline Medical Supply</td>
      <td>5076 Whitney Spring\nOneillland, ID 08606</td>
      <td>+1-707-236-1234x9563</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Insight Medical Solutions</td>
      <td>371 Schroeder Ville\nAllenchester, NJ 09801</td>
      <td>(106)665-4897x65756</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0330cdf7-bfa6-48ad-b4e8-399fd40e9158')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0330cdf7-bfa6-48ad-b4e8-399fd40e9158 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0330cdf7-bfa6-48ad-b4e8-399fd40e9158');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">orig_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_pay</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df_pay</span> <span class="o">=</span> <span class="n">df_pay</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_pay</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="o">+</span> <span class="n">orig_cols</span>
<span class="n">df_pay</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-9ddc8ec6-9cae-45ec-95f4-3f7d5611b317">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>address</th>
      <th>phone_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Priority Medical</td>
      <td>09525 Hernandez Ports\nStephanieside, SC 03000</td>
      <td>505.041.1354</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Patients Remit</td>
      <td>060 Andrews Inlet\nPeterberg, ND 01067</td>
      <td>625.389.8174x4641</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Atlas Recovery Inc.</td>
      <td>86728 Susan Knoll\nPort Billy, AK 61552</td>
      <td>(756)107-7716</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Premium Pulse</td>
      <td>444 Alicia Crest Apt. 512\nZunigabury, MD 68141</td>
      <td>(706)825-7011x401</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Cyma Associates</td>
      <td>PSC 1686, Box 0526\nAPO AA 66075</td>
      <td>264-562-7324x3978</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>95</td>
      <td>The Good Digits</td>
      <td>5801 Tonya Mount\nGibsonmouth, VT 72279</td>
      <td>918.434.7526x947</td>
    </tr>
    <tr>
      <th>96</th>
      <td>96</td>
      <td>Procure Payments</td>
      <td>377 Marshall Fork Suite 006\nSouth Joshua, OR ...</td>
      <td>635-672-9837x9067</td>
    </tr>
    <tr>
      <th>97</th>
      <td>97</td>
      <td>All aboard Medical Transport</td>
      <td>PSC 0645, Box 3038\nAPO AA 64291</td>
      <td>408.647.4734x9067</td>
    </tr>
    <tr>
      <th>98</th>
      <td>98</td>
      <td>Lifeline Medical Supply</td>
      <td>5076 Whitney Spring\nOneillland, ID 08606</td>
      <td>+1-707-236-1234x9563</td>
    </tr>
    <tr>
      <th>99</th>
      <td>99</td>
      <td>Insight Medical Solutions</td>
      <td>371 Schroeder Ville\nAllenchester, NJ 09801</td>
      <td>(106)665-4897x65756</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 4 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9ddc8ec6-9cae-45ec-95f4-3f7d5611b317')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9ddc8ec6-9cae-45ec-95f4-3f7d5611b317 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9ddc8ec6-9cae-45ec-95f4-3f7d5611b317');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_pay_A</span> <span class="o">=</span> <span class="n">corrupt_with_missing_values</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">df_pay</span><span class="p">,</span> 
    <span class="n">sample_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">'address'</span><span class="p">,</span> <span class="s1">'phone_number'</span><span class="p">],</span> <span class="n">missing_entry</span><span class="o">=</span><span class="s1">'NA'</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">df_pay</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of rows affected: 9
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-0a2b9298-4020-4dd6-be66-be84d9977270">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>address</th>
      <th>phone_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Priority Medical</td>
      <td>09525 Hernandez Ports\nStephanieside, SC 03000</td>
      <td>505.041.1354</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Patients Remit</td>
      <td>060 Andrews Inlet\nPeterberg, ND 01067</td>
      <td>625.389.8174x4641</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Atlas Recovery Inc.</td>
      <td>86728 Susan Knoll\nPort Billy, AK 61552</td>
      <td>(756)107-7716</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Premium Pulse</td>
      <td>444 Alicia Crest Apt. 512\nZunigabury, MD 68141</td>
      <td>(706)825-7011x401</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Cyma Associates</td>
      <td>PSC 1686, Box 0526\nAPO AA 66075</td>
      <td>264-562-7324x3978</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>95</td>
      <td>The Good Digits</td>
      <td>5801 Tonya Mount\nGibsonmouth, VT 72279</td>
      <td>918.434.7526x947</td>
    </tr>
    <tr>
      <th>96</th>
      <td>96</td>
      <td>Procure Payments</td>
      <td>377 Marshall Fork Suite 006\nSouth Joshua, OR ...</td>
      <td>635-672-9837x9067</td>
    </tr>
    <tr>
      <th>97</th>
      <td>97</td>
      <td>All aboard Medical Transport</td>
      <td>PSC 0645, Box 3038\nAPO AA 64291</td>
      <td>408.647.4734x9067</td>
    </tr>
    <tr>
      <th>98</th>
      <td>98</td>
      <td>Lifeline Medical Supply</td>
      <td>5076 Whitney Spring\nOneillland, ID 08606</td>
      <td>+1-707-236-1234x9563</td>
    </tr>
    <tr>
      <th>99</th>
      <td>99</td>
      <td>Insight Medical Solutions</td>
      <td>371 Schroeder Ville\nAllenchester, NJ 09801</td>
      <td>(106)665-4897x65756</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 4 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0a2b9298-4020-4dd6-be66-be84d9977270')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0a2b9298-4020-4dd6-be66-be84d9977270 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0a2b9298-4020-4dd6-be66-be84d9977270');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_pay</span> <span class="o">=</span> <span class="n">corrupt_with_duplicate_rows</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df_pay</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">df_pay</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of duplicates added: 2
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-778ec941-f7fc-4738-a0c6-4b558e22ff43">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>address</th>
      <th>phone_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>Priority Medical</td>
      <td>09525 Hernandez Ports\nStephanieside, SC 03000</td>
      <td>505.041.1354</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>Patients Remit</td>
      <td>060 Andrews Inlet\nPeterberg, ND 01067</td>
      <td>625.389.8174x4641</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>Atlas Recovery Inc.</td>
      <td>86728 Susan Knoll\nPort Billy, AK 61552</td>
      <td>(756)107-7716</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>Premium Pulse</td>
      <td>444 Alicia Crest Apt. 512\nZunigabury, MD 68141</td>
      <td>(706)825-7011x401</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.0</td>
      <td>Cyma Associates</td>
      <td>PSC 1686, Box 0526\nAPO AA 66075</td>
      <td>264-562-7324x3978</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>97</th>
      <td>97.0</td>
      <td>All aboard Medical Transport</td>
      <td>PSC 0645, Box 3038\nAPO AA 64291</td>
      <td>408.647.4734x9067</td>
    </tr>
    <tr>
      <th>98</th>
      <td>98.0</td>
      <td>Lifeline Medical Supply</td>
      <td>5076 Whitney Spring\nOneillland, ID 08606</td>
      <td>+1-707-236-1234x9563</td>
    </tr>
    <tr>
      <th>99</th>
      <td>99.0</td>
      <td>Insight Medical Solutions</td>
      <td>371 Schroeder Ville\nAllenchester, NJ 09801</td>
      <td>(106)665-4897x65756</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>Patients Remit</td>
      <td>060 Andrews Inlet\nPeterberg, ND 01067</td>
      <td>625.389.8174x4641</td>
    </tr>
    <tr>
      <th>58</th>
      <td>58.0</td>
      <td>Priority Medical</td>
      <td>Unit 4012 Box 4779\nDPO AA 25295</td>
      <td>+1-299-057-6197x82520</td>
    </tr>
  </tbody>
</table>
<p>102 rows × 4 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-778ec941-f7fc-4738-a0c6-4b558e22ff43')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-778ec941-f7fc-4738-a0c6-4b558e22ff43 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-778ec941-f7fc-4738-a0c6-4b558e22ff43');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_pay</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/payers.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.7-Synthesize-claims-table">
<a class="anchor" href="#3.7-Synthesize-claims-table" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.7 Synthesize claims table<a class="anchor-link" href="#3.7-Synthesize-claims-table"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_facility_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/FACILITIES.csv'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">df_facility_names</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-b07bd8eb-5840-44c2-ae6b-95f1dc3b944d">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alpha Health Care</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Gold River Hospital</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Serenity South Hills</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Charlotte Eye Group</td>
    </tr>
    <tr>
      <th>4</th>
      <td>New Path Health</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>295</th>
      <td>Serenity Surgical</td>
    </tr>
    <tr>
      <th>296</th>
      <td>North Mark</td>
    </tr>
    <tr>
      <th>297</th>
      <td>East Metro Health</td>
    </tr>
    <tr>
      <th>298</th>
      <td>Oasis Family Health</td>
    </tr>
    <tr>
      <th>299</th>
      <td>Next Care Health</td>
    </tr>
  </tbody>
</table>
<p>300 rows × 1 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b07bd8eb-5840-44c2-ae6b-95f1dc3b944d')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b07bd8eb-5840-44c2-ae6b-95f1dc3b944d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b07bd8eb-5840-44c2-ae6b-95f1dc3b944d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_claims</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">fake_claims</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
        <span class="n">mem_sample</span> <span class="o">=</span> <span class="n">df_mem</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="n">pay_sample</span> <span class="o">=</span> <span class="n">df_pay_A</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="n">diamed_sample</span> <span class="o">=</span> <span class="n">df_diamed</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="n">fake_claims</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>    
            <span class="s1">'date'</span><span class="p">:</span><span class="n">fake</span><span class="o">.</span><span class="n">date_between</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="s1">'-30y'</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">'today'</span><span class="p">),</span>
            <span class="s1">'member_id'</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">mem_sample</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="s1">'facility_name'</span><span class="p">:</span><span class="n">df_facility_names</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">'facility_address'</span><span class="p">:</span><span class="n">fake</span><span class="o">.</span><span class="n">address</span><span class="p">(),</span>
            <span class="s1">'payer_id'</span><span class="p">:</span><span class="n">pay_sample</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">'claim_diagnosis_id'</span><span class="p">:</span><span class="n">diamed_sample</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">})</span>
    <span class="k">return</span> <span class="n">fake_claims</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_clm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">make_claims</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_clm</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-544b9927-76a3-4697-840c-c385d1444b0a">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>member_id</th>
      <th>facility_name</th>
      <th>facility_address</th>
      <th>payer_id</th>
      <th>claim_diagnosis_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-04-27</td>
      <td>876</td>
      <td>East Metro Health</td>
      <td>153 Miller Burg\nWest Richardton, ND 88559</td>
      <td>55</td>
      <td>11916</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-01-28</td>
      <td>316</td>
      <td>Zooner Medical</td>
      <td>7218 Tapia Keys\nPort Anthonyton, IL 71712</td>
      <td>36</td>
      <td>7952</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1993-12-16</td>
      <td>812</td>
      <td>New Path Health</td>
      <td>450 Bethany Estates Suite 840\nSouth Laurenmou...</td>
      <td>24</td>
      <td>693</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2013-11-03</td>
      <td>52</td>
      <td>Claris Care</td>
      <td>PSC 8290, Box 2703\nAPO AE 59993</td>
      <td>27</td>
      <td>1097</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2001-10-04</td>
      <td>363</td>
      <td>Universal Body Clinic</td>
      <td>63208 Stephens Rest Apt. 665\nLake Brianmouth,...</td>
      <td>64</td>
      <td>500</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>2002-03-19</td>
      <td>26</td>
      <td>Medica Zone</td>
      <td>9998 Amy Lights\nSouth Ginafurt, IN 09994</td>
      <td>44</td>
      <td>2162</td>
    </tr>
    <tr>
      <th>996</th>
      <td>2019-04-08</td>
      <td>342</td>
      <td>York General</td>
      <td>89688 Church Skyway Apt. 240\nLake Whitneyfurt...</td>
      <td>37</td>
      <td>5396</td>
    </tr>
    <tr>
      <th>997</th>
      <td>1999-12-29</td>
      <td>240</td>
      <td>Winter warm</td>
      <td>26348 Lopez Corners Apt. 955\nPort Dawnstad, A...</td>
      <td>89</td>
      <td>10447</td>
    </tr>
    <tr>
      <th>998</th>
      <td>2013-04-06</td>
      <td>559</td>
      <td>Aussie Health</td>
      <td>444 Jones Drives\nStevenfurt, MA 57955</td>
      <td>90</td>
      <td>13644</td>
    </tr>
    <tr>
      <th>999</th>
      <td>2019-05-26</td>
      <td>95</td>
      <td>Midsummer Premium</td>
      <td>USNV Richardson\nFPO AA 04503</td>
      <td>24</td>
      <td>10164</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 6 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-544b9927-76a3-4697-840c-c385d1444b0a')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-544b9927-76a3-4697-840c-c385d1444b0a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-544b9927-76a3-4697-840c-c385d1444b0a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">orig_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_clm</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df_clm</span> <span class="o">=</span> <span class="n">df_clm</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_clm</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="o">+</span> <span class="n">orig_cols</span>
<span class="n">df_clm</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-fe9dffa2-f819-4185-b4a3-5b298ba97c00">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>date</th>
      <th>member_id</th>
      <th>facility_name</th>
      <th>facility_address</th>
      <th>payer_id</th>
      <th>claim_diagnosis_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2021-04-27</td>
      <td>876</td>
      <td>East Metro Health</td>
      <td>153 Miller Burg\nWest Richardton, ND 88559</td>
      <td>55</td>
      <td>11916</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2014-01-28</td>
      <td>316</td>
      <td>Zooner Medical</td>
      <td>7218 Tapia Keys\nPort Anthonyton, IL 71712</td>
      <td>36</td>
      <td>7952</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1993-12-16</td>
      <td>812</td>
      <td>New Path Health</td>
      <td>450 Bethany Estates Suite 840\nSouth Laurenmou...</td>
      <td>24</td>
      <td>693</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2013-11-03</td>
      <td>52</td>
      <td>Claris Care</td>
      <td>PSC 8290, Box 2703\nAPO AE 59993</td>
      <td>27</td>
      <td>1097</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2001-10-04</td>
      <td>363</td>
      <td>Universal Body Clinic</td>
      <td>63208 Stephens Rest Apt. 665\nLake Brianmouth,...</td>
      <td>64</td>
      <td>500</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>995</td>
      <td>2002-03-19</td>
      <td>26</td>
      <td>Medica Zone</td>
      <td>9998 Amy Lights\nSouth Ginafurt, IN 09994</td>
      <td>44</td>
      <td>2162</td>
    </tr>
    <tr>
      <th>996</th>
      <td>996</td>
      <td>2019-04-08</td>
      <td>342</td>
      <td>York General</td>
      <td>89688 Church Skyway Apt. 240\nLake Whitneyfurt...</td>
      <td>37</td>
      <td>5396</td>
    </tr>
    <tr>
      <th>997</th>
      <td>997</td>
      <td>1999-12-29</td>
      <td>240</td>
      <td>Winter warm</td>
      <td>26348 Lopez Corners Apt. 955\nPort Dawnstad, A...</td>
      <td>89</td>
      <td>10447</td>
    </tr>
    <tr>
      <th>998</th>
      <td>998</td>
      <td>2013-04-06</td>
      <td>559</td>
      <td>Aussie Health</td>
      <td>444 Jones Drives\nStevenfurt, MA 57955</td>
      <td>90</td>
      <td>13644</td>
    </tr>
    <tr>
      <th>999</th>
      <td>999</td>
      <td>2019-05-26</td>
      <td>95</td>
      <td>Midsummer Premium</td>
      <td>USNV Richardson\nFPO AA 04503</td>
      <td>24</td>
      <td>10164</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 7 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fe9dffa2-f819-4185-b4a3-5b298ba97c00')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fe9dffa2-f819-4185-b4a3-5b298ba97c00 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fe9dffa2-f819-4185-b4a3-5b298ba97c00');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_clm_</span><span class="o">=</span> <span class="n">corrupt_with_missing_values</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df_clm</span><span class="p">,</span> <span class="n">sample_cols</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">'date'</span><span class="p">,</span> <span class="s1">'facility_name'</span><span class="p">,</span> <span class="s1">'facility_address'</span><span class="p">],</span> <span class="n">missing_entry</span><span class="o">=</span><span class="s1">'NA'</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">df_clm</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of rows affected: 107
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-df14aaa7-fd47-42b4-9412-a0fd0e6051b3">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>date</th>
      <th>member_id</th>
      <th>facility_name</th>
      <th>facility_address</th>
      <th>payer_id</th>
      <th>claim_diagnosis_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>NA</td>
      <td>876</td>
      <td>East Metro Health</td>
      <td>153 Miller Burg\nWest Richardton, ND 88559</td>
      <td>55</td>
      <td>11916</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2014-01-28</td>
      <td>316</td>
      <td>Zooner Medical</td>
      <td>7218 Tapia Keys\nPort Anthonyton, IL 71712</td>
      <td>36</td>
      <td>7952</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1993-12-16</td>
      <td>812</td>
      <td>New Path Health</td>
      <td>450 Bethany Estates Suite 840\nSouth Laurenmou...</td>
      <td>24</td>
      <td>693</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2013-11-03</td>
      <td>52</td>
      <td>Claris Care</td>
      <td>PSC 8290, Box 2703\nAPO AE 59993</td>
      <td>27</td>
      <td>1097</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2001-10-04</td>
      <td>363</td>
      <td>Universal Body Clinic</td>
      <td>63208 Stephens Rest Apt. 665\nLake Brianmouth,...</td>
      <td>64</td>
      <td>500</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>995</td>
      <td>2002-03-19</td>
      <td>26</td>
      <td>Medica Zone</td>
      <td>9998 Amy Lights\nSouth Ginafurt, IN 09994</td>
      <td>44</td>
      <td>2162</td>
    </tr>
    <tr>
      <th>996</th>
      <td>996</td>
      <td>2019-04-08</td>
      <td>342</td>
      <td>York General</td>
      <td>89688 Church Skyway Apt. 240\nLake Whitneyfurt...</td>
      <td>37</td>
      <td>5396</td>
    </tr>
    <tr>
      <th>997</th>
      <td>997</td>
      <td>1999-12-29</td>
      <td>240</td>
      <td>Winter warm</td>
      <td>26348 Lopez Corners Apt. 955\nPort Dawnstad, A...</td>
      <td>89</td>
      <td>10447</td>
    </tr>
    <tr>
      <th>998</th>
      <td>998</td>
      <td>2013-04-06</td>
      <td>559</td>
      <td>NA</td>
      <td>444 Jones Drives\nStevenfurt, MA 57955</td>
      <td>90</td>
      <td>13644</td>
    </tr>
    <tr>
      <th>999</th>
      <td>999</td>
      <td>2019-05-26</td>
      <td>95</td>
      <td>Midsummer Premium</td>
      <td>USNV Richardson\nFPO AA 04503</td>
      <td>24</td>
      <td>10164</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 7 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-df14aaa7-fd47-42b4-9412-a0fd0e6051b3')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-df14aaa7-fd47-42b4-9412-a0fd0e6051b3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-df14aaa7-fd47-42b4-9412-a0fd0e6051b3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_clm_</span><span class="o">=</span> <span class="n">corrupt_with_duplicate_rows</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df_clm</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">df_clm</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of duplicates added: 46
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-ca8da818-0a56-46d7-adb3-3afe49e05940">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>date</th>
      <th>member_id</th>
      <th>facility_name</th>
      <th>facility_address</th>
      <th>payer_id</th>
      <th>claim_diagnosis_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>NA</td>
      <td>876</td>
      <td>East Metro Health</td>
      <td>153 Miller Burg\nWest Richardton, ND 88559</td>
      <td>55</td>
      <td>11916</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2014-01-28</td>
      <td>316</td>
      <td>Zooner Medical</td>
      <td>7218 Tapia Keys\nPort Anthonyton, IL 71712</td>
      <td>36</td>
      <td>7952</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1993-12-16</td>
      <td>812</td>
      <td>New Path Health</td>
      <td>450 Bethany Estates Suite 840\nSouth Laurenmou...</td>
      <td>24</td>
      <td>693</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2013-11-03</td>
      <td>52</td>
      <td>Claris Care</td>
      <td>PSC 8290, Box 2703\nAPO AE 59993</td>
      <td>27</td>
      <td>1097</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2001-10-04</td>
      <td>363</td>
      <td>Universal Body Clinic</td>
      <td>63208 Stephens Rest Apt. 665\nLake Brianmouth,...</td>
      <td>64</td>
      <td>500</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>995</td>
      <td>2002-03-19</td>
      <td>26</td>
      <td>Medica Zone</td>
      <td>9998 Amy Lights\nSouth Ginafurt, IN 09994</td>
      <td>44</td>
      <td>2162</td>
    </tr>
    <tr>
      <th>996</th>
      <td>996</td>
      <td>2019-04-08</td>
      <td>342</td>
      <td>York General</td>
      <td>89688 Church Skyway Apt. 240\nLake Whitneyfurt...</td>
      <td>37</td>
      <td>5396</td>
    </tr>
    <tr>
      <th>997</th>
      <td>997</td>
      <td>1999-12-29</td>
      <td>240</td>
      <td>Winter warm</td>
      <td>26348 Lopez Corners Apt. 955\nPort Dawnstad, A...</td>
      <td>89</td>
      <td>10447</td>
    </tr>
    <tr>
      <th>998</th>
      <td>998</td>
      <td>2013-04-06</td>
      <td>559</td>
      <td>NA</td>
      <td>444 Jones Drives\nStevenfurt, MA 57955</td>
      <td>90</td>
      <td>13644</td>
    </tr>
    <tr>
      <th>999</th>
      <td>999</td>
      <td>2019-05-26</td>
      <td>95</td>
      <td>Midsummer Premium</td>
      <td>USNV Richardson\nFPO AA 04503</td>
      <td>24</td>
      <td>10164</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 7 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ca8da818-0a56-46d7-adb3-3afe49e05940')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ca8da818-0a56-46d7-adb3-3afe49e05940 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ca8da818-0a56-46d7-adb3-3afe49e05940');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_clm</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/claims.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.8-Synthesize-member-diagnoses-table">
<a class="anchor" href="#3.8-Synthesize-member-diagnoses-table" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.8 Synthesize member-diagnoses table<a class="anchor-link" href="#3.8-Synthesize-member-diagnoses-table"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_memdias</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">fake_memdias</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
        <span class="n">mem_sample</span> <span class="o">=</span> <span class="n">df_mem</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="n">dia_sample</span> <span class="o">=</span> <span class="n">df_dia</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="n">fake_memdias</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">'member_id'</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">mem_sample</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="s1">'diagnosis_id'</span><span class="p">:</span><span class="n">dia_sample</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">})</span>
    <span class="k">return</span> <span class="n">fake_memdias</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_memdia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">make_memdias</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_memdia</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-43af44e2-b8a4-4a3f-a675-f16269323a59">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>member_id</th>
      <th>diagnosis_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>335</td>
      <td>1094</td>
    </tr>
    <tr>
      <th>1</th>
      <td>267</td>
      <td>1158</td>
    </tr>
    <tr>
      <th>2</th>
      <td>334</td>
      <td>159</td>
    </tr>
    <tr>
      <th>3</th>
      <td>458</td>
      <td>463</td>
    </tr>
    <tr>
      <th>4</th>
      <td>144</td>
      <td>405</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>740</td>
      <td>304</td>
    </tr>
    <tr>
      <th>996</th>
      <td>51</td>
      <td>1280</td>
    </tr>
    <tr>
      <th>997</th>
      <td>11</td>
      <td>1044</td>
    </tr>
    <tr>
      <th>998</th>
      <td>837</td>
      <td>1359</td>
    </tr>
    <tr>
      <th>999</th>
      <td>790</td>
      <td>462</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-43af44e2-b8a4-4a3f-a675-f16269323a59')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-43af44e2-b8a4-4a3f-a675-f16269323a59 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-43af44e2-b8a4-4a3f-a675-f16269323a59');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">orig_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_memdia</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df_memdia</span> <span class="o">=</span> <span class="n">df_memdia</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_memdia</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="o">+</span> <span class="n">orig_cols</span>
<span class="n">df_memdia</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-7cdd9228-b926-4a3d-b166-37fec27a406f">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>member_id</th>
      <th>diagnosis_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>335</td>
      <td>1094</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>267</td>
      <td>1158</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>334</td>
      <td>159</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>458</td>
      <td>463</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>144</td>
      <td>405</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>995</td>
      <td>740</td>
      <td>304</td>
    </tr>
    <tr>
      <th>996</th>
      <td>996</td>
      <td>51</td>
      <td>1280</td>
    </tr>
    <tr>
      <th>997</th>
      <td>997</td>
      <td>11</td>
      <td>1044</td>
    </tr>
    <tr>
      <th>998</th>
      <td>998</td>
      <td>837</td>
      <td>1359</td>
    </tr>
    <tr>
      <th>999</th>
      <td>999</td>
      <td>790</td>
      <td>462</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7cdd9228-b926-4a3d-b166-37fec27a406f')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7cdd9228-b926-4a3d-b166-37fec27a406f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7cdd9228-b926-4a3d-b166-37fec27a406f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_memdia</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/member-diagnoses.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.9-Inspect-synthesized-files">
<a class="anchor" href="#3.9-Inspect-synthesized-files" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.9 Inspect synthesized files<a class="anchor-link" href="#3.9-Inspect-synthesized-files"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -alh <span class="s2">"{base_dir}"</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>total 1.4M
-rw------- 1 root root 192K Apr 29 19:35 claim_diagnosis.csv
-rw------- 1 root root  88K Apr 29 19:38 claims.csv
-rw------- 1 root root  40K Apr 29 19:34 diagnoses.csv
-rw------- 1 root root 585K Apr 28 17:49 DISEASE_DRUG_MAPPINGS.csv
-rw------- 1 root root 5.2K Apr 28 21:04 FACILITIES.csv
-rw------- 1 root root  34K Apr 29 19:34 medications.csv
-rw------- 1 root root  12K Apr 29 19:38 member-diagnoses.csv
-rw------- 1 root root 183K Apr 29 19:36 members.csv
-rw------- 1 root root 8.6K Apr 29 19:37 payers.csv
-rw------- 1 root root 2.6K Apr 28 20:17 PAYERS.csv
-rw------- 1 root root 220K Apr 29 19:41 synthetic_insurance_data.ipynb
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The generated .csv files could be used to populate a database. Here is a brief section from each of these files:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -10 <span class="s2">"{base_dir}/members.csv"</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>,id,last_name,first_name,previous_name,birth_date,sex,address,phone_number,email_address,user_name,blood_group,job,employer,ssn
0,0.0,Lee,Kristi,,2013-12-08,F,"Unit 2222 Box 6087
DPO AA 60968",524.030.6359,goodmanrobert@gmail.com,jonathan50,B-,Solicitor,"Rodriguez, Williams and York",606-93-4627
1,1.0,Diaz,Donna,,1910-01-29,F,"USNV Roberts
FPO AA 87961",001-264-368-5096x956,sreyes@yahoo.com,richardmartin,B-,Nature conservation officer,Buchanan PLC,526-27-0606
2,2.0,Shaw,Lisa,,1949-05-13,F,"912 Lynch Neck
Port Scott, MI 23397",001-471-078-6036x44316,dennis07@gmail.com,jeffrey89,AB+,Clinical biochemist,"Mccarthy, Martinez and Patrick",786-42-1164
3,3.0,Harvey,Michelle,,2003-02-26,F,"76165 Jasmine Squares
Carlosborough, VT 78356",001-746-273-4473,jill66@yahoo.com,josephallen,AB-,Environmental health practitioner,"Martinez, Reese and Ford",012-98-3366
4,4.0,Odom,Shawn,,2005-06-22,M,"473 Elliott Trail
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -10 <span class="s2">"{base_dir}/payers.csv"</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>id,name,address,phone_number
0.0,Priority Medical,"09525 Hernandez Ports
Stephanieside, SC 03000",505.041.1354
1.0,Patients Remit,"060 Andrews Inlet
Peterberg, ND 01067",625.389.8174x4641
2.0,Atlas Recovery Inc.,"86728 Susan Knoll
Port Billy, AK 61552",(756)107-7716
3.0,Premium Pulse,"444 Alicia Crest Apt. 512
Zunigabury, MD 68141",(706)825-7011x401
4.0,Cyma Associates,"PSC 1686, Box 0526
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -10 <span class="s2">"{base_dir}/claims.csv"</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>id,date,member_id,facility_name,facility_address,payer_id,claim_diagnosis_id
0,NA,876,East Metro Health,"153 Miller Burg
West Richardton, ND 88559",55,11916
1,2014-01-28,316,Zooner Medical,"7218 Tapia Keys
Port Anthonyton, IL 71712",36,7952
2,1993-12-16,812,New Path Health,"450 Bethany Estates Suite 840
South Laurenmouth, GA 44481",24,693
3,2013-11-03,52,Claris Care,"PSC 8290, Box 2703
APO AE 59993",27,1097
4,2001-10-04,363,Universal Body Clinic,"63208 Stephens Rest Apt. 665
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -10 <span class="s2">"{base_dir}/diagnoses.csv"</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>id,diagnosis
0,Alkylating Agent Cystitis
1,Abdominal Distension
2,Abdominal Distension Prior to Abdominal X-ray
3,Abdominal Radiological Procedure
4,Abnormal Uterine Bleeding
5,Abortion
6,Angina
7,Acetaminophen Overdose
8,Acidosis
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -10 <span class="s2">"{base_dir}/medications.csv"</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>id,medication
0,sodium bicarbonate
1,citric acid / sodium citrate
2,bethanechol
3,pamabrom
4,vasopressin
5,medroxyprogesterone
6,norethindrone
7,megestrol
8,levonorgestrel
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -10 <span class="s2">"{base_dir}/claim_diagnosis.csv"</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>id,diagnosis_id,medication_id
0,0,0
1,0,1
2,1,2
3,1,3
4,1,2
5,1,3
6,2,4
7,3,4
8,3,4
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head -10 <span class="s2">"{base_dir}/member-diagnoses.csv"</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>id,member_id,diagnosis_id
0,335,1094
1,267,1158
2,334,159
3,458,463
4,144,405
5,843,982
6,135,104
7,656,998
8,858,1413
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="LearnableLoopAI/portfolio2"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/insurance_industry/insurance_data_synthesis/faker/2022/04/19/synthetic_insurance_data.html" hidden></a>
</article>