<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">An RL Approach for Inventory Management (Part 6)</h1><p class="page-description">Tabular as a Form of Function Approximation</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-07-14T00:00:00-05:00" itemprop="datePublished">
        Jul 14, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Inventory_Management">Inventory_Management</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Markov_Decision_Process">Markov_Decision_Process</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Python">Python</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#1-Tabular-as-a-Form-of-FunctionApprox">1 Tabular as a Form of FunctionApprox </a></li>
<li class="toc-entry toc-h2"><a href="#2-Example-Model-Data-Generator">2 Example Model Data Generator </a></li>
<li class="toc-entry toc-h2"><a href="#3.-Implement-$f(x;-w)$">3. Implement $f(x; w)$ </a></li>
<li class="toc-entry toc-h2"><a href="#4.-Implement-Tabular">4. Implement Tabular </a></li>
<li class="toc-entry toc-h2"><a href="#5-RMSE">5 RMSE </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-07-14-InventoryManagement6_PORT.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1-Tabular-as-a-Form-of-FunctionApprox">
<a class="anchor" href="#1-Tabular-as-a-Form-of-FunctionApprox" aria-hidden="true"><span class="octicon octicon-link"></span></a>1 Tabular as a Form of <code>FunctionApprox</code><a class="anchor-link" href="#1-Tabular-as-a-Form-of-FunctionApprox"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now take a step back. Let us again consider a finite set of $x$-values $\mathcal X={x_1,x_2,...,x_n}$. We further assume that all data sets consisting of $(x,y)$ pairs that we use have all their $x$-values inside this finite set $\mathcal X$. We want to have $\hat y = \mathbb E[y|x]$ such that</p>
<ul>
<li>the prediction for this $x$ is only calculated from the $y$-values in the data set associated with this $x$</li>
<li>the $y$-values in the data set associated with other $x$-values should not influence the prediction for this $x$</li>
<li>the prediction for this $x$ is a kind of <em>average</em> of all the $y$-values associated with this $x$</li>
</ul>
<p>We refer to this kind of setup as <em>Tabular</em> - each $x \in \mathcal X$ can be stored in a table associated with its corresponding prediction $\mathbb E[y|x]$.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>python --version
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Python 3.7.15
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We make use of the approach followed in <a href="http://web.stanford.edu/class/cme241/">http://web.stanford.edu/class/cme241/</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">overload</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">replace</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">import</span> <span class="nn">itertools</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2-Example-Model-Data-Generator">
<a class="anchor" href="#2-Example-Model-Data-Generator" aria-hidden="true"><span class="octicon octicon-link"></span></a>2 Example Model Data Generator<a class="anchor-link" href="#2-Example-Model-Data-Generator"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's setup a Data Model:
$$
\begin{aligned}
y &amp;= \alpha + \beta_1 x_1 + \beta_2x_2 - \beta_3x_3 + \mathcal N(0, 2.0) \\
  &amp;= 2 + 10x_1 + 4x_2 - 6x_3 + \mathcal N(0, 2.0)
\end{aligned}
$$</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Triple</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
<span class="n">Aug_Triple</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="c1">#. augmented to prepend bias</span>
<span class="n">DataSeq</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Triple</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="c1">#. last float is for y</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">example_model_data_generator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">DataSeq</span><span class="p">]:</span>
    <span class="n">coeffs</span><span class="p">:</span> <span class="n">Aug_Triple</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
    <span class="n">pts</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Triple</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">values</span>
                             <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span> <span class="c1">#. normal distribution</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">res</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Triple</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">:</span>
          <span class="c1"># pt: np.ndarray = np.random.randn(3)</span>
          <span class="n">x_val</span><span class="p">:</span> <span class="n">Triple</span> <span class="o">=</span> <span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
          <span class="n">y_val</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">pt</span><span class="p">)</span> <span class="o">+</span> \
            <span class="n">d</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
          <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">))</span>
        <span class="k">yield</span> <span class="n">res</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_gen</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">DataSeq</span><span class="p">]</span> <span class="o">=</span> <span class="n">example_model_data_generator</span><span class="p">();</span> <span class="n">data_gen</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;generator object example_model_data_generator at 0x7f037d757b50&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">data_gen</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((-10.0, -10.0, -10.0), -79.48767732128363),
 ((-10.0, -10.0, -9.0), -82.06969223580259),
 ((-10.0, -10.0, -8.0), -88.14484959324732),
 ((-10.0, -10.0, -7.0), -98.79564553233163),
 ((-10.0, -10.0, -6.0), -100.54401550033428),
 ((-10.0, -10.0, -5.0), -108.94733942986316),
 ((-10.0, -10.0, -4.0), -114.67929646511288),
 ((-10.0, -10.0, -3.0), -122.14685477082418),
 ((-10.0, -10.0, -2.0), -127.84849723837867),
 ((-10.0, -10.0, -1.0), -131.72740725100914)]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-Implement-$f(x;-w)$">
<a class="anchor" href="#3.-Implement-%24f(x;-w)%24" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Implement $f(x; w)$<a class="anchor-link" href="#3.-Implement-%24f(x;-w)%24"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We define the next class to implement the function approximation $f(x;w)$. This class is generic in <code>X</code> to allow for arbitrary data types $\mathcal X$. An instance of this class approximates a function $x â†¦ \mathbb R$. It enables:</p>
<ul>
<li>evaluation of $f(x;w)$ at specific predictor points</li>
<li>updating with additional $(x,\mathbb R)$ data points</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">'X'</span><span class="p">)</span> <span class="c1">#. for arbitrary data types scriptX</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">'F'</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s1">'FunctionApprox'</span><span class="p">)</span>
<span class="n">SMALL_NUM</span> <span class="o">=</span> <span class="mf">1e-6</span>

<span class="k">class</span> <span class="nc">FunctionApprox</span><span class="p">(</span><span class="n">ABC</span><span class="p">,</span> <span class="n">Generic</span><span class="p">[</span><span class="n">X</span><span class="p">]):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">F</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">F</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">F</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">objective_gradient</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span>
        <span class="n">xy_vals_seq</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
        <span class="n">obj_deriv_out_fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">X</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Gradient</span><span class="p">[</span><span class="n">F</span><span class="p">]:</span>
      <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_values_seq</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">X</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_value</span><span class="p">:</span> <span class="n">X</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">([</span><span class="n">x_value</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_with_gradient</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span>
        <span class="n">gradient</span><span class="p">:</span> <span class="n">Gradient</span><span class="p">[</span><span class="n">F</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">F</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span>
        <span class="n">xy_vals_seq</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">F</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">deriv_func</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">X</span><span class="p">],</span> <span class="n">y</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_with_gradient</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objective_gradient</span><span class="p">(</span><span class="n">xy_vals_seq</span><span class="p">,</span> <span class="n">deriv_func</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span>
        <span class="n">xy_vals_seq</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
        <span class="n">error_tolerance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">F</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">iterate_updates</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span>
        <span class="n">xy_seq_stream</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">F</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">iterate</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span>
            <span class="n">xy_seq_stream</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">fa</span><span class="p">,</span> <span class="n">xy</span><span class="p">:</span> <span class="n">fa</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">xy</span><span class="p">),</span>
            <span class="n">initial</span><span class="o">=</span><span class="bp">self</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">xy_vals_seq</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">x_seq</span><span class="p">,</span> <span class="n">y_seq</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">xy_vals_seq</span><span class="p">)</span>
        <span class="n">errors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_seq</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_seq</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">errors</span> <span class="o">*</span> <span class="n">errors</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">argmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">X</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">X</span><span class="p">:</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">X</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">args</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">args</span><span class="p">))]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4.-Implement-Tabular">
<a class="anchor" href="#4.-Implement-Tabular" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. Implement Tabular<a class="anchor-link" href="#4.-Implement-Tabular"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we implement the main class of this project: <code>Tabular</code>. A tabular prediction fits well into the interface of <code>FunctionApprox</code>. By considering tabular prediction as a special case of the class <code>FunctionApprox</code>, we can cast the</p>
<ul>
<li>Tabular DP algorithms as special cases of the function approximation versions of the algorithms</li>
<li>Tabular RL algorithms as special cases of the function approximation versions of the algorithms
We do all this by using the <code>Tabular</code> class.</li>
</ul>
<p>The <code>Tabular</code> class approximates a function with a discrete domain (<code>X</code>), without interpolation. The value for each <code>X</code> is maintained as a weighted average of observations based on recency (tracked by <code>count_to_weight_func</code>).</p>
<p>So here is the implementation of this class:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Tabular</span><span class="p">(</span><span class="n">FunctionApprox</span><span class="p">[</span><span class="n">X</span><span class="p">]):</span>
    <span class="n">values_map</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{})</span>
    <span class="n">counts_map</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{})</span>
    <span class="n">count_to_weight_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">objective_gradient</span><span class="p">(</span> <span class="c1">#. scriptG(w_t)</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">xy_vals_seq</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
        <span class="n">obj_deriv_out_fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">X</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">float</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Gradient</span><span class="p">[</span><span class="n">Tabular</span><span class="p">[</span><span class="n">X</span><span class="p">]]:</span>
        <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">xy_vals_seq</span><span class="p">)</span>
        <span class="n">obj_deriv_out</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">obj_deriv_out_fun</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
        <span class="n">sums_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">counts_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">obj_deriv_out</span><span class="p">):</span>
            <span class="n">sums_map</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">o</span>
            <span class="n">counts_map</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">Gradient</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">values_map</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">sums_map</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">/</span> <span class="n">counts_map</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sums_map</span><span class="p">},</span>
            <span class="n">counts_map</span><span class="o">=</span><span class="n">counts_map</span>
        <span class="p">))</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Tabular</span><span class="p">[</span><span class="n">X</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tabular</span><span class="p">[</span><span class="n">X</span><span class="p">]:</span>
        <span class="n">values_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">counts_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">):</span>
            <span class="n">values_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span> <span class="o">+</span> \
                <span class="n">other</span><span class="o">.</span><span class="n">values_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
            <span class="n">counts_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> \
                <span class="n">other</span><span class="o">.</span><span class="n">counts_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">values_map</span><span class="o">=</span><span class="n">values_map</span><span class="p">,</span>
            <span class="n">counts_map</span><span class="o">=</span><span class="n">counts_map</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tabular</span><span class="p">[</span><span class="n">X</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">values_map</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">scalar</span><span class="o">*</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_values_seq</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">X</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">values_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_values_seq</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">update_with_gradient</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gradient</span><span class="p">:</span> <span class="n">Gradient</span><span class="p">[</span><span class="n">Tabular</span><span class="p">[</span><span class="n">X</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tabular</span><span class="p">[</span><span class="n">X</span><span class="p">]:</span>
        <span class="n">values_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values_map</span><span class="p">)</span>
        <span class="n">counts_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_map</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">gradient</span><span class="o">.</span><span class="n">function_approx</span><span class="o">.</span><span class="n">values_map</span><span class="p">:</span>
            <span class="n">counts_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> \
                <span class="n">gradient</span><span class="o">.</span><span class="n">function_approx</span><span class="o">.</span><span class="n">counts_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_to_weight_func</span><span class="p">(</span><span class="n">counts_map</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">values_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span> <span class="o">-</span> \
                <span class="n">weight</span> <span class="o">*</span> <span class="n">gradient</span><span class="o">.</span><span class="n">function_approx</span><span class="o">.</span><span class="n">values_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">values_map</span><span class="o">=</span><span class="n">values_map</span><span class="p">,</span>
            <span class="n">counts_map</span><span class="o">=</span><span class="n">counts_map</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">xy_vals_seq</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
        <span class="n">error_tolerance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tabular</span><span class="p">[</span><span class="n">X</span><span class="p">]:</span>
        <span class="n">values_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">counts_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">xy_vals_seq</span><span class="p">:</span>
            <span class="n">counts_map</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_to_weight_func</span><span class="p">(</span><span class="n">counts_map</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
            <span class="n">values_map</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">weight</span><span class="p">)</span> <span class="o">*</span> <span class="n">values_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">values_map</span><span class="o">=</span><span class="n">values_map</span><span class="p">,</span>
            <span class="n">counts_map</span><span class="o">=</span><span class="n">counts_map</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">FunctionApprox</span><span class="p">[</span><span class="n">X</span><span class="p">],</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Tabular</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values_map</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">values_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mf">0.</span><span class="p">))</span>
                       <span class="o">&lt;=</span> <span class="n">tolerance</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_map</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The attributes are:</p>
<ul>
<li>
<code>values_map: Mapping[X, float]</code><ul>
<li>mapping from each $x$-value to the average of the $y$-values associated with $x$ that have been seen so far</li>
</ul>
</li>
<li>
<code>counts_map: Mapping[X, int]</code><ul>
<li>mapping from each $x$-value to the count of $y$-values associated with $x$ that have been seen so far</li>
</ul>
</li>
<li>
<code>count_to_weight_func: Callable[[int], float]</code><ul>
<li>defines a function from number of $y$-values seen so far for each $x$, to the weight assigned to the most recent $y$.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The most important methods are:</p>
<ul>
<li>
<code>solve</code><ul>
<li>calculate the average of all the $y$-values associated with each $x$ in the provided data set and store it in a table</li>
<li>inputs<ul>
<li><code>xy_vals_seq: Iterable[Tuple[X, float]]</code></li>
<li><code>error_tolerance: Optional[float]=None</code></li>
</ul>
</li>
<li>output<ul>
<li><code>Tabular[X]</code></li>
</ul>
</li>
</ul>
</li>
<li>
<code>update</code><ul>
<li>Update the FunctionApprox's internal parameters $w$ defined in $f(x;w)$ based on incremental data supplied as $(x,y)$ pairs in the xy_vals_seq data structure.</li>
<li>inputs<ul>
<li>
<code>xy_vals_seq: Iterable[Tuple[X, float]]</code>  <ul>
<li>the $(x,y)$ pairs in the current iteration</li>
</ul>
</li>
</ul>
</li>
<li>ouputs<ul>
<li>
<code>F</code><ul>
<li>the <code>FunctionApprox</code> $f(x;w)$ corresponding to the updated parameters</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<code>evaluate</code><ul>
<li>Evaluate the function approximation by looking up the value in the mapping for each state. If an X value has not been seen before and hence not initialized,returns 0</li>
<li>inputs<ul>
<li><code>x_values_seq: Iterable[X]</code></li>
</ul>
</li>
<li>output<ul>
<li><code>np.ndarray</code></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>Gradient</code> class holds the <code>FunctionApprox F</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Gradient</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">F</span><span class="p">]):</span>
    <span class="n">function_approx</span><span class="p">:</span> <span class="n">F</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Gradient</span><span class="p">[</span><span class="n">F</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Gradient</span><span class="p">[</span><span class="n">F</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">F</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">F</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Gradient</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_approx</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">function_approx</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_approx</span> <span class="o">+</span> <span class="n">x</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Gradient</span><span class="p">[</span><span class="n">F</span><span class="p">],</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Gradient</span><span class="p">[</span><span class="n">F</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">Gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_approx</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Gradient</span><span class="p">[</span><span class="n">F</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">Gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_approx</span><span class="o">*</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="5-RMSE">
<a class="anchor" href="#5-RMSE" aria-hidden="true"><span class="octicon octicon-link"></span></a>5 RMSE<a class="anchor-link" href="#5-RMSE"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we run a training loop and plot the RMSE.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trn_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_gen</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">DataSeq</span><span class="p">]</span> <span class="o">=</span> <span class="n">example_model_data_generator</span><span class="p">()</span>
<span class="n">tst_data</span><span class="p">:</span> <span class="n">DataSeq</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">data_gen</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabular</span><span class="p">:</span> <span class="n">Tabular</span><span class="p">[</span><span class="n">Triple</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tabular</span><span class="p">()</span>
<span class="n">rmses</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">xy_seq</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">data_gen</span><span class="p">,</span> <span class="n">trn_iterations</span><span class="p">):</span>
    <span class="n">tabular</span> <span class="o">=</span> <span class="n">tabular</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">xy_seq</span><span class="p">)</span>
    <span class="n">rmse</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">tabular</span><span class="o">.</span><span class="n">rmse</span><span class="p">(</span><span class="n">tst_data</span><span class="p">)</span>
    <span class="n">rmses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>RMSE: 2.83
RMSE: 2.45
RMSE: 2.31
RMSE: 2.24
RMSE: 2.19
RMSE: 2.16
RMSE: 2.13
RMSE: 2.12
RMSE: 2.11
RMSE: 2.10
RMSE: 2.09
RMSE: 2.08
RMSE: 2.08
RMSE: 2.07
RMSE: 2.07
RMSE: 2.06
RMSE: 2.06
RMSE: 2.05
RMSE: 2.05
RMSE: 2.05
RMSE: 2.05
RMSE: 2.04
RMSE: 2.04
RMSE: 2.04
RMSE: 2.04
RMSE: 2.04
RMSE: 2.03
RMSE: 2.03
RMSE: 2.03
RMSE: 2.03
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Iterations'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Tabular: RMSE'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rmses</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>WARNING:matplotlib.legend:No handles with labels found to put in legend.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="LearnableLoopAI/portfolio2"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/inventory_management/markov_decision_process/python/2022/07/14/InventoryManagement6_PORT.html" hidden></a>
</article>