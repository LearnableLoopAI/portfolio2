<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Dynamic Portfolio Management with Deep Reinforcement Learning (Portfolio of Fidelity® Funds) | Kobus Esterhuysen — MS(Data Science), MBA, MSEE, BSc, DipData</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Dynamic Portfolio Management with Deep Reinforcement Learning (Portfolio of Fidelity® Funds)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="DRL is used to provide dynamic asset allocation for a portfolio" />
<meta property="og:description" content="DRL is used to provide dynamic asset allocation for a portfolio" />
<link rel="canonical" href="https://learnableloop.com/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/19/PortfolioManagement_FidelityFunds.html" />
<meta property="og:url" content="https://learnableloop.com/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/19/PortfolioManagement_FidelityFunds.html" />
<meta property="og:site_name" content="Kobus Esterhuysen — MS(Data Science), MBA, MSEE, BSc, DipData" />
<meta property="og:image" content="https://learnableloop.com/images/PortfolioManagement-FidelityFunds.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-19T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"DRL is used to provide dynamic asset allocation for a portfolio","url":"https://learnableloop.com/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/19/PortfolioManagement_FidelityFunds.html","@type":"BlogPosting","headline":"Dynamic Portfolio Management with Deep Reinforcement Learning (Portfolio of Fidelity® Funds)","dateModified":"2021-11-19T00:00:00-06:00","datePublished":"2021-11-19T00:00:00-06:00","image":"https://learnableloop.com/images/PortfolioManagement-FidelityFunds.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://learnableloop.com/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/19/PortfolioManagement_FidelityFunds.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://learnableloop.com/feed.xml" title="Kobus Esterhuysen --- MS(Data Science), MBA, MSEE, BSc, DipData" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7YVR807GNV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7YVR807GNV');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Kobus Esterhuysen --- MS(Data Science), MBA, MSEE, BSc, DipData</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Dynamic Portfolio Management with Deep Reinforcement Learning (Portfolio of Fidelity® Funds)</h1><p class="page-description">DRL is used to provide dynamic asset allocation for a portfolio</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-11-19T00:00:00-06:00" itemprop="datePublished">
        Nov 19, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      60 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Investment_Industry">Investment_Industry</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Reinforcement_Learning">Reinforcement_Learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#A2C">A2C</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#PPO">PPO</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#OpenAI">OpenAI</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Gym">Gym</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#finrl">finrl</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#stable_baselines3">stable_baselines3</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#pyfolio">pyfolio</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#1.-Problem:-Dynamic-Asset-Allocation">1. Problem: Dynamic Asset Allocation </a></li>
<li class="toc-entry toc-h2"><a href="#2.-Solution-Proposal">2. Solution Proposal </a></li>
<li class="toc-entry toc-h2"><a href="#3.-Implementation-of-the-Solution">3. Implementation of the Solution </a>
<ul>
<li class="toc-entry toc-h3"><a href="#3.0-Parameters">3.0 Parameters </a></li>
<li class="toc-entry toc-h3"><a href="#3.1-Download-Data">3.1 Download Data </a></li>
<li class="toc-entry toc-h3"><a href="#3.2-Data-Understanding-and-Preparation">3.2 Data Understanding and Preparation </a>
<ul>
<li class="toc-entry toc-h4"><a href="#3.2.1-Add-technical-indicators">3.2.1 Add technical indicators </a></li>
<li class="toc-entry toc-h4"><a href="#3.2.2-Add-covariance-matrix-as-a-feature">3.2.2 Add covariance matrix as a feature </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#3.3-Modeling">3.3 Modeling </a>
<ul>
<li class="toc-entry toc-h4"><a href="#3.3.1-Training-data">3.3.1 Training data </a></li>
<li class="toc-entry toc-h4"><a href="#3.3.2-Portfolio-(Environment)">3.3.2 Portfolio (Environment) </a></li>
<li class="toc-entry toc-h4"><a href="#3.3.3-Portfolio-Manager-(Agent)">3.3.3 Portfolio Manager (Agent) </a>
<ul>
<li class="toc-entry toc-h5"><a href="#3.3.3.1-A2C">3.3.3.1 A2C </a></li>
<li class="toc-entry toc-h5"><a href="#3.3.3.2-PPO">3.3.3.2 PPO </a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#3.4-Evaluation">3.4 Evaluation </a>
<ul>
<li class="toc-entry toc-h4"><a href="#3.4.1-Inspect-actions">3.4.1 Inspect actions </a></li>
<li class="toc-entry toc-h4"><a href="#3.4.2-Inspect-daily-return">3.4.2 Inspect daily return </a></li>
<li class="toc-entry toc-h4"><a href="#3.4.3-Inspect-cumulative-return">3.4.3 Inspect cumulative return </a></li>
</ul>
</li>
</ul>
</li>
</ul><body>
<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-11-19-PortfolioManagement_FidelityFunds.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-Problem:-Dynamic-Asset-Allocation">
<a class="anchor" href="#1.-Problem:-Dynamic-Asset-Allocation" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Problem: Dynamic Asset Allocation<a class="anchor-link" href="#1.-Problem:-Dynamic-Asset-Allocation"> </a>
</h2>
<p><em>Asset allocation</em> refers to the partitioning of available funds in a portfolio among various investment products. Investment products may be categorized in multiple ways. One common (and high level) classification contains three classes:</p>
<ul>
<li>Stocks</li>
<li>Bonds (fixed income)</li>
<li>Cash and cash equivalents</li>
</ul>
<p>Other classification systems may sub-classify each of these categories into subclasses, for example stocks into US and International stocks, or into small-cap, medium-cap, and large-cap stocks, etc.</p>
<p>Another aspect of asset allocation is concerns the underlying <em>strategy</em>. Some strategies are:</p>
<ul>
<li>Tactical asset allocation</li>
<li>Strategic asset allocation</li>
<li>Constant weight asset allocation</li>
<li>Integrated asset allocation</li>
<li>Insured asset allocation</li>
<li>Dynamic asset allocation</li>
</ul>
<p>We will focus on the last of these strategies: Dynamic asset allocation. With this approach the combination of assets are adjusted at regular intervals to capitalize on the strengthening and weakening of the economy and rise and fall of markets. This strategy depends on the decisions of a portfolio manager. In this project, however, we will attempt to replace the portfolio manager with an <em>AI agent</em>. The agent will be trained on past market behavior by means of <em>Deep Reinforcement Learning</em>.</p>
<p>For this Proof-Of-Concept (POC) project we will make things as simple as possible. The portfolio will consist of 9 Fidelity mutual funds. We will use the DJIA as a handy reference against which the performance of our agent's dynamic behavior can be compared. Our agent will have the opportunity to adjust the mix of these funds on a daily basis. In practice, a 401K agent, for example, might be setup to make monthly adjustments to reduce transation costs or to avoid constraints related to trading. For simplicity, trading costs will not be taken into account for now.</p>
<p>We have selected a mutual fund from a number of fund categories:</p>
<ul>
<li>
<p>Large Value</p>
<ul>
<li>Fidelity® Blue Chip Value Fund (FBCVX)</li>
</ul>
</li>
<li>
<p>Small/Mid Value</p>
<ul>
<li>Fidelity® Mid-Cap Value Fund (FSMVX)</li>
</ul>
</li>
<li>
<p>Income-Oriented</p>
<ul>
<li>Fidelity® Dividend Growth Fund (FDGFX)</li>
</ul>
</li>
<li>
<p>Large Blend</p>
<ul>
<li>Fidelity® US Low Volatility Equity Fund (FULVX)</li>
</ul>
</li>
<li>
<p>Small/Mid Blend</p>
<ul>
<li>Fidelity® Stock Selector Small-Cap Fund (FDSCX)</li>
</ul>
</li>
<li>
<p>Go-Anywhere</p>
<ul>
<li>Fidelity® Capital Appreciation Fund (FDCAX)</li>
</ul>
</li>
<li>
<p>Large Growth</p>
<ul>
<li>Fidelity® Growth Discovery Fund (FDSVX)</li>
</ul>
</li>
<li>
<p>Small/Mid Growth</p>
<ul>
<li>Fidelity® Small-Cap Growth Fund (FCPGX)</li>
</ul>
</li>
<li>
<p>Diversifiers</p>
<ul>
<li>Fidelity® Founders Fund (FIFNX)</li>
</ul>
</li>
</ul>
<p>Our agent will have $ 1,000,000 when the project starts.</p>
<p>To implement this POC we will make use of the FinRL framework as well as some Yahoo technology to acquire financial data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Solution-Proposal">
<a class="anchor" href="#2.-Solution-Proposal" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Solution Proposal<a class="anchor-link" href="#2.-Solution-Proposal"> </a>
</h2>
<p>Investment decisions are sequential by nature. Furthermore, an optimal decision in the present may turn out not to be optimal over the longer term. Then there are the complexities of the investment landscape like varying market conditions, political disruptive event, and other economic uncertainties. The ideal tool for this kind of problem is <strong>Reinforcement Learning</strong>.</p>
<p>The solution requires the setup of a <strong>digital twin</strong> for the investor's portfolio. In RL parlance this model of the portfolio is called an <strong>environment</strong>. The environment contains <strong>states</strong> which are modified by applying <strong>actions</strong> to it.</p>
<p>We will choose the following <strong>states</strong> (measured daily in our case) for the environment:</p>
$$ \Large
\begin{aligned}
s_1 &amp;= \text{Value of FBCVX holdings} \\
s_2 &amp;= \text{Value of FSMVX holdings} \\
s_3 &amp;= \text{Value of FDGFX holdings} \\
\text{...} \\
s_8 &amp;= \text{Value of FCPGX holdings} \\
s_9 &amp;= \text{Value of FIFNX holdings}
\end{aligned}
$$<p>The following <strong>actions</strong> (applied daily in our case) will be setup to influence the environment/portfolio:</p>
$$ \Large
\begin{aligned}
a_1 &amp;= \text{Fraction to be invested in FBCVX this cycle} \\
a_2 &amp;= \text{Fraction to be invested in FSMVX this cycle} \\
a_3 &amp;= \text{Fraction to be invested in FDGFX this cycle} \\
\text{...} \\
a_8 &amp;= \text{Fraction to be invested in FCPGX this cycle} \\
a_9 &amp;= \text{Fraction to be invested in FIFNX this cycle}
\end{aligned}
$$<p>All action values are in the [0, 1] interval.</p>
<p>The <em>reward</em> <em>r</em> is given by</p>
$$ \Large
\begin{aligned}
r(s,a,s') &amp;= log(v'/v)
\end{aligned}
$$<p>where <em>v</em> and <em>v'</em> are the portfolio value at states $s'$ and $s$ respectively.</p>
<p>The model of the portfolio/environment will have the following <strong>parameters</strong>:</p>
$$ \Large 
\begin{aligned}
\theta_1 &amp;= \text{Initial Amount} \\
\theta_2 &amp;= \text{Transaction Cost Pct} \\
\theta_3 &amp;= \text{Size of State and Action Spaces} \\
\theta_4 &amp;= \text{Reward Scaling} \\
\theta_5 &amp;= \text{Technical Indicator List}
\end{aligned}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-Implementation-of-the-Solution">
<a class="anchor" href="#3.-Implementation-of-the-Solution" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Implementation of the Solution<a class="anchor-link" href="#3.-Implementation-of-the-Solution"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To implement the <em>environment</em> we use the OpenAI Gym tools. We will use the FinRL python library to implement the <em>agent</em>. For a function approximator for the agent, two algorithms will be investigated:</p>
<ul>
<li>Advantage Actor-Critic (A2C)</li>
<li>Proximal Policy Optimization (PPO)</li>
</ul>
<p>This implementation allows the agent to allocate the investor's funds between the 30 DJIA  instruments. The goal is to maximize net worth at the end of the investment horizon.</p>
<p>The plotly library will be used for visualization. The code will run on the Google Colab platform. To start with, we install the python packages needed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import the packages needed:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">'Agg'</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">datetime</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">finrl.apps</span> <span class="kn">import</span> <span class="n">config</span>
<span class="kn">from</span> <span class="nn">finrl.neo_finrl.preprocessor.yahoodownloader</span> <span class="kn">import</span> <span class="n">YahooDownloader</span>
<span class="kn">from</span> <span class="nn">finrl.neo_finrl.preprocessor.preprocessors</span> <span class="kn">import</span> <span class="n">FeatureEngineer</span><span class="p">,</span> <span class="n">data_split</span>
<span class="kn">from</span> <span class="nn">finrl.neo_finrl.env_portfolio_allocation.env_portfolio</span> <span class="kn">import</span> <span class="n">StockPortfolioEnv</span>
<span class="kn">from</span> <span class="nn">finrl.drl_agents.stablebaselines3.models</span> <span class="kn">import</span> <span class="n">DRLAgent</span>
<span class="kn">from</span> <span class="nn">finrl.plot</span> <span class="kn">import</span> <span class="n">backtest_stats</span><span class="p">,</span> <span class="n">backtest_plot</span><span class="p">,</span> <span class="n">get_daily_return</span><span class="p">,</span> <span class="n">get_baseline</span><span class="p">,</span><span class="n">convert_daily_return_to_pyfolio_ts</span>

<span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">from</span> <span class="nn">gym.utils</span> <span class="kn">import</span> <span class="n">seeding</span>
<span class="kn">from</span> <span class="nn">gym</span> <span class="kn">import</span> <span class="n">spaces</span>
<span class="kn">from</span> <span class="nn">stable_baselines3.common.vec_env</span> <span class="kn">import</span> <span class="n">DummyVecEnv</span>

<span class="kn">from</span> <span class="nn">pyfolio</span> <span class="kn">import</span> <span class="n">timeseries</span>
<span class="kn">import</span> <span class="nn">plotly</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/pyfolio/pos.py:27: UserWarning: Module "zipline.assets" not found; multipliers will not be applied to position notionals.
  'Module "zipline.assets" not found; multipliers will not be applied'
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"../FinRL-Library"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Setup some directories:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">DATA_SAVE_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">DATA_SAVE_DIR</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TRAINED_MODEL_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TRAINED_MODEL_DIR</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TENSORBOARD_LOG_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TENSORBOARD_LOG_DIR</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">RESULTS_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">RESULTS_DIR</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.0-Parameters">
<a class="anchor" href="#3.0-Parameters" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.0 Parameters<a class="anchor-link" href="#3.0-Parameters"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DATA_START</span> <span class="o">=</span> <span class="s1">'2008-01-01'</span> 
<span class="n">TRAIN_START</span> <span class="o">=</span> <span class="s1">'2009-01-01'</span>
<span class="n">TRADE_START</span> <span class="o">=</span> <span class="s1">'2020-07-01'</span>
<span class="n">DATA_END</span> <span class="o">=</span> <span class="s1">'2021-09-01'</span>
<span class="n">LOOKBACK</span> <span class="o">=</span> <span class="mi">252</span> <span class="c1">#trading days in one year</span>
<span class="n">INITIAL_AMOUNT</span> <span class="o">=</span> <span class="mi">1_000_000</span> <span class="c1">#dollars</span>
<span class="n">TRANSACTION_COST_PCT</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">REWARD_SCALING</span> <span class="o">=</span> <span class="mf">1e-1</span> <span class="c1">#scaling factor applied to the reward signal</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.1-Download-Data">
<a class="anchor" href="#3.1-Download-Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.1 Download Data<a class="anchor-link" href="#3.1-Download-Data"> </a>
</h3>
<p>We use the data from Yahoo Finance.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_tickers</span> <span class="o">=</span> <span class="p">[</span>
  <span class="c1"># Large Value</span>
  <span class="s1">'FBCVX'</span><span class="p">,</span> <span class="c1">#Fidelity® Blue Chip Value Fund</span>
  <span class="c1"># 'FLVEX', #Fidelity® Large-Cap Value Enhanced Index Fund</span>
  <span class="c1"># 'FSLVX', #Fidelity® Stock Selector Large-Cap Value Fund</span>
  <span class="c1"># 'FVDFX', #Fidelity® Value Discovery Fund</span>

  <span class="c1"># Small/Mid Value</span>
  <span class="c1"># 'FLPSX', #Fidelity® Low-Priced Stock Fund</span>
  <span class="s1">'FSMVX'</span><span class="p">,</span> <span class="c1">#Fidelity® Mid-Cap Value Fund</span>
  <span class="c1"># 'FDVLX', #Fidelity® Value Fund</span>
  <span class="c1"># 'FSLSX', #Fidelity® Value Strategies Fund</span>
  <span class="c1"># 'FCPVX', #Fidelity® Small-Cap Value Fund</span>

  <span class="c1"># Income-Oriented</span>
  <span class="c1"># 'FEQTX', #Fidelity® Equity Dividend Income Fund</span>
  <span class="c1"># 'FEQIX', #Fidelity® Equity-Income Fund</span>
  <span class="c1"># 'FGRIX', #Fidelity® Growth &amp; Income Portfolio Fund</span>
  <span class="s1">'FDGFX'</span><span class="p">,</span> <span class="c1">#Fidelity® Dividend Growth Fund</span>

  <span class="c1"># Large Blend</span>
  <span class="c1"># 'FSEBX', #Fidelity® Sustainability U.S. Equity Fund, NEW</span>
  <span class="s1">'FULVX'</span><span class="p">,</span> <span class="c1">#Fidelity® US Low Volatility Equity Fund</span>
  <span class="c1"># 'FDEQX', #Fidelity® Disciplined Equity Fund</span>
  <span class="c1"># 'FLCEX', #Fidelity® Large-Cap Core Enhanced Index Fund</span>
  <span class="c1"># 'FLCSX', #Fidelity® Large-Cap Stock Fund</span>
  <span class="c1"># 'FGRTX', #Fidelity® Mega-Cap Stock Fund</span>

  <span class="c1"># Small/Mid Blend</span>
  <span class="c1"># 'FMEIX', #Fidelity® Mid-Cap Enhanced Index Fund</span>
  <span class="c1"># 'FCPEX', #Fidelity® Small-Cap Enhanced Index Fund</span>
  <span class="c1"># 'FSLCX', #Fidelity® Small-Cap Stock Fund</span>
  <span class="s1">'FDSCX'</span><span class="p">,</span> <span class="c1">#Fidelity® Stock Selector Small-Cap Fund</span>
  <span class="c1"># 'FSCRX', #Fidelity® Small-Cap Discovery Fund</span>

  <span class="c1"># Go-Anywhere</span>
  <span class="s1">'FDCAX'</span><span class="p">,</span> <span class="c1">#Fidelity® Capital Appreciation Fund</span>
  <span class="c1"># 'FCNTX', #Fidelity® Contrafund®</span>
  <span class="c1"># 'FMAGX', #Fidelity® Magellan® Fund</span>
  <span class="c1"># 'FMILX', #Fidelity® New Millennium Fund</span>

  <span class="c1"># Large Growth</span>
  <span class="c1"># 'FBGRX', #Fidelity® Blue Chip Growth Fund</span>
  <span class="c1"># 'FEXPX', #Fidelity® Export &amp; Multinational Fund</span>
  <span class="c1"># 'FTQGX', #Fidelity® Focused Stock Fund</span>
  <span class="c1"># 'FFIDX', #Fidelity® Fund</span>
  <span class="s1">'FDSVX'</span><span class="p">,</span> <span class="c1">#Fidelity® Growth Discovery Fund</span>
  <span class="c1"># 'FDGRX', #Fidelity® Growth Company Fund</span>
  <span class="c1"># 'FLGEX', #Fidelity® Large-Cap Growth Enhanced Index Fund</span>
  <span class="c1"># 'FOCPX', #Fidelity® OTC Portfolio</span>
  <span class="c1"># 'FDSSX', #Fidelity® Stock Selector All Cap Fund</span>
  <span class="c1"># 'FTRNX', #Fidelity® Trend Fund</span>

  <span class="c1"># Small/Mid Growth</span>
  <span class="c1"># 'FDEGX', #Fidelity® Growth Strategies Fund</span>
  <span class="c1"># 'FMCSX', #Fidelity® Mid-Cap Stock Fund</span>
  <span class="c1"># 'FSSMX', #Fidelity® Stock Selector Mid-Cap Fund</span>
  <span class="s1">'FCPGX'</span><span class="p">,</span> <span class="c1">#Fidelity® Small-Cap Growth Fund</span>

  <span class="c1"># Diversifiers</span>
  <span class="c1"># 'FWOMX', #Fidelity® Women's Leadership Fund</span>
  <span class="s1">'FIFNX'</span><span class="p">,</span> <span class="c1">#Fidelity® Founders Fund</span>
  <span class="c1"># 'FLVCX', #Fidelity® Leveraged Company Stock Fund</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">YahooDownloader</span><span class="p">(</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">DATA_START</span><span class="p">,</span>
                     <span class="n">end_date</span> <span class="o">=</span> <span class="n">DATA_END</span><span class="p">,</span>
                     <span class="c1"># ticker_list = config.DOW_30_TICKER).fetch_data()</span>
                     <span class="n">ticker_list</span> <span class="o">=</span> <span class="n">my_tickers</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
Shape of DataFrame:  (25183, 8)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>14.420000</td>
      <td>14.420000</td>
      <td>14.420000</td>
      <td>11.721002</td>
      <td>0</td>
      <td>FBCVX</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-01-02</td>
      <td>15.660000</td>
      <td>15.660000</td>
      <td>15.660000</td>
      <td>6.663240</td>
      <td>0</td>
      <td>FCPGX</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-01-02</td>
      <td>26.370001</td>
      <td>26.370001</td>
      <td>26.370001</td>
      <td>11.040798</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-01-02</td>
      <td>28.930000</td>
      <td>28.930000</td>
      <td>28.930000</td>
      <td>10.950327</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-01-02</td>
      <td>19.670000</td>
      <td>19.670000</td>
      <td>19.670000</td>
      <td>11.192782</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25178</th>
      <td>2021-08-31</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25179</th>
      <td>2021-08-31</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>0</td>
      <td>FDSVX</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25180</th>
      <td>2021-08-31</td>
      <td>19.110001</td>
      <td>19.110001</td>
      <td>19.110001</td>
      <td>19.110001</td>
      <td>0</td>
      <td>FIFNX</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25181</th>
      <td>2021-08-31</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>0</td>
      <td>FSMVX</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25182</th>
      <td>2021-08-31</td>
      <td>12.160000</td>
      <td>12.160000</td>
      <td>12.160000</td>
      <td>12.160000</td>
      <td>0</td>
      <td>FULVX</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>25183 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Verify 2 unique tickers</span>
<span class="c1"># https://www.investopedia.com/ask/answers/who-or-what-is-dow-jones/</span>
<span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'tic'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">),</span> <span class="n">lst</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>9 ['FBCVX', 'FCPGX', 'FDCAX', 'FDGFX', 'FDSCX', 'FDSVX', 'FSMVX', 'FIFNX', 'FULVX']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.2-Data-Understanding-and-Preparation">
<a class="anchor" href="#3.2-Data-Understanding-and-Preparation" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2 Data Understanding and Preparation<a class="anchor-link" href="#3.2-Data-Understanding-and-Preparation"> </a>
</h3>
<p>We will keep showing snippets of the data set as it evolves to assist with understanding. There is a need to check for missing data and also to do some feature engineering. We rely on the FeatureEngineer class to take care of these needs. Some indicators used are:</p>
<ul>
<li>Moving Average Convergence Divergence (MACD)</li>
</ul>
<p>The MACD is primarily used to gauge the strength of stock price movement. It does this by measuring the divergence of two exponential moving averages (EMAs), commonly a 12-period EMA and a 26-period EMA.</p>
<ul>
<li>Relative Strength Index (RSI)</li>
</ul>
<p>The RSI aims to indicate whether a market is considered to be overbought or oversold in relation to recent price levels.</p>
<ul>
<li>Commodity Channel Index (CCI)</li>
</ul>
<p>The Commodity Channel Index​ (CCI) is a momentum-based oscillator used to help determine when an investment vehicle is reaching a condition of being overbought or oversold.</p>
<p>FinRL also uses the financial turbulence index that measures extreme asset price fluctuation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.2.1-Add-technical-indicators">
<a class="anchor" href="#3.2.1-Add-technical-indicators" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2.1 Add technical indicators<a class="anchor-link" href="#3.2.1-Add-technical-indicators"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">fe</span> <span class="o">=</span> <span class="n">FeatureEngineer</span><span class="p">(</span>
  <span class="n">use_technical_indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">use_turbulence</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">user_defined_feature</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">preprocess_data</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Successfully added technical indicators
CPU times: user 15.6 s, sys: 1.76 s, total: 17.4 s
Wall time: 15.7 s
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>14.420000</td>
      <td>14.420000</td>
      <td>14.420000</td>
      <td>11.721002</td>
      <td>0</td>
      <td>FBCVX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>11.721002</td>
      <td>11.721002</td>
    </tr>
    <tr>
      <th>3441</th>
      <td>2008-01-02</td>
      <td>15.660000</td>
      <td>15.660000</td>
      <td>15.660000</td>
      <td>6.663240</td>
      <td>0</td>
      <td>FCPGX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>6.663240</td>
      <td>6.663240</td>
    </tr>
    <tr>
      <th>6882</th>
      <td>2008-01-02</td>
      <td>26.370001</td>
      <td>26.370001</td>
      <td>26.370001</td>
      <td>11.040798</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>11.040798</td>
      <td>11.040798</td>
    </tr>
    <tr>
      <th>10323</th>
      <td>2008-01-02</td>
      <td>28.930000</td>
      <td>28.930000</td>
      <td>28.930000</td>
      <td>10.950327</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>10.950327</td>
      <td>10.950327</td>
    </tr>
    <tr>
      <th>13764</th>
      <td>2008-01-02</td>
      <td>19.670000</td>
      <td>19.670000</td>
      <td>19.670000</td>
      <td>11.192782</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>11.192782</td>
      <td>11.192782</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10322</th>
      <td>2021-08-31</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>1</td>
      <td>0.485560</td>
      <td>50.233594</td>
      <td>47.837405</td>
      <td>63.290963</td>
      <td>186.262675</td>
      <td>33.935129</td>
      <td>48.798333</td>
      <td>48.066166</td>
    </tr>
    <tr>
      <th>13763</th>
      <td>2021-08-31</td>
      <td>37.290001</td>
      <td>37.290001</td>
      <td>37.290001</td>
      <td>35.175362</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>1</td>
      <td>0.160866</td>
      <td>35.429981</td>
      <td>34.401928</td>
      <td>56.769455</td>
      <td>108.062182</td>
      <td>14.914749</td>
      <td>34.818795</td>
      <td>34.498705</td>
    </tr>
    <tr>
      <th>17204</th>
      <td>2021-08-31</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>1</td>
      <td>0.355394</td>
      <td>36.956232</td>
      <td>34.422768</td>
      <td>56.811784</td>
      <td>158.442705</td>
      <td>22.592461</td>
      <td>35.431666</td>
      <td>35.356833</td>
    </tr>
    <tr>
      <th>20645</th>
      <td>2021-08-31</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>0</td>
      <td>FDSVX</td>
      <td>1</td>
      <td>0.616046</td>
      <td>56.891673</td>
      <td>53.754767</td>
      <td>63.869985</td>
      <td>13.372480</td>
      <td>1.499019</td>
      <td>55.064085</td>
      <td>54.107896</td>
    </tr>
    <tr>
      <th>24086</th>
      <td>2021-08-31</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>0</td>
      <td>FSMVX</td>
      <td>1</td>
      <td>0.269141</td>
      <td>29.717076</td>
      <td>28.292924</td>
      <td>56.730943</td>
      <td>100.071603</td>
      <td>17.984678</td>
      <td>28.728666</td>
      <td>28.399833</td>
    </tr>
  </tbody>
</table>
<p>24087 rows × 16 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see that the FeatureEngineer has added some features:</p>
<ul>
<li>macd</li>
<li>boll_ub (upper Bollinger Band)</li>
<li>boll_lb (lower Bollinger Band)</li>
<li>rsi_30 (with a lookback of 30)</li>
<li>cci_30 (with a lookback of 30)</li>
<li>dx_30 (with a lookback of 30)</li>
<li>close_30_sma (close price simple moving average with a lookback of 30)</li>
<li>close_60_sma (close price simple moving average with a lookback of 60)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.2.2-Add-covariance-matrix-as-a-feature">
<a class="anchor" href="#3.2.2-Add-covariance-matrix-as-a-feature" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2.2 Add covariance matrix as a feature<a class="anchor-link" href="#3.2.2-Add-covariance-matrix-as-a-feature"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Adding the portfolio's covariance matrix as a feature has some advantages. It can be used to quantify the risk (standard deviation) associated with a portfolio.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'tic'</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>14.420000</td>
      <td>14.420000</td>
      <td>14.420000</td>
      <td>11.721002</td>
      <td>0</td>
      <td>FBCVX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>11.721002</td>
      <td>11.721002</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-01-02</td>
      <td>15.660000</td>
      <td>15.660000</td>
      <td>15.660000</td>
      <td>6.663240</td>
      <td>0</td>
      <td>FCPGX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>6.663240</td>
      <td>6.663240</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-01-02</td>
      <td>26.370001</td>
      <td>26.370001</td>
      <td>26.370001</td>
      <td>11.040798</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>11.040798</td>
      <td>11.040798</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-01-02</td>
      <td>28.930000</td>
      <td>28.930000</td>
      <td>28.930000</td>
      <td>10.950327</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>10.950327</td>
      <td>10.950327</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-01-02</td>
      <td>19.670000</td>
      <td>19.670000</td>
      <td>19.670000</td>
      <td>11.192782</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>11.192782</td>
      <td>11.192782</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>24082</th>
      <td>2021-08-31</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>1</td>
      <td>0.485560</td>
      <td>50.233594</td>
      <td>47.837405</td>
      <td>63.290963</td>
      <td>186.262675</td>
      <td>33.935129</td>
      <td>48.798333</td>
      <td>48.066166</td>
    </tr>
    <tr>
      <th>24083</th>
      <td>2021-08-31</td>
      <td>37.290001</td>
      <td>37.290001</td>
      <td>37.290001</td>
      <td>35.175362</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>1</td>
      <td>0.160866</td>
      <td>35.429981</td>
      <td>34.401928</td>
      <td>56.769455</td>
      <td>108.062182</td>
      <td>14.914749</td>
      <td>34.818795</td>
      <td>34.498705</td>
    </tr>
    <tr>
      <th>24084</th>
      <td>2021-08-31</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>1</td>
      <td>0.355394</td>
      <td>36.956232</td>
      <td>34.422768</td>
      <td>56.811784</td>
      <td>158.442705</td>
      <td>22.592461</td>
      <td>35.431666</td>
      <td>35.356833</td>
    </tr>
    <tr>
      <th>24085</th>
      <td>2021-08-31</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>0</td>
      <td>FDSVX</td>
      <td>1</td>
      <td>0.616046</td>
      <td>56.891673</td>
      <td>53.754767</td>
      <td>63.869985</td>
      <td>13.372480</td>
      <td>1.499019</td>
      <td>55.064085</td>
      <td>54.107896</td>
    </tr>
    <tr>
      <th>24086</th>
      <td>2021-08-31</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>0</td>
      <td>FSMVX</td>
      <td>1</td>
      <td>0.269141</td>
      <td>29.717076</td>
      <td>28.292924</td>
      <td>56.730943</td>
      <td>100.071603</td>
      <td>17.984678</td>
      <td>28.728666</td>
      <td>28.399833</td>
    </tr>
  </tbody>
</table>
<p>24087 rows × 16 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">factorize</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#. now each new date has a new index</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>14.420000</td>
      <td>14.420000</td>
      <td>14.420000</td>
      <td>11.721002</td>
      <td>0</td>
      <td>FBCVX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>11.721002</td>
      <td>11.721002</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>15.660000</td>
      <td>15.660000</td>
      <td>15.660000</td>
      <td>6.663240</td>
      <td>0</td>
      <td>FCPGX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>6.663240</td>
      <td>6.663240</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>26.370001</td>
      <td>26.370001</td>
      <td>26.370001</td>
      <td>11.040798</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>11.040798</td>
      <td>11.040798</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>28.930000</td>
      <td>28.930000</td>
      <td>28.930000</td>
      <td>10.950327</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>10.950327</td>
      <td>10.950327</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>19.670000</td>
      <td>19.670000</td>
      <td>19.670000</td>
      <td>11.192782</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>2</td>
      <td>0.000000</td>
      <td>11.743293</td>
      <td>11.674326</td>
      <td>0.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>11.192782</td>
      <td>11.192782</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3440</th>
      <td>2021-08-31</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>1</td>
      <td>0.485560</td>
      <td>50.233594</td>
      <td>47.837405</td>
      <td>63.290963</td>
      <td>186.262675</td>
      <td>33.935129</td>
      <td>48.798333</td>
      <td>48.066166</td>
    </tr>
    <tr>
      <th>3440</th>
      <td>2021-08-31</td>
      <td>37.290001</td>
      <td>37.290001</td>
      <td>37.290001</td>
      <td>35.175362</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>1</td>
      <td>0.160866</td>
      <td>35.429981</td>
      <td>34.401928</td>
      <td>56.769455</td>
      <td>108.062182</td>
      <td>14.914749</td>
      <td>34.818795</td>
      <td>34.498705</td>
    </tr>
    <tr>
      <th>3440</th>
      <td>2021-08-31</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>1</td>
      <td>0.355394</td>
      <td>36.956232</td>
      <td>34.422768</td>
      <td>56.811784</td>
      <td>158.442705</td>
      <td>22.592461</td>
      <td>35.431666</td>
      <td>35.356833</td>
    </tr>
    <tr>
      <th>3440</th>
      <td>2021-08-31</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>0</td>
      <td>FDSVX</td>
      <td>1</td>
      <td>0.616046</td>
      <td>56.891673</td>
      <td>53.754767</td>
      <td>63.869985</td>
      <td>13.372480</td>
      <td>1.499019</td>
      <td>55.064085</td>
      <td>54.107896</td>
    </tr>
    <tr>
      <th>3440</th>
      <td>2021-08-31</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>0</td>
      <td>FSMVX</td>
      <td>1</td>
      <td>0.269141</td>
      <td>29.717076</td>
      <td>28.292924</td>
      <td>56.730943</td>
      <td>100.071603</td>
      <td>17.984678</td>
      <td>28.728666</td>
      <td>28.399833</td>
    </tr>
  </tbody>
</table>
<p>24087 rows × 16 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">cov_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">return_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">LOOKBACK</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unique</span><span class="p">())):</span>
  <span class="n">data_lookback</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">LOOKBACK</span><span class="p">:</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
  <span class="n">price_lookback</span> <span class="o">=</span> <span class="n">data_lookback</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">'date'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'tic'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">'close'</span><span class="p">)</span>
  <span class="n">return_lookback</span> <span class="o">=</span> <span class="n">price_lookback</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
  <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">return_lookback</span><span class="p">)</span>
  <span class="n">covs</span> <span class="o">=</span> <span class="n">return_lookback</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> 
  <span class="n">cov_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">covs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 43.9 s, sys: 581 ms, total: 44.4 s
Wall time: 43.8 s
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">LOOKBACK</span><span class="p">:])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3441, 3189)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">cov_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3189, 3189)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># form a dataframe with the cov_list and return_list</span>
<span class="n">df_cov</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'date'</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">LOOKBACK</span><span class="p">:],</span> <span class="s1">'cov_list'</span><span class="p">:</span><span class="n">cov_list</span><span class="p">,</span> <span class="s1">'return_list'</span><span class="p">:</span><span class="n">return_list</span><span class="p">})</span>
<span class="n">df_cov</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-12-31</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-01-02</td>
      <td>[[0.0008961331319844811, 0.0007229547753450831...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009-01-05</td>
      <td>[[0.0008942290687322837, 0.0007206030648001816...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2009-01-06</td>
      <td>[[0.0008951474693283972, 0.0007217056039965993...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2009-01-07</td>
      <td>[[0.0008975149225319093, 0.0007241915142094865...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3184</th>
      <td>2021-08-25</td>
      <td>[[8.139554607177268e-05, 7.076161408798078e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>3185</th>
      <td>2021-08-26</td>
      <td>[[8.15840000747442e-05, 7.098311940863228e-05,...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>3186</th>
      <td>2021-08-27</td>
      <td>[[8.155510926610815e-05, 7.162918231818502e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>3187</th>
      <td>2021-08-30</td>
      <td>[[8.162658991218995e-05, 7.155445795151861e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>3188</th>
      <td>2021-08-31</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
  </tbody>
</table>
<p>3189 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># merge df_cov with the main dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_cov</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'date'</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-12-31</td>
      <td>7.900000</td>
      <td>7.900000</td>
      <td>7.900000</td>
      <td>6.548186</td>
      <td>0</td>
      <td>FBCVX</td>
      <td>2</td>
      <td>-0.003032</td>
      <td>6.625188</td>
      <td>6.032323</td>
      <td>48.240961</td>
      <td>102.573711</td>
      <td>6.437515</td>
      <td>6.187183</td>
      <td>6.453092</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-12-31</td>
      <td>8.690000</td>
      <td>8.690000</td>
      <td>8.690000</td>
      <td>3.697545</td>
      <td>0</td>
      <td>FCPGX</td>
      <td>2</td>
      <td>0.015371</td>
      <td>3.687956</td>
      <td>3.319084</td>
      <td>48.638490</td>
      <td>137.594713</td>
      <td>11.647507</td>
      <td>3.427356</td>
      <td>3.594576</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-12-31</td>
      <td>15.730000</td>
      <td>15.730000</td>
      <td>15.730000</td>
      <td>6.669960</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>2</td>
      <td>0.025542</td>
      <td>6.761376</td>
      <td>6.140492</td>
      <td>48.908868</td>
      <td>110.240063</td>
      <td>8.794697</td>
      <td>6.289111</td>
      <td>6.487707</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-12-31</td>
      <td>15.790000</td>
      <td>15.790000</td>
      <td>15.790000</td>
      <td>6.350790</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>2</td>
      <td>0.025277</td>
      <td>6.407065</td>
      <td>5.710326</td>
      <td>48.573492</td>
      <td>115.808269</td>
      <td>8.665272</td>
      <td>5.894904</td>
      <td>6.192935</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-12-31</td>
      <td>10.530000</td>
      <td>10.530000</td>
      <td>10.530000</td>
      <td>6.006501</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>2</td>
      <td>0.025076</td>
      <td>6.001624</td>
      <td>5.402930</td>
      <td>48.564497</td>
      <td>128.462223</td>
      <td>10.677362</td>
      <td>5.559625</td>
      <td>5.839951</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>22318</th>
      <td>2021-08-31</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>1</td>
      <td>0.485560</td>
      <td>50.233594</td>
      <td>47.837405</td>
      <td>63.290963</td>
      <td>186.262675</td>
      <td>33.935129</td>
      <td>48.798333</td>
      <td>48.066166</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>22319</th>
      <td>2021-08-31</td>
      <td>37.290001</td>
      <td>37.290001</td>
      <td>37.290001</td>
      <td>35.175362</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>1</td>
      <td>0.160866</td>
      <td>35.429981</td>
      <td>34.401928</td>
      <td>56.769455</td>
      <td>108.062182</td>
      <td>14.914749</td>
      <td>34.818795</td>
      <td>34.498705</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>22320</th>
      <td>2021-08-31</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>1</td>
      <td>0.355394</td>
      <td>36.956232</td>
      <td>34.422768</td>
      <td>56.811784</td>
      <td>158.442705</td>
      <td>22.592461</td>
      <td>35.431666</td>
      <td>35.356833</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>22321</th>
      <td>2021-08-31</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>0</td>
      <td>FDSVX</td>
      <td>1</td>
      <td>0.616046</td>
      <td>56.891673</td>
      <td>53.754767</td>
      <td>63.869985</td>
      <td>13.372480</td>
      <td>1.499019</td>
      <td>55.064085</td>
      <td>54.107896</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>22322</th>
      <td>2021-08-31</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>0</td>
      <td>FSMVX</td>
      <td>1</td>
      <td>0.269141</td>
      <td>29.717076</td>
      <td>28.292924</td>
      <td>56.730943</td>
      <td>100.071603</td>
      <td>17.984678</td>
      <td>28.728666</td>
      <td>28.399833</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
  </tbody>
</table>
<p>22323 rows × 18 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'tic'</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-12-31</td>
      <td>7.900000</td>
      <td>7.900000</td>
      <td>7.900000</td>
      <td>6.548186</td>
      <td>0</td>
      <td>FBCVX</td>
      <td>2</td>
      <td>-0.003032</td>
      <td>6.625188</td>
      <td>6.032323</td>
      <td>48.240961</td>
      <td>102.573711</td>
      <td>6.437515</td>
      <td>6.187183</td>
      <td>6.453092</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-12-31</td>
      <td>8.690000</td>
      <td>8.690000</td>
      <td>8.690000</td>
      <td>3.697545</td>
      <td>0</td>
      <td>FCPGX</td>
      <td>2</td>
      <td>0.015371</td>
      <td>3.687956</td>
      <td>3.319084</td>
      <td>48.638490</td>
      <td>137.594713</td>
      <td>11.647507</td>
      <td>3.427356</td>
      <td>3.594576</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-12-31</td>
      <td>15.730000</td>
      <td>15.730000</td>
      <td>15.730000</td>
      <td>6.669960</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>2</td>
      <td>0.025542</td>
      <td>6.761376</td>
      <td>6.140492</td>
      <td>48.908868</td>
      <td>110.240063</td>
      <td>8.794697</td>
      <td>6.289111</td>
      <td>6.487707</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-12-31</td>
      <td>15.790000</td>
      <td>15.790000</td>
      <td>15.790000</td>
      <td>6.350790</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>2</td>
      <td>0.025277</td>
      <td>6.407065</td>
      <td>5.710326</td>
      <td>48.573492</td>
      <td>115.808269</td>
      <td>8.665272</td>
      <td>5.894904</td>
      <td>6.192935</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-12-31</td>
      <td>10.530000</td>
      <td>10.530000</td>
      <td>10.530000</td>
      <td>6.006501</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>2</td>
      <td>0.025076</td>
      <td>6.001624</td>
      <td>5.402930</td>
      <td>48.564497</td>
      <td>128.462223</td>
      <td>10.677362</td>
      <td>5.559625</td>
      <td>5.839951</td>
      <td>[[0.0008916783690050918, 0.0007199340713349982...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>22318</th>
      <td>2021-08-31</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>50.099998</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>1</td>
      <td>0.485560</td>
      <td>50.233594</td>
      <td>47.837405</td>
      <td>63.290963</td>
      <td>186.262675</td>
      <td>33.935129</td>
      <td>48.798333</td>
      <td>48.066166</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>22319</th>
      <td>2021-08-31</td>
      <td>37.290001</td>
      <td>37.290001</td>
      <td>37.290001</td>
      <td>35.175362</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>1</td>
      <td>0.160866</td>
      <td>35.429981</td>
      <td>34.401928</td>
      <td>56.769455</td>
      <td>108.062182</td>
      <td>14.914749</td>
      <td>34.818795</td>
      <td>34.498705</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>22320</th>
      <td>2021-08-31</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>36.700001</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>1</td>
      <td>0.355394</td>
      <td>36.956232</td>
      <td>34.422768</td>
      <td>56.811784</td>
      <td>158.442705</td>
      <td>22.592461</td>
      <td>35.431666</td>
      <td>35.356833</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>22321</th>
      <td>2021-08-31</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>56.790001</td>
      <td>0</td>
      <td>FDSVX</td>
      <td>1</td>
      <td>0.616046</td>
      <td>56.891673</td>
      <td>53.754767</td>
      <td>63.869985</td>
      <td>13.372480</td>
      <td>1.499019</td>
      <td>55.064085</td>
      <td>54.107896</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>22322</th>
      <td>2021-08-31</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>29.379999</td>
      <td>0</td>
      <td>FSMVX</td>
      <td>1</td>
      <td>0.269141</td>
      <td>29.717076</td>
      <td>28.292924</td>
      <td>56.730943</td>
      <td>100.071603</td>
      <td>17.984678</td>
      <td>28.728666</td>
      <td>28.399833</td>
      <td>[[8.137781480231036e-05, 7.150181363650654e-05...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
  </tbody>
</table>
<p>22323 rows × 18 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.3-Modeling">
<a class="anchor" href="#3.3-Modeling" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3 Modeling<a class="anchor-link" href="#3.3-Modeling"> </a>
</h3>
<p>The portfolio within the market will be modeled by the OpenAI Gym framework. This is referred to as the <em>environment</em>. For the <em>agent</em>, we will use the FinRL framework. As the agent interacts with the environment it will gradually learn a trading strategy based on the reward function. The agent is rewarded according to the total value of the portfolio.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.3.1-Training-data">
<a class="anchor" href="#3.3.1-Training-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.1 Training data<a class="anchor-link" href="#3.3.1-Training-data"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TRAIN_START</span><span class="p">,</span> <span class="n">TRADE_START</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>('2009-01-01', '2020-07-01')</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">data_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">TRAIN_START</span><span class="p">,</span> <span class="n">TRADE_START</span><span class="p">)</span>
<span class="n">train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>8.150000</td>
      <td>8.150000</td>
      <td>8.150000</td>
      <td>6.755406</td>
      <td>0</td>
      <td>FBCVX</td>
      <td>4</td>
      <td>0.030432</td>
      <td>6.702175</td>
      <td>6.010826</td>
      <td>49.991970</td>
      <td>152.551464</td>
      <td>13.863211</td>
      <td>6.209512</td>
      <td>6.445367</td>
      <td>[[0.0008961331319844811, 0.0007229547753450831...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>8.870000</td>
      <td>8.870000</td>
      <td>8.870000</td>
      <td>3.774134</td>
      <td>0</td>
      <td>FCPGX</td>
      <td>4</td>
      <td>0.032454</td>
      <td>3.737249</td>
      <td>3.305107</td>
      <td>49.880034</td>
      <td>162.366452</td>
      <td>16.518011</td>
      <td>3.442107</td>
      <td>3.588619</td>
      <td>[[0.0008961331319844811, 0.0007229547753450831...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>16.280001</td>
      <td>16.280001</td>
      <td>16.280001</td>
      <td>6.903177</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>4</td>
      <td>0.058199</td>
      <td>6.834997</td>
      <td>6.136275</td>
      <td>51.154864</td>
      <td>170.139325</td>
      <td>17.925843</td>
      <td>6.316292</td>
      <td>6.487900</td>
      <td>[[0.0008961331319844811, 0.0007229547753450831...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>16.370001</td>
      <td>16.370001</td>
      <td>16.370001</td>
      <td>6.584068</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>4</td>
      <td>0.060919</td>
      <td>6.498272</td>
      <td>5.695824</td>
      <td>50.606719</td>
      <td>165.116529</td>
      <td>16.838559</td>
      <td>5.921930</td>
      <td>6.184977</td>
      <td>[[0.0008961331319844811, 0.0007229547753450831...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>10.740000</td>
      <td>10.740000</td>
      <td>10.740000</td>
      <td>6.126287</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>4</td>
      <td>0.052369</td>
      <td>6.074467</td>
      <td>5.390190</td>
      <td>49.704302</td>
      <td>150.989986</td>
      <td>15.152331</td>
      <td>5.582884</td>
      <td>5.829957</td>
      <td>[[0.0008961331319844811, 0.0007229547753450831...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>2020-06-30</td>
      <td>35.930000</td>
      <td>35.930000</td>
      <td>35.930000</td>
      <td>33.073399</td>
      <td>0</td>
      <td>FDCAX</td>
      <td>1</td>
      <td>0.501019</td>
      <td>33.705111</td>
      <td>31.615998</td>
      <td>57.598799</td>
      <td>82.309417</td>
      <td>17.475881</td>
      <td>32.193710</td>
      <td>30.489567</td>
      <td>[[0.000538045795431353, 0.0004554362595919771,...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>2020-06-30</td>
      <td>25.700001</td>
      <td>25.700001</td>
      <td>25.700001</td>
      <td>23.743460</td>
      <td>0</td>
      <td>FDGFX</td>
      <td>1</td>
      <td>0.034722</td>
      <td>26.677363</td>
      <td>22.296985</td>
      <td>50.881596</td>
      <td>-25.411227</td>
      <td>0.081819</td>
      <td>24.063118</td>
      <td>22.812814</td>
      <td>[[0.000538045795431353, 0.0004554362595919771,...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>2020-06-30</td>
      <td>22.870001</td>
      <td>22.870001</td>
      <td>22.870001</td>
      <td>22.532381</td>
      <td>0</td>
      <td>FDSCX</td>
      <td>1</td>
      <td>0.174035</td>
      <td>23.630273</td>
      <td>21.395077</td>
      <td>53.642964</td>
      <td>31.031452</td>
      <td>8.899931</td>
      <td>22.311030</td>
      <td>21.079976</td>
      <td>[[0.000538045795431353, 0.0004554362595919771,...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>2020-06-30</td>
      <td>45.220001</td>
      <td>45.220001</td>
      <td>45.220001</td>
      <td>37.346981</td>
      <td>0</td>
      <td>FDSVX</td>
      <td>1</td>
      <td>0.708226</td>
      <td>37.957114</td>
      <td>35.252713</td>
      <td>59.415280</td>
      <td>99.055416</td>
      <td>21.233245</td>
      <td>36.033532</td>
      <td>33.922269</td>
      <td>[[0.000538045795431353, 0.0004554362595919771,...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>2020-06-30</td>
      <td>18.670000</td>
      <td>18.670000</td>
      <td>18.670000</td>
      <td>18.302086</td>
      <td>0</td>
      <td>FSMVX</td>
      <td>1</td>
      <td>0.013502</td>
      <td>20.369239</td>
      <td>17.161312</td>
      <td>51.025374</td>
      <td>-19.628866</td>
      <td>1.400737</td>
      <td>18.481807</td>
      <td>17.546607</td>
      <td>[[0.000538045795431353, 0.0004554362595919771,...</td>
      <td>tic            FBCVX     FCPGX     FDCAX  ... ...</td>
    </tr>
  </tbody>
</table>
<p>20251 rows × 18 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.3.2-Portfolio-(Environment)">
<a class="anchor" href="#3.3.2-Portfolio-(Environment)" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.2 Portfolio (Environment)<a class="anchor-link" href="#3.3.2-Portfolio-(Environment)"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Portfolio</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">):</span>
    <span class="sd">"""A portfolio/market environment</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">        df: DataFrame</span>
<span class="sd">            input data</span>
<span class="sd">        stock_dim : int</span>
<span class="sd">            number of unique stocks</span>
<span class="sd">        hmax : int</span>
<span class="sd">            maximum number of shares to trade</span>
<span class="sd">        initial_amount : int</span>
<span class="sd">            start money</span>
<span class="sd">        transaction_cost_pct: float</span>
<span class="sd">            transaction cost percentage per trade</span>
<span class="sd">        reward_scaling: float</span>
<span class="sd">            scaling factor for reward, good for training</span>
<span class="sd">        state_space: int</span>
<span class="sd">            the dimension of input features</span>
<span class="sd">        action_space: int</span>
<span class="sd">            equals stock dimension</span>
<span class="sd">        tech_indicator_list: list</span>
<span class="sd">            a list of technical indicator names</span>
<span class="sd">        turbulence_threshold: int</span>
<span class="sd">            a threshold to control risk aversion</span>
<span class="sd">        day: int</span>
<span class="sd">            an increment number to control date</span>
<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    _sell_stock()</span>
<span class="sd">        perform sell action based on the sign of the action</span>
<span class="sd">    _buy_stock()</span>
<span class="sd">        perform buy action based on the sign of the action</span>
<span class="sd">    step()</span>
<span class="sd">        at each step the agent will return actions, then </span>
<span class="sd">        we will calculate the reward, and return the next observation.</span>
<span class="sd">    reset()</span>
<span class="sd">        reset the environment</span>
<span class="sd">    render()</span>
<span class="sd">        use render to return other functions</span>
<span class="sd">    save_asset_memory()</span>
<span class="sd">        return account value at each time step</span>
<span class="sd">    save_action_memory()</span>
<span class="sd">        return actions/positions at each time step</span>
<span class="sd">    """</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'render.modes'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'human'</span><span class="p">]}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                <span class="n">df</span><span class="p">,</span>
                <span class="n">stock_dim</span><span class="p">,</span>
                <span class="n">hmax</span><span class="p">,</span>
                <span class="n">initial_amount</span><span class="p">,</span>
                <span class="n">transaction_cost_pct</span><span class="p">,</span>
                <span class="n">reward_scaling</span><span class="p">,</span>
                <span class="n">state_space</span><span class="p">,</span>
                <span class="n">action_space</span><span class="p">,</span>
                <span class="n">tech_indicator_list</span><span class="p">,</span>
                <span class="n">turbulence_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">lookback</span><span class="o">=</span><span class="n">LOOKBACK</span><span class="p">,</span>
                <span class="n">day</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="c1">#super(StockEnv, self).__init__()</span>
        <span class="c1">#money = 10 , scope = 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lookback</span> <span class="o">=</span> <span class="n">lookback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span> <span class="o">=</span> <span class="n">stock_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hmax</span> <span class="o">=</span> <span class="n">hmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span> <span class="o">=</span> <span class="n">initial_amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transaction_cost_pct</span> <span class="o">=</span> <span class="n">transaction_cost_pct</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reward_scaling</span> <span class="o">=</span> <span class="n">reward_scaling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_space</span> <span class="o">=</span> <span class="n">state_space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">action_space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="o">=</span> <span class="n">tech_indicator_list</span>

        <span class="c1"># action_space normalization and shape is self.stock_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action_space</span><span class="p">,))</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state_space</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_space</span><span class="p">))</span>

        <span class="c1"># load data from a pandas dataframe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'cov_list'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covs</span><span class="p">),</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">tech</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">tech</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turbulence_threshold</span> <span class="o">=</span> <span class="n">turbulence_threshold</span>
        <span class="c1"># initalize state: inital portfolio return + individual stock return + individual weights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span>

        <span class="c1"># memorize portfolio value each step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span><span class="p">]</span>
        <span class="c1"># memorize portfolio return each step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">daily_return</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(),</span> <span class="s1">'r'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'results/cumulative_reward.png'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'results/rewards.png'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">"================================="</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"begin_total_asset:</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>           
            <span class="nb">print</span><span class="p">(</span><span class="s2">"end_total_asset:</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span><span class="p">))</span>

            <span class="n">df_daily_return</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="p">)</span>
            <span class="n">df_daily_return</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">df_daily_return</span><span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
              <span class="n">sharpe</span> <span class="o">=</span> <span class="p">(</span><span class="mi">252</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">df_daily_return</span><span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span> \
                       <span class="n">df_daily_return</span><span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
              <span class="nb">print</span><span class="p">(</span><span class="s2">"Sharpe: "</span><span class="p">,</span><span class="n">sharpe</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"================================="</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reward</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="p">,</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">softmax_normalization</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
            <span class="n">last_day_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

            <span class="c1">#load next state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">covs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'cov_list'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covs</span><span class="p">),</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">tech</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">tech</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">portfolio_return</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">last_day_memory</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">weights</span><span class="p">)</span>
            <span class="n">log_portfolio_return</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">last_day_memory</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">*</span><span class="n">weights</span><span class="p">))</span>
            <span class="c1"># update portfolio value</span>
            <span class="n">new_portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">portfolio_return</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span> <span class="o">=</span> <span class="n">new_portfolio_value</span>

            <span class="c1"># save into memory</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">portfolio_return</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>            
            <span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_portfolio_value</span><span class="p">)</span>

            <span class="c1"># the reward is the new portfolio value or end portfolo value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reward</span> <span class="o">=</span> <span class="n">new_portfolio_value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reward</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="p">,</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,:]</span>
        <span class="c1"># load states</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'cov_list'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covs</span><span class="p">),</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">tech</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">tech</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span>
        <span class="c1">#self.cost = 0</span>
        <span class="c1">#self.trades = 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">False</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
    
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'human'</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
        
    <span class="k">def</span> <span class="nf">softmax_normalization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">actions</span><span class="p">))</span>
        <span class="n">softmax_output</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span>
        <span class="k">return</span> <span class="n">softmax_output</span>

    <span class="k">def</span> <span class="nf">save_asset_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">date_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span>
        <span class="n">portfolio_return</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span>
        <span class="c1">#print(len(date_list))</span>
        <span class="c1">#print(len(asset_list))</span>
        <span class="n">df_account_value</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'date'</span><span class="p">:</span><span class="n">date_list</span><span class="p">,</span><span class="s1">'daily_return'</span><span class="p">:</span><span class="n">portfolio_return</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">df_account_value</span>

    <span class="k">def</span> <span class="nf">save_action_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># date and close price length must match actions length</span>
        <span class="n">date_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span>
        <span class="n">df_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">date_list</span><span class="p">)</span>
        <span class="n">df_date</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'date'</span><span class="p">]</span>
        
        <span class="n">action_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span>
        <span class="n">df_actions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">action_list</span><span class="p">)</span>
        <span class="n">df_actions</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="o">.</span><span class="n">values</span>
        <span class="n">df_actions</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df_date</span><span class="o">.</span><span class="n">date</span>
        <span class="c1">#df_actions = pd.DataFrame({'date':date_list,'actions':action_list})</span>
        <span class="k">return</span> <span class="n">df_actions</span>

    <span class="k">def</span> <span class="nf">_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">np_random</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">seeding</span><span class="o">.</span><span class="n">np_random</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">seed</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_sb_env</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">DummyVecEnv</span><span class="p">([</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="p">])</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">obs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"hmax"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> 
    <span class="s2">"initial_amount"</span><span class="p">:</span> <span class="n">INITIAL_AMOUNT</span><span class="p">,</span> 
    <span class="s2">"transaction_cost_pct"</span><span class="p">:</span> <span class="n">TRANSACTION_COST_PCT</span><span class="p">,</span> 
    <span class="s2">"state_space"</span><span class="p">:</span> <span class="n">state_space</span><span class="p">,</span> 
    <span class="s2">"stock_dim"</span><span class="p">:</span> <span class="n">stock_dimension</span><span class="p">,</span> 
    <span class="s2">"tech_indicator_list"</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">TECHNICAL_INDICATORS_LIST</span><span class="p">,</span> 
    <span class="s2">"action_space"</span><span class="p">:</span> <span class="n">stock_dimension</span><span class="p">,</span> 
    <span class="s2">"reward_scaling"</span><span class="p">:</span> <span class="n">REWARD_SCALING</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">e_train_gym</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">train</span><span class="p">,</span> <span class="o">**</span><span class="n">env_kwargs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env_train</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">e_train_gym</span><span class="o">.</span><span class="n">get_sb_env</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">env_train</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class 'stable_baselines3.common.vec_env.dummy_vec_env.DummyVecEnv'&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.3.3-Portfolio-Manager-(Agent)">
<a class="anchor" href="#3.3.3-Portfolio-Manager-(Agent)" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.3 Portfolio Manager (Agent)<a class="anchor-link" href="#3.3.3-Portfolio-Manager-(Agent)"> </a>
</h4>
<ul>
<li>
<p>We investigate the performance of two models for the <em>agent</em>:</p>
<ul>
<li>A2C</li>
<li>PPO</li>
</ul>
</li>
</ul>
<p>Both models are based on algorithm implementations in the <em>OpenAI Baselines</em> and <em>Stable Baselines</em> libraries.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="3.3.3.1-A2C">
<a class="anchor" href="#3.3.3.1-A2C" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.3.1 A2C<a class="anchor-link" href="#3.3.3.1-A2C"> </a>
</h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env_train</span><span class="p">)</span>
<span class="n">A2C_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"n_steps"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> 
  <span class="s2">"ent_coef"</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span> 
  <span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">0.0004</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">model_a2c</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s2">"a2c"</span><span class="p">,</span> <span class="n">model_kwargs</span><span class="o">=</span><span class="n">A2C_PARAMS</span><span class="p">)</span>
<span class="n">model_a2c</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{'n_steps': 10, 'ent_coef': 0.005, 'learning_rate': 0.0004}
Using cuda device
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;stable_baselines3.a2c.a2c.A2C at 0x7fc9fc325d10&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">trained_a2c</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_a2c</span><span class="p">,</span> <span class="n">tb_log_name</span><span class="o">=</span><span class="s1">'a2c'</span><span class="p">,</span> <span class="n">total_timesteps</span><span class="o">=</span><span class="mi">50_000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Logging to tensorboard_log/a2c/a2c_1
-------------------------------------
| time/                 |           |
|    fps                | 84        |
|    iterations         | 100       |
|    time_elapsed       | 11        |
|    total_timesteps    | 1000      |
| train/                |           |
|    entropy_loss       | -9.88     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 99        |
|    policy_loss        | 9.6e+07   |
|    reward             | 1770969.9 |
|    std                | 0.993     |
|    value_loss         | 1.09e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 126       |
|    iterations         | 200       |
|    time_elapsed       | 15        |
|    total_timesteps    | 2000      |
| train/                |           |
|    entropy_loss       | -9.87     |
|    explained_variance | -2.38e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 199       |
|    policy_loss        | 1.51e+08  |
|    reward             | 2978305.2 |
|    std                | 0.992     |
|    value_loss         | 3.02e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4110079.559657067
Sharpe:  0.6979807594386715
=================================
-------------------------------------
| time/                 |           |
|    fps                | 148       |
|    iterations         | 300       |
|    time_elapsed       | 20        |
|    total_timesteps    | 3000      |
| train/                |           |
|    entropy_loss       | -9.88     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 299       |
|    policy_loss        | 5.4e+07   |
|    reward             | 1094988.2 |
|    std                | 0.992     |
|    value_loss         | 3.82e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 164       |
|    iterations         | 400       |
|    time_elapsed       | 24        |
|    total_timesteps    | 4000      |
| train/                |           |
|    entropy_loss       | -9.89     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 399       |
|    policy_loss        | 1.04e+08  |
|    reward             | 2092528.2 |
|    std                | 0.993     |
|    value_loss         | 1.53e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 175       |
|    iterations         | 500       |
|    time_elapsed       | 28        |
|    total_timesteps    | 5000      |
| train/                |           |
|    entropy_loss       | -9.88     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 499       |
|    policy_loss        | 1.49e+08  |
|    reward             | 3133837.2 |
|    std                | 0.992     |
|    value_loss         | 3.65e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:3976451.6208797866
Sharpe:  0.6857333704791829
=================================
-------------------------------------
| time/                 |           |
|    fps                | 182       |
|    iterations         | 600       |
|    time_elapsed       | 32        |
|    total_timesteps    | 6000      |
| train/                |           |
|    entropy_loss       | -9.86     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 599       |
|    policy_loss        | 6.88e+07  |
|    reward             | 1255545.6 |
|    std                | 0.99      |
|    value_loss         | 6.26e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 190       |
|    iterations         | 700       |
|    time_elapsed       | 36        |
|    total_timesteps    | 7000      |
| train/                |           |
|    entropy_loss       | -9.85     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 699       |
|    policy_loss        | 1.3e+08   |
|    reward             | 2371918.2 |
|    std                | 0.989     |
|    value_loss         | 1.86e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 196       |
|    iterations         | 800       |
|    time_elapsed       | 40        |
|    total_timesteps    | 8000      |
| train/                |           |
|    entropy_loss       | -9.86     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 799       |
|    policy_loss        | 1.8e+08   |
|    reward             | 3547805.2 |
|    std                | 0.989     |
|    value_loss         | 4.39e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4161686.6336636837
Sharpe:  0.7041053033538833
=================================
-------------------------------------
| time/                 |           |
|    fps                | 199       |
|    iterations         | 900       |
|    time_elapsed       | 45        |
|    total_timesteps    | 9000      |
| train/                |           |
|    entropy_loss       | -9.84     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 899       |
|    policy_loss        | 7.17e+07  |
|    reward             | 1521407.1 |
|    std                | 0.987     |
|    value_loss         | 7.52e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 203       |
|    iterations         | 1000      |
|    time_elapsed       | 49        |
|    total_timesteps    | 10000     |
| train/                |           |
|    entropy_loss       | -9.83     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 999       |
|    policy_loss        | 1.41e+08  |
|    reward             | 2594842.5 |
|    std                | 0.986     |
|    value_loss         | 2.43e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 206       |
|    iterations         | 1100      |
|    time_elapsed       | 53        |
|    total_timesteps    | 11000     |
| train/                |           |
|    entropy_loss       | -9.82     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1099      |
|    policy_loss        | 2.02e+08  |
|    reward             | 3621684.2 |
|    std                | 0.985     |
|    value_loss         | 5.13e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4182719.841788154
Sharpe:  0.7065226810322777
=================================
-------------------------------------
| time/                 |           |
|    fps                | 208       |
|    iterations         | 1200      |
|    time_elapsed       | 57        |
|    total_timesteps    | 12000     |
| train/                |           |
|    entropy_loss       | -9.8      |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 1199      |
|    policy_loss        | 6.41e+07  |
|    reward             | 1435004.8 |
|    std                | 0.982     |
|    value_loss         | 6.42e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 211       |
|    iterations         | 1300      |
|    time_elapsed       | 61        |
|    total_timesteps    | 13000     |
| train/                |           |
|    entropy_loss       | -9.79     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 1299      |
|    policy_loss        | 1.38e+08  |
|    reward             | 2707523.2 |
|    std                | 0.98      |
|    value_loss         | 2.51e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 213       |
|    iterations         | 1400      |
|    time_elapsed       | 65        |
|    total_timesteps    | 14000     |
| train/                |           |
|    entropy_loss       | -9.78     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1399      |
|    policy_loss        | 2.29e+08  |
|    reward             | 4180936.8 |
|    std                | 0.979     |
|    value_loss         | 6.08e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4271331.5898148315
Sharpe:  0.7141078133246254
=================================
-------------------------------------
| time/                 |           |
|    fps                | 214       |
|    iterations         | 1500      |
|    time_elapsed       | 69        |
|    total_timesteps    | 15000     |
| train/                |           |
|    entropy_loss       | -9.78     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 1499      |
|    policy_loss        | 8.03e+07  |
|    reward             | 1770714.2 |
|    std                | 0.978     |
|    value_loss         | 1.03e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 216       |
|    iterations         | 1600      |
|    time_elapsed       | 73        |
|    total_timesteps    | 16000     |
| train/                |           |
|    entropy_loss       | -9.78     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1599      |
|    policy_loss        | 1.33e+08  |
|    reward             | 2799781.5 |
|    std                | 0.979     |
|    value_loss         | 2.76e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 218       |
|    iterations         | 1700      |
|    time_elapsed       | 77        |
|    total_timesteps    | 17000     |
| train/                |           |
|    entropy_loss       | -9.77     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 1699      |
|    policy_loss        | 2.09e+08  |
|    reward             | 3782954.2 |
|    std                | 0.977     |
|    value_loss         | 4.7e+14   |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4133498.8876433456
Sharpe:  0.7009423253577455
=================================
-------------------------------------
| time/                 |           |
|    fps                | 218       |
|    iterations         | 1800      |
|    time_elapsed       | 82        |
|    total_timesteps    | 18000     |
| train/                |           |
|    entropy_loss       | -9.75     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1799      |
|    policy_loss        | 8.77e+07  |
|    reward             | 1747342.0 |
|    std                | 0.974     |
|    value_loss         | 1.08e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 220       |
|    iterations         | 1900      |
|    time_elapsed       | 86        |
|    total_timesteps    | 19000     |
| train/                |           |
|    entropy_loss       | -9.73     |
|    explained_variance | 1.79e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 1899      |
|    policy_loss        | 1.55e+08  |
|    reward             | 2885395.5 |
|    std                | 0.972     |
|    value_loss         | 2.98e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 221       |
|    iterations         | 2000      |
|    time_elapsed       | 90        |
|    total_timesteps    | 20000     |
| train/                |           |
|    entropy_loss       | -9.72     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 1999      |
|    policy_loss        | 2.15e+08  |
|    reward             | 3976518.0 |
|    std                | 0.971     |
|    value_loss         | 5.31e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4046834.5908127716
Sharpe:  0.6919991450241213
=================================
-------------------------------------
| time/                 |           |
|    fps                | 221       |
|    iterations         | 2100      |
|    time_elapsed       | 94        |
|    total_timesteps    | 21000     |
| train/                |           |
|    entropy_loss       | -9.71     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 2099      |
|    policy_loss        | 8.41e+07  |
|    reward             | 1543899.6 |
|    std                | 0.968     |
|    value_loss         | 8.56e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 222       |
|    iterations         | 2200      |
|    time_elapsed       | 98        |
|    total_timesteps    | 22000     |
| train/                |           |
|    entropy_loss       | -9.71     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 2199      |
|    policy_loss        | 1.46e+08  |
|    reward             | 2804042.8 |
|    std                | 0.968     |
|    value_loss         | 3.04e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 223       |
|    iterations         | 2300      |
|    time_elapsed       | 102       |
|    total_timesteps    | 23000     |
| train/                |           |
|    entropy_loss       | -9.7      |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 2299      |
|    policy_loss        | 1.99e+08  |
|    reward             | 4275337.5 |
|    std                | 0.967     |
|    value_loss         | 6.46e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4052447.3183236937
Sharpe:  0.6928298846678986
=================================
-------------------------------------
| time/                 |           |
|    fps                | 223       |
|    iterations         | 2400      |
|    time_elapsed       | 107       |
|    total_timesteps    | 24000     |
| train/                |           |
|    entropy_loss       | -9.68     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 2399      |
|    policy_loss        | 8.6e+07   |
|    reward             | 1638133.4 |
|    std                | 0.965     |
|    value_loss         | 1.05e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 224       |
|    iterations         | 2500      |
|    time_elapsed       | 111       |
|    total_timesteps    | 25000     |
| train/                |           |
|    entropy_loss       | -9.68     |
|    explained_variance | -2.38e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 2499      |
|    policy_loss        | 1.35e+08  |
|    reward             | 2705907.2 |
|    std                | 0.965     |
|    value_loss         | 2.72e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 225       |
|    iterations         | 2600      |
|    time_elapsed       | 115       |
|    total_timesteps    | 26000     |
| train/                |           |
|    entropy_loss       | -9.67     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 2599      |
|    policy_loss        | 1.97e+08  |
|    reward             | 3837006.5 |
|    std                | 0.964     |
|    value_loss         | 4.66e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4123691.04929031
Sharpe:  0.700619600708785
=================================
-------------------------------------
| time/                 |           |
|    fps                | 225       |
|    iterations         | 2700      |
|    time_elapsed       | 119       |
|    total_timesteps    | 27000     |
| train/                |           |
|    entropy_loss       | -9.68     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 2699      |
|    policy_loss        | 8.79e+07  |
|    reward             | 1748944.0 |
|    std                | 0.965     |
|    value_loss         | 1.14e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 226       |
|    iterations         | 2800      |
|    time_elapsed       | 123       |
|    total_timesteps    | 28000     |
| train/                |           |
|    entropy_loss       | -9.67     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 2799      |
|    policy_loss        | 1.77e+08  |
|    reward             | 2919523.0 |
|    std                | 0.964     |
|    value_loss         | 3.12e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4164192.583783833
Sharpe:  0.7051087865111408
=================================
-------------------------------------
| time/                 |           |
|    fps                | 226       |
|    iterations         | 2900      |
|    time_elapsed       | 127       |
|    total_timesteps    | 29000     |
| train/                |           |
|    entropy_loss       | -9.65     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 2899      |
|    policy_loss        | 4.63e+07  |
|    reward             | 951793.56 |
|    std                | 0.961     |
|    value_loss         | 2.8e+13   |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 227       |
|    iterations         | 3000      |
|    time_elapsed       | 132       |
|    total_timesteps    | 30000     |
| train/                |           |
|    entropy_loss       | -9.65     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 2999      |
|    policy_loss        | 9.13e+07  |
|    reward             | 1990526.0 |
|    std                | 0.96      |
|    value_loss         | 1.45e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 227       |
|    iterations         | 3100      |
|    time_elapsed       | 136       |
|    total_timesteps    | 31000     |
| train/                |           |
|    entropy_loss       | -9.63     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 3099      |
|    policy_loss        | 1.58e+08  |
|    reward             | 3170679.8 |
|    std                | 0.958     |
|    value_loss         | 3.69e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4067124.4699334074
Sharpe:  0.6948431965746262
=================================
-------------------------------------
| time/                 |           |
|    fps                | 227       |
|    iterations         | 3200      |
|    time_elapsed       | 140       |
|    total_timesteps    | 32000     |
| train/                |           |
|    entropy_loss       | -9.64     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 3199      |
|    policy_loss        | 6.1e+07   |
|    reward             | 1306404.8 |
|    std                | 0.959     |
|    value_loss         | 5.29e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 228       |
|    iterations         | 3300      |
|    time_elapsed       | 144       |
|    total_timesteps    | 33000     |
| train/                |           |
|    entropy_loss       | -9.63     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 3299      |
|    policy_loss        | 9.71e+07  |
|    reward             | 2191711.2 |
|    std                | 0.958     |
|    value_loss         | 1.7e+14   |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 228       |
|    iterations         | 3400      |
|    time_elapsed       | 148       |
|    total_timesteps    | 34000     |
| train/                |           |
|    entropy_loss       | -9.63     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 3399      |
|    policy_loss        | 1.56e+08  |
|    reward             | 3346152.2 |
|    std                | 0.958     |
|    value_loss         | 4.1e+14   |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4034374.463013146
Sharpe:  0.6906021236478135
=================================
-------------------------------------
| time/                 |           |
|    fps                | 228       |
|    iterations         | 3500      |
|    time_elapsed       | 153       |
|    total_timesteps    | 35000     |
| train/                |           |
|    entropy_loss       | -9.62     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 3499      |
|    policy_loss        | 6.01e+07  |
|    reward             | 1337613.8 |
|    std                | 0.957     |
|    value_loss         | 6.05e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 229       |
|    iterations         | 3600      |
|    time_elapsed       | 157       |
|    total_timesteps    | 36000     |
| train/                |           |
|    entropy_loss       | -9.64     |
|    explained_variance | 1.79e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 3599      |
|    policy_loss        | 1.4e+08   |
|    reward             | 2489865.5 |
|    std                | 0.96      |
|    value_loss         | 2.28e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 229       |
|    iterations         | 3700      |
|    time_elapsed       | 161       |
|    total_timesteps    | 37000     |
| train/                |           |
|    entropy_loss       | -9.64     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 3699      |
|    policy_loss        | 1.88e+08  |
|    reward             | 4019591.0 |
|    std                | 0.96      |
|    value_loss         | 5.58e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4119809.4408771424
Sharpe:  0.7003255647826773
=================================
-------------------------------------
| time/                 |           |
|    fps                | 229       |
|    iterations         | 3800      |
|    time_elapsed       | 165       |
|    total_timesteps    | 38000     |
| train/                |           |
|    entropy_loss       | -9.65     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 3799      |
|    policy_loss        | 6.5e+07   |
|    reward             | 1363994.8 |
|    std                | 0.96      |
|    value_loss         | 6.05e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 229       |
|    iterations         | 3900      |
|    time_elapsed       | 169       |
|    total_timesteps    | 39000     |
| train/                |           |
|    entropy_loss       | -9.64     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 3899      |
|    policy_loss        | 1.15e+08  |
|    reward             | 2599753.0 |
|    std                | 0.959     |
|    value_loss         | 2.45e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 230       |
|    iterations         | 4000      |
|    time_elapsed       | 173       |
|    total_timesteps    | 40000     |
| train/                |           |
|    entropy_loss       | -9.62     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 3999      |
|    policy_loss        | 2.09e+08  |
|    reward             | 3773874.0 |
|    std                | 0.957     |
|    value_loss         | 5.35e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4030151.780621599
Sharpe:  0.691531028386293
=================================
-------------------------------------
| time/                 |           |
|    fps                | 230       |
|    iterations         | 4100      |
|    time_elapsed       | 178       |
|    total_timesteps    | 41000     |
| train/                |           |
|    entropy_loss       | -9.62     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 4099      |
|    policy_loss        | 9.04e+07  |
|    reward             | 1612590.9 |
|    std                | 0.957     |
|    value_loss         | 8.73e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 230       |
|    iterations         | 4200      |
|    time_elapsed       | 182       |
|    total_timesteps    | 42000     |
| train/                |           |
|    entropy_loss       | -9.62     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 4199      |
|    policy_loss        | 1.48e+08  |
|    reward             | 2647467.8 |
|    std                | 0.958     |
|    value_loss         | 2.66e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 230       |
|    iterations         | 4300      |
|    time_elapsed       | 186       |
|    total_timesteps    | 43000     |
| train/                |           |
|    entropy_loss       | -9.62     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 4299      |
|    policy_loss        | 1.79e+08  |
|    reward             | 3713941.2 |
|    std                | 0.957     |
|    value_loss         | 5.12e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4077198.0467443867
Sharpe:  0.695992993463236
=================================
-------------------------------------
| time/                 |           |
|    fps                | 230       |
|    iterations         | 4400      |
|    time_elapsed       | 190       |
|    total_timesteps    | 44000     |
| train/                |           |
|    entropy_loss       | -9.62     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 4399      |
|    policy_loss        | 8.99e+07  |
|    reward             | 1753287.2 |
|    std                | 0.957     |
|    value_loss         | 1.12e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 231       |
|    iterations         | 4500      |
|    time_elapsed       | 194       |
|    total_timesteps    | 45000     |
| train/                |           |
|    entropy_loss       | -9.62     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 4499      |
|    policy_loss        | 1.6e+08   |
|    reward             | 3013050.0 |
|    std                | 0.957     |
|    value_loss         | 3.14e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 231       |
|    iterations         | 4600      |
|    time_elapsed       | 198       |
|    total_timesteps    | 46000     |
| train/                |           |
|    entropy_loss       | -9.63     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 4599      |
|    policy_loss        | 1.91e+08  |
|    reward             | 4056158.0 |
|    std                | 0.958     |
|    value_loss         | 6.01e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4110861.0279944185
Sharpe:  0.6995703979641089
=================================
-------------------------------------
| time/                 |           |
|    fps                | 231       |
|    iterations         | 4700      |
|    time_elapsed       | 203       |
|    total_timesteps    | 47000     |
| train/                |           |
|    entropy_loss       | -9.63     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 4699      |
|    policy_loss        | 6.95e+07  |
|    reward             | 1597928.8 |
|    std                | 0.958     |
|    value_loss         | 7.49e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 231       |
|    iterations         | 4800      |
|    time_elapsed       | 207       |
|    total_timesteps    | 48000     |
| train/                |           |
|    entropy_loss       | -9.63     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 4799      |
|    policy_loss        | 1.2e+08   |
|    reward             | 2745886.8 |
|    std                | 0.958     |
|    value_loss         | 2.58e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 4900      |
|    time_elapsed       | 211       |
|    total_timesteps    | 49000     |
| train/                |           |
|    entropy_loss       | -9.62     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 4899      |
|    policy_loss        | 1.83e+08  |
|    reward             | 4007404.8 |
|    std                | 0.957     |
|    value_loss         | 5.87e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4086023.462167963
Sharpe:  0.6967232525311317
=================================
-------------------------------------
| time/                 |           |
|    fps                | 231       |
|    iterations         | 5000      |
|    time_elapsed       | 215       |
|    total_timesteps    | 50000     |
| train/                |           |
|    entropy_loss       | -9.63     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 4999      |
|    policy_loss        | 9.05e+07  |
|    reward             | 1792232.6 |
|    std                | 0.958     |
|    value_loss         | 1.13e+14  |
-------------------------------------
CPU times: user 3min 29s, sys: 2.08 s, total: 3min 31s
Wall time: 3min 35s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="3.3.3.2-PPO">
<a class="anchor" href="#3.3.3.2-PPO" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.3.2 PPO<a class="anchor-link" href="#3.3.3.2-PPO"> </a>
</h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="p">(</span><span class="n">env</span> <span class="o">=</span> <span class="n">env_train</span><span class="p">)</span>
<span class="n">PPO_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"n_steps"</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
  <span class="s2">"ent_coef"</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span>
  <span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
  <span class="s2">"batch_size"</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">model_ppo</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="s2">"ppo"</span><span class="p">,</span><span class="n">model_kwargs</span> <span class="o">=</span> <span class="n">PPO_PARAMS</span><span class="p">)</span>
<span class="n">model_ppo</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{'n_steps': 2048, 'ent_coef': 0.005, 'learning_rate': 0.001, 'batch_size': 128}
Using cuda device
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;stable_baselines3.ppo.ppo.PPO at 0x7fc981276f10&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># train PPO agent</span>
<span class="n">trained_ppo</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_ppo</span><span class="p">,</span> <span class="n">tb_log_name</span><span class="o">=</span><span class="s1">'ppo'</span><span class="p">,</span> <span class="n">total_timesteps</span><span class="o">=</span><span class="mi">50_000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Logging to tensorboard_log/ppo/ppo_1
----------------------------------
| time/              |           |
|    fps             | 307       |
|    iterations      | 1         |
|    time_elapsed    | 6         |
|    total_timesteps | 2048      |
| train/             |           |
|    reward          | 3199747.8 |
----------------------------------
=================================
begin_total_asset:1000000
end_total_asset:3913564.3893383564
Sharpe:  0.6788581038411543
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 275          |
|    iterations           | 2            |
|    time_elapsed         | 14           |
|    total_timesteps      | 4096         |
| train/                  |              |
|    approx_kl            | 8.119969e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 5.96e-08     |
|    learning_rate        | 0.001        |
|    loss                 | 6.38e+14     |
|    n_updates            | 10           |
|    policy_gradient_loss | -1.26e-06    |
|    reward               | 2267978.8    |
|    std                  | 1            |
|    value_loss           | 1.28e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:3994425.904324733
Sharpe:  0.6872894807654567
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 267          |
|    iterations           | 3            |
|    time_elapsed         | 22           |
|    total_timesteps      | 6144         |
| train/                  |              |
|    approx_kl            | 8.032657e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 9.55e+14     |
|    n_updates            | 20           |
|    policy_gradient_loss | -1.22e-06    |
|    reward               | 1323024.1    |
|    std                  | 1            |
|    value_loss           | 1.95e+15     |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 266          |
|    iterations           | 4            |
|    time_elapsed         | 30           |
|    total_timesteps      | 8192         |
| train/                  |              |
|    approx_kl            | 8.294592e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | -1.19e-07    |
|    learning_rate        | 0.001        |
|    loss                 | 1.13e+15     |
|    n_updates            | 30           |
|    policy_gradient_loss | -1.11e-06    |
|    reward               | 4083331.2    |
|    std                  | 1            |
|    value_loss           | 2.51e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4150878.4127395344
Sharpe:  0.7027972589326308
=================================
----------------------------------------
| time/                   |            |
|    fps                  | 262        |
|    iterations           | 5          |
|    time_elapsed         | 39         |
|    total_timesteps      | 10240      |
| train/                  |            |
|    approx_kl            | 7.5961e-09 |
|    clip_fraction        | 0          |
|    clip_range           | 0.2        |
|    entropy_loss         | -9.93      |
|    explained_variance   | 2.38e-07   |
|    learning_rate        | 0.001      |
|    loss                 | 9.87e+14   |
|    n_updates            | 40         |
|    policy_gradient_loss | -9.28e-07  |
|    reward               | 2970283.2  |
|    std                  | 1          |
|    value_loss           | 1.95e+15   |
----------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:3998877.2903906824
Sharpe:  0.6871327226982832
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 261          |
|    iterations           | 6            |
|    time_elapsed         | 46           |
|    total_timesteps      | 12288        |
| train/                  |              |
|    approx_kl            | 7.508788e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 8.7e+14      |
|    n_updates            | 50           |
|    policy_gradient_loss | -9.23e-07    |
|    reward               | 1590401.4    |
|    std                  | 1            |
|    value_loss           | 1.84e+15     |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 261          |
|    iterations           | 7            |
|    time_elapsed         | 54           |
|    total_timesteps      | 14336        |
| train/                  |              |
|    approx_kl            | 8.556526e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.26e+15     |
|    n_updates            | 60           |
|    policy_gradient_loss | -1.26e-06    |
|    reward               | 4469934.5    |
|    std                  | 1            |
|    value_loss           | 2.36e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4096060.7173107606
Sharpe:  0.6982076816270193
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 259          |
|    iterations           | 8            |
|    time_elapsed         | 63           |
|    total_timesteps      | 16384        |
| train/                  |              |
|    approx_kl            | 6.315531e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | -1.19e-07    |
|    learning_rate        | 0.001        |
|    loss                 | 1.29e+15     |
|    n_updates            | 70           |
|    policy_gradient_loss | -9.07e-07    |
|    reward               | 2862059.0    |
|    std                  | 1            |
|    value_loss           | 2.49e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4058297.672070343
Sharpe:  0.694059504812043
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 258          |
|    iterations           | 9            |
|    time_elapsed         | 71           |
|    total_timesteps      | 18432        |
| train/                  |              |
|    approx_kl            | 8.789357e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 7.67e+14     |
|    n_updates            | 80           |
|    policy_gradient_loss | -1.49e-06    |
|    reward               | 2085537.0    |
|    std                  | 1            |
|    value_loss           | 1.35e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4194078.3287386466
Sharpe:  0.7088772216329564
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 258          |
|    iterations           | 10           |
|    time_elapsed         | 79           |
|    total_timesteps      | 20480        |
| train/                  |              |
|    approx_kl            | 7.683411e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 1.19e-07     |
|    learning_rate        | 0.001        |
|    loss                 | 1.05e+15     |
|    n_updates            | 90           |
|    policy_gradient_loss | -1.07e-06    |
|    reward               | 1272599.6    |
|    std                  | 1            |
|    value_loss           | 2.08e+15     |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 258          |
|    iterations           | 11           |
|    time_elapsed         | 87           |
|    total_timesteps      | 22528        |
| train/                  |              |
|    approx_kl            | 7.945346e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.46e+15     |
|    n_updates            | 100          |
|    policy_gradient_loss | -1.14e-06    |
|    reward               | 4016451.2    |
|    std                  | 1            |
|    value_loss           | 2.78e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4195896.423487038
Sharpe:  0.7074945647632417
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 257          |
|    iterations           | 12           |
|    time_elapsed         | 95           |
|    total_timesteps      | 24576        |
| train/                  |              |
|    approx_kl            | 8.178176e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 8.19e+14     |
|    n_updates            | 110          |
|    policy_gradient_loss | -1.2e-06     |
|    reward               | 2698685.2    |
|    std                  | 1            |
|    value_loss           | 1.71e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4200279.1240972085
Sharpe:  0.7078889896224082
=================================
-------------------------------------------
| time/                   |               |
|    fps                  | 256           |
|    iterations           | 13            |
|    time_elapsed         | 103           |
|    total_timesteps      | 26624         |
| train/                  |               |
|    approx_kl            | 6.9849193e-09 |
|    clip_fraction        | 0             |
|    clip_range           | 0.2           |
|    entropy_loss         | -9.93         |
|    explained_variance   | -2.38e-07     |
|    learning_rate        | 0.001         |
|    loss                 | 9.95e+14      |
|    n_updates            | 120           |
|    policy_gradient_loss | -9.4e-07      |
|    reward               | 1757732.2     |
|    std                  | 1             |
|    value_loss           | 1.96e+15      |
-------------------------------------------
-------------------------------------------
| time/                   |               |
|    fps                  | 257           |
|    iterations           | 14            |
|    time_elapsed         | 111           |
|    total_timesteps      | 28672         |
| train/                  |               |
|    approx_kl            | 6.9849193e-09 |
|    clip_fraction        | 0             |
|    clip_range           | 0.2           |
|    entropy_loss         | -9.93         |
|    explained_variance   | 1.19e-07      |
|    learning_rate        | 0.001         |
|    loss                 | 1.29e+15      |
|    n_updates            | 130           |
|    policy_gradient_loss | -9.14e-07     |
|    reward               | 3963198.2     |
|    std                  | 1             |
|    value_loss           | 2.63e+15      |
-------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4117226.909721386
Sharpe:  0.7009549483123549
=================================
-------------------------------------------
| time/                   |               |
|    fps                  | 256           |
|    iterations           | 15            |
|    time_elapsed         | 119           |
|    total_timesteps      | 30720         |
| train/                  |               |
|    approx_kl            | 8.8475645e-09 |
|    clip_fraction        | 0             |
|    clip_range           | 0.2           |
|    entropy_loss         | -9.93         |
|    explained_variance   | 1.19e-07      |
|    learning_rate        | 0.001         |
|    loss                 | 1.14e+15      |
|    n_updates            | 140           |
|    policy_gradient_loss | -1.46e-06     |
|    reward               | 2481026.2     |
|    std                  | 1             |
|    value_loss           | 2.14e+15      |
-------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:3976828.667046468
Sharpe:  0.686149853760772
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 255          |
|    iterations           | 16           |
|    time_elapsed         | 128          |
|    total_timesteps      | 32768        |
| train/                  |              |
|    approx_kl            | 9.313226e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | -1.19e-07    |
|    learning_rate        | 0.001        |
|    loss                 | 7.51e+14     |
|    n_updates            | 150          |
|    policy_gradient_loss | -1.65e-06    |
|    reward               | 1788779.9    |
|    std                  | 1            |
|    value_loss           | 1.54e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4011862.64593621
Sharpe:  0.6882706958170082
=================================
-----------------------------------------
| time/                   |             |
|    fps                  | 255         |
|    iterations           | 17          |
|    time_elapsed         | 136         |
|    total_timesteps      | 34816       |
| train/                  |             |
|    approx_kl            | 8.96398e-09 |
|    clip_fraction        | 0           |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.93       |
|    explained_variance   | 0           |
|    learning_rate        | 0.001       |
|    loss                 | 1.03e+15    |
|    n_updates            | 160         |
|    policy_gradient_loss | -1.76e-06   |
|    reward               | 1022607.75  |
|    std                  | 1           |
|    value_loss           | 2.15e+15    |
-----------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 255          |
|    iterations           | 18           |
|    time_elapsed         | 144          |
|    total_timesteps      | 36864        |
| train/                  |              |
|    approx_kl            | 6.722985e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | -1.19e-07    |
|    learning_rate        | 0.001        |
|    loss                 | 1.33e+15     |
|    n_updates            | 170          |
|    policy_gradient_loss | -6.24e-07    |
|    reward               | 3342887.0    |
|    std                  | 1            |
|    value_loss           | 2.65e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:3874303.678110981
Sharpe:  0.6749724874730472
=================================
-----------------------------------------
| time/                   |             |
|    fps                  | 255         |
|    iterations           | 19          |
|    time_elapsed         | 152         |
|    total_timesteps      | 38912       |
| train/                  |             |
|    approx_kl            | 7.82893e-09 |
|    clip_fraction        | 0           |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.93       |
|    explained_variance   | 0           |
|    learning_rate        | 0.001       |
|    loss                 | 6.35e+14    |
|    n_updates            | 180         |
|    policy_gradient_loss | -1.17e-06   |
|    reward               | 2591912.2   |
|    std                  | 1           |
|    value_loss           | 1.39e+15    |
-----------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4075396.0292179375
Sharpe:  0.6960579699082773
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 255          |
|    iterations           | 20           |
|    time_elapsed         | 160          |
|    total_timesteps      | 40960        |
| train/                  |              |
|    approx_kl            | 7.945346e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 1.19e-07     |
|    learning_rate        | 0.001        |
|    loss                 | 9.7e+14      |
|    n_updates            | 190          |
|    policy_gradient_loss | -8.17e-07    |
|    reward               | 1483324.1    |
|    std                  | 1            |
|    value_loss           | 1.91e+15     |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 255          |
|    iterations           | 21           |
|    time_elapsed         | 168          |
|    total_timesteps      | 43008        |
| train/                  |              |
|    approx_kl            | 9.546056e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.38e+15     |
|    n_updates            | 200          |
|    policy_gradient_loss | -1.91e-06    |
|    reward               | 3484793.0    |
|    std                  | 1            |
|    value_loss           | 2.54e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4115279.627057315
Sharpe:  0.7000977033778167
=================================
-------------------------------------------
| time/                   |               |
|    fps                  | 254           |
|    iterations           | 22            |
|    time_elapsed         | 176           |
|    total_timesteps      | 45056         |
| train/                  |               |
|    approx_kl            | 5.6170393e-09 |
|    clip_fraction        | 0             |
|    clip_range           | 0.2           |
|    entropy_loss         | -9.93         |
|    explained_variance   | 0             |
|    learning_rate        | 0.001         |
|    loss                 | 1.01e+15      |
|    n_updates            | 210           |
|    policy_gradient_loss | -9.59e-07     |
|    reward               | 3015818.0     |
|    std                  | 1             |
|    value_loss           | 2.04e+15      |
-------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:4155706.236713753
Sharpe:  0.703959200241537
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 254          |
|    iterations           | 23           |
|    time_elapsed         | 185          |
|    total_timesteps      | 47104        |
| train/                  |              |
|    approx_kl            | 9.022187e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 8.5e+14      |
|    n_updates            | 220          |
|    policy_gradient_loss | -1.94e-06    |
|    reward               | 1757937.2    |
|    std                  | 1            |
|    value_loss           | 1.72e+15     |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 254          |
|    iterations           | 24           |
|    time_elapsed         | 193          |
|    total_timesteps      | 49152        |
| train/                  |              |
|    approx_kl            | 7.887138e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.13e+15     |
|    n_updates            | 230          |
|    policy_gradient_loss | -1.5e-06     |
|    reward               | 3765411.8    |
|    std                  | 1            |
|    value_loss           | 2.44e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:3983449.2318723113
Sharpe:  0.686623843915132
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 254          |
|    iterations           | 25           |
|    time_elapsed         | 201          |
|    total_timesteps      | 51200        |
| train/                  |              |
|    approx_kl            | 6.548362e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -9.93        |
|    explained_variance   | 5.96e-08     |
|    learning_rate        | 0.001        |
|    loss                 | 1.28e+15     |
|    n_updates            | 240          |
|    policy_gradient_loss | -7.5e-07     |
|    reward               | 3082500.2    |
|    std                  | 1            |
|    value_loss           | 2.53e+15     |
------------------------------------------
CPU times: user 3min 21s, sys: 1.52 s, total: 3min 23s
Wall time: 3min 22s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.4-Evaluation">
<a class="anchor" href="#3.4-Evaluation" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4 Evaluation<a class="anchor-link" href="#3.4-Evaluation"> </a>
</h3>
<p>We now use the most recent data to evaluate the performance of the two models of the agent. This is also referred to as <em>back-testing</em> or simply <em>trading</em>. This data has never been seen by the training process. The start date of this data is captured in the parameter TRADE_START.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TRADE_START</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'2020-07-01'</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trade</span> <span class="o">=</span> <span class="n">data_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">TRADE_START</span><span class="p">,</span> <span class="n">DATA_END</span><span class="p">)</span>
<span class="n">e_trade_gym</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">trade</span><span class="p">,</span> <span class="o">**</span><span class="n">env_kwargs</span><span class="p">)</span>
<span class="n">e_trade_gym</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__.Portfolio at 0x7fc9816700d0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baseline_df</span> <span class="o">=</span> <span class="n">get_baseline</span><span class="p">(</span>
        <span class="n">ticker</span><span class="o">=</span><span class="s2">"^DJI"</span><span class="p">,</span> 
        <span class="n">start</span><span class="o">=</span><span class="n">TRADE_START</span><span class="p">,</span>
        <span class="n">end</span><span class="o">=</span><span class="n">DATA_END</span><span class="p">)</span>
<span class="n">baseline_df_stats</span> <span class="o">=</span> <span class="n">backtest_stats</span><span class="p">(</span><span class="n">baseline_df</span><span class="p">,</span> <span class="n">value_col_name</span> <span class="o">=</span> <span class="s1">'close'</span><span class="p">)</span>
<span class="n">baseline_returns</span> <span class="o">=</span> <span class="n">get_daily_return</span><span class="p">(</span><span class="n">baseline_df</span><span class="p">,</span> <span class="n">value_col_name</span><span class="o">=</span><span class="s2">"close"</span><span class="p">)</span>
<span class="n">dji_cumpod</span> <span class="o">=</span><span class="p">(</span><span class="n">baseline_returns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[*********************100%***********************]  1 of 1 completed
Shape of DataFrame:  (295, 8)
Annual return          0.311845
Cumulative returns     0.374034
Annual volatility      0.140762
Sharpe ratio           2.006165
Calmar ratio           3.491806
Stability              0.950106
Max drawdown          -0.089308
Omega ratio            1.397014
Sortino ratio          2.988706
Skew                        NaN
Kurtosis                    NaN
Tail ratio             1.094883
Daily value at risk   -0.016614
dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_daily_return_a2c</span><span class="p">,</span> <span class="n">df_actions_a2c</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="o">.</span><span class="n">DRL_prediction</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">trained_a2c</span><span class="p">,</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">e_trade_gym</span><span class="p">)</span>
<span class="n">df_daily_return_ppo</span><span class="p">,</span> <span class="n">df_actions_ppo</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="o">.</span><span class="n">DRL_prediction</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">trained_ppo</span><span class="p">,</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">e_trade_gym</span><span class="p">)</span>
<span class="n">time_ind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">df_daily_return_a2c</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<span class="n">a2c_cumpod</span> <span class="o">=</span><span class="p">(</span><span class="n">df_daily_return_a2c</span><span class="o">.</span><span class="n">daily_return</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">ppo_cumpod</span> <span class="o">=</span><span class="p">(</span><span class="n">df_daily_return_ppo</span><span class="o">.</span><span class="n">daily_return</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">DRL_strat_a2c</span> <span class="o">=</span> <span class="n">convert_daily_return_to_pyfolio_ts</span><span class="p">(</span><span class="n">df_daily_return_a2c</span><span class="p">)</span>
<span class="n">DRL_strat_ppo</span> <span class="o">=</span> <span class="n">convert_daily_return_to_pyfolio_ts</span><span class="p">(</span><span class="n">df_daily_return_ppo</span><span class="p">)</span>

<span class="n">perf_func</span> <span class="o">=</span> <span class="n">timeseries</span><span class="o">.</span><span class="n">perf_stats</span>
<span class="n">perf_stats_all_a2c</span> <span class="o">=</span> <span class="n">perf_func</span><span class="p">(</span><span class="n">returns</span><span class="o">=</span><span class="n">DRL_strat_a2c</span><span class="p">,</span> <span class="n">factor_returns</span><span class="o">=</span><span class="n">DRL_strat_a2c</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">turnover_denom</span><span class="o">=</span><span class="s2">"AGB"</span><span class="p">)</span>
<span class="n">perf_stats_all_ppo</span> <span class="o">=</span> <span class="n">perf_func</span><span class="p">(</span><span class="n">returns</span><span class="o">=</span><span class="n">DRL_strat_ppo</span><span class="p">,</span> <span class="n">factor_returns</span><span class="o">=</span><span class="n">DRL_strat_ppo</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">turnover_denom</span><span class="o">=</span><span class="s2">"AGB"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>=================================
begin_total_asset:1000000
end_total_asset:1524583.336446113
Sharpe:  2.369076062885316
=================================
hit end!
=================================
begin_total_asset:1000000
end_total_asset:1507488.2263027485
Sharpe:  2.2708997438017855
=================================
hit end!
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.4.1-Inspect-actions">
<a class="anchor" href="#3.4.1-Inspect-actions" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4.1 Inspect actions<a class="anchor-link" href="#3.4.1-Inspect-actions"> </a>
</h4>
<p>For the sake of interest, we inspect some the actions taken by the A2C agent.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Inspect the actions taken by the A2C agent (for interest sake)</span>
<span class="c1"># A2C actions</span>
<span class="n">df_actions_a2c</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FBCVX</th>
      <th>FCPGX</th>
      <th>FDCAX</th>
      <th>FDGFX</th>
      <th>FDSCX</th>
      <th>FDSVX</th>
      <th>FSMVX</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-07-01</th>
      <td>0.142857</td>
      <td>0.142857</td>
      <td>0.142857</td>
      <td>0.142857</td>
      <td>0.142857</td>
      <td>0.142857</td>
      <td>0.142857</td>
    </tr>
    <tr>
      <th>2020-07-02</th>
      <td>0.197429</td>
      <td>0.103983</td>
      <td>0.103983</td>
      <td>0.103983</td>
      <td>0.103983</td>
      <td>0.103983</td>
      <td>0.282655</td>
    </tr>
    <tr>
      <th>2020-07-06</th>
      <td>0.242351</td>
      <td>0.089156</td>
      <td>0.089156</td>
      <td>0.242351</td>
      <td>0.158675</td>
      <td>0.089156</td>
      <td>0.089156</td>
    </tr>
    <tr>
      <th>2020-07-07</th>
      <td>0.250948</td>
      <td>0.230227</td>
      <td>0.092319</td>
      <td>0.149551</td>
      <td>0.092319</td>
      <td>0.092319</td>
      <td>0.092319</td>
    </tr>
    <tr>
      <th>2020-07-08</th>
      <td>0.112299</td>
      <td>0.214671</td>
      <td>0.078973</td>
      <td>0.214671</td>
      <td>0.214671</td>
      <td>0.078973</td>
      <td>0.085741</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-08-25</th>
      <td>0.257359</td>
      <td>0.106575</td>
      <td>0.094677</td>
      <td>0.094677</td>
      <td>0.094677</td>
      <td>0.094677</td>
      <td>0.257359</td>
    </tr>
    <tr>
      <th>2021-08-26</th>
      <td>0.270076</td>
      <td>0.151744</td>
      <td>0.099356</td>
      <td>0.099356</td>
      <td>0.099356</td>
      <td>0.099356</td>
      <td>0.180758</td>
    </tr>
    <tr>
      <th>2021-08-27</th>
      <td>0.222533</td>
      <td>0.081865</td>
      <td>0.081865</td>
      <td>0.222533</td>
      <td>0.081865</td>
      <td>0.086806</td>
      <td>0.222533</td>
    </tr>
    <tr>
      <th>2021-08-30</th>
      <td>0.124118</td>
      <td>0.186260</td>
      <td>0.085769</td>
      <td>0.233143</td>
      <td>0.124187</td>
      <td>0.085769</td>
      <td>0.160754</td>
    </tr>
    <tr>
      <th>2021-08-31</th>
      <td>0.223638</td>
      <td>0.223638</td>
      <td>0.082272</td>
      <td>0.082272</td>
      <td>0.082272</td>
      <td>0.082272</td>
      <td>0.223638</td>
    </tr>
  </tbody>
</table>
<p>295 rows × 7 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is a visualization of the A2C agent's actions specifically on two of the funds:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_actions_a2c</span><span class="p">[</span><span class="s1">'FBCVX'</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'FBCVX A2C'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="n">df_actions_a2c</span><span class="p">[</span><span class="s1">'FSMVX'</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'FSMVX A2C'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">traceorder</span><span class="o">=</span><span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="s2">"sans-serif"</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span>
        <span class="p">),</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">"White"</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span> <span class="s2">"Actions of A2C &amp; PPO"</span><span class="p">,</span>
        <span class="s1">'y'</span><span class="p">:</span> <span class="mf">0.87</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span> <span class="mf">0.48</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
        <span class="s1">'yanchor'</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Daily Actions"</span><span class="p">),</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="c1"># fig.update_layout(font_size = 20)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zerolinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">'Grey'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="03e7caac-dbd0-4658-b969-2885789d36d9" class="plotly-graph-div" style="height:600px; width:900px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("03e7caac-dbd0-4658-b969-2885789d36d9")) {
                    Plotly.newPlot(
                        '03e7caac-dbd0-4658-b969-2885789d36d9',
                        [{"line": {"width": 2}, "mode": "lines", "name": "FBCVX A2C", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31"], "y": [0.14285714285714285, 0.19742923974990845, 0.24235069751739502, 0.2509480118751526, 0.1122993603348732, 0.3117910325527191, 0.1886855661869049, 0.2604575753211975, 0.10461161285638809, 0.13860049843788147, 0.29634982347488403, 0.22151297330856323, 0.2580581605434418, 0.09990306943655014, 0.19306497275829315, 0.3117910325527191, 0.22223450243473053, 0.22363772988319397, 0.23042136430740356, 0.27499622106552124, 0.25557151436805725, 0.152822807431221, 0.28732830286026, 0.227549210190773, 0.2644771933555603, 0.24361878633499146, 0.2924351096153259, 0.2528248727321625, 0.16537103056907654, 0.21682804822921753, 0.2604575753211975, 0.2604575753211975, 0.08257373422384262, 0.21113495528697968, 0.2820654511451721, 0.24991093575954437, 0.2019283026456833, 0.2275187373161316, 0.22478950023651123, 0.29263442754745483, 0.30273953080177307, 0.2315344214439392, 0.1972423791885376, 0.24073943495750427, 0.22363772988319397, 0.23245787620544434, 0.0882963091135025, 0.12410693615674973, 0.08536579459905624, 0.0913771539926529, 0.08556803315877914, 0.08948466181755066, 0.11195888370275497, 0.235012948513031, 0.11333098262548447, 0.11742906272411346, 0.08227171748876572, 0.19365443289279938, 0.0861378014087677, 0.08227171748876572, 0.08012454211711884, 0.09052146971225739, 0.08799022436141968, 0.07557424902915955, 0.15927569568157196, 0.1258087158203125, 0.12757347524166107, 0.2604575753211975, 0.1573585420846939, 0.19019518792629242, 0.23344066739082336, 0.13508391380310059, 0.2604575753211975, 0.2974393963813782, 0.23973798751831055, 0.24950076639652252, 0.2938532829284668, 0.2983211576938629, 0.24697932600975037, 0.2065970003604889, 0.25409796833992004, 0.3117910325527191, 0.22363772988319397, 0.114129438996315, 0.07791929692029953, 0.14888426661491394, 0.07946807891130447, 0.1065005511045456, 0.11322613060474396, 0.11799245327711105, 0.2779606580734253, 0.2932570278644562, 0.2749530076980591, 0.21469908952713013, 0.25164324045181274, 0.23074600100517273, 0.22466173768043518, 0.2110966444015503, 0.2604575753211975, 0.22568023204803467, 0.2314290851354599, 0.2577689588069916, 0.2604575753211975, 0.19593864679336548, 0.25818875432014465, 0.24846135079860687, 0.20655804872512817, 0.17756319046020508, 0.240834042429924, 0.15498286485671997, 0.2541278600692749, 0.21712596714496613, 0.3085899353027344, 0.24127197265625, 0.25020167231559753, 0.12028902024030685, 0.11470150202512741, 0.237439826130867, 0.21805627644062042, 0.2425411194562912, 0.2424544394016266, 0.2883906662464142, 0.288220077753067, 0.23032918572425842, 0.3117910325527191, 0.2060750275850296, 0.2780575454235077, 0.2639247477054596, 0.29917111992836, 0.10447382181882858, 0.3117910325527191, 0.12446663528680801, 0.2604575753211975, 0.22363772988319397, 0.30619892477989197, 0.1757982224225998, 0.24748778343200684, 0.18500004708766937, 0.16683852672576904, 0.2400214672088623, 0.21213982999324799, 0.2938865125179291, 0.13992373645305634, 0.2604575753211975, 0.1785685122013092, 0.0804566815495491, 0.14485660195350647, 0.11302785575389862, 0.3117910325527191, 0.2338867336511612, 0.20094381272792816, 0.2613010108470917, 0.22363772988319397, 0.2536216676235199, 0.11337047815322876, 0.2604575753211975, 0.18316005170345306, 0.2604575753211975, 0.2604575753211975, 0.13945522904396057, 0.2096848338842392, 0.1835324615240097, 0.29211580753326416, 0.22307680547237396, 0.22492194175720215, 0.11470150202512741, 0.07878144085407257, 0.14555411040782928, 0.08288826048374176, 0.14100009202957153, 0.0720817968249321, 0.16897442936897278, 0.09291501343250275, 0.18125596642494202, 0.15347778797149658, 0.15646474063396454, 0.22142218053340912, 0.2974320948123932, 0.2976159155368805, 0.2623431384563446, 0.2604575753211975, 0.23507629334926605, 0.10617361962795258, 0.0875076875090599, 0.16816480457782745, 0.15965133905410767, 0.3117910325527191, 0.2990204989910126, 0.11240866035223007, 0.2689075469970703, 0.2712680697441101, 0.2604575753211975, 0.22363772988319397, 0.26269057393074036, 0.21718798577785492, 0.2194293588399887, 0.25779861211776733, 0.24865123629570007, 0.2269921451807022, 0.27815350890159607, 0.24810688197612762, 0.27499502897262573, 0.25497859716415405, 0.21590809524059296, 0.2168298363685608, 0.27610865235328674, 0.2713298201560974, 0.1428571492433548, 0.2554713487625122, 0.1839180290699005, 0.2604575753211975, 0.2289387434720993, 0.20773528516292572, 0.21256336569786072, 0.0902777910232544, 0.24321922659873962, 0.21950387954711914, 0.09968037158250809, 0.10485227406024933, 0.15286482870578766, 0.22505776584148407, 0.17963384091854095, 0.11513924598693848, 0.20793430507183075, 0.0888393223285675, 0.14498063921928406, 0.08000056445598602, 0.2490173727273941, 0.17619003355503082, 0.21469837427139282, 0.22363772988319397, 0.24041414260864258, 0.09182071685791016, 0.09935050457715988, 0.3084428012371063, 0.23721230030059814, 0.2525976598262787, 0.2413969188928604, 0.17089499533176422, 0.22339177131652832, 0.19901765882968903, 0.15737926959991455, 0.192056804895401, 0.12389524281024933, 0.09581697732210159, 0.1317678838968277, 0.15492543578147888, 0.12019573152065277, 0.1210203766822815, 0.1076011136174202, 0.2518868148326874, 0.22563090920448303, 0.259184330701828, 0.19695240259170532, 0.22547154128551483, 0.138443261384964, 0.22701498866081238, 0.11888715624809265, 0.304479718208313, 0.22363772988319397, 0.12014645338058472, 0.11993984133005142, 0.15413597226142883, 0.13828463852405548, 0.08597255498170853, 0.12682171165943146, 0.2948206663131714, 0.2604575753211975, 0.24518688023090363, 0.24101951718330383, 0.21952295303344727, 0.30278509855270386, 0.2625925838947296, 0.10777910053730011, 0.310333251953125, 0.28936293721199036, 0.20937751233577728, 0.28935831785202026, 0.1696578711271286, 0.2604575753211975, 0.2690390348434448, 0.20179986953735352, 0.21526268124580383, 0.25157028436660767, 0.2544984817504883, 0.1335909515619278, 0.22558635473251343, 0.11949492990970612, 0.15781058371067047, 0.29558539390563965, 0.2573586702346802, 0.2700764238834381, 0.22253280878067017, 0.12411825358867645, 0.22363772988319397]}, {"line": {"width": 2}, "mode": "lines", "name": "FSMVX A2C", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31"], "y": [-0.14285714285714285, -0.2826553285121918, -0.08915583044290543, -0.09231860935688019, -0.08574050664901733, -0.11470150202512741, -0.13521908223628998, -0.09581697732210159, -0.19647766649723053, -0.13860049843788147, -0.15279576182365417, -0.0909908339381218, -0.2580581605434418, -0.23889611661434174, -0.24298293888568878, -0.11470150202512741, -0.22223450243473053, -0.22363772988319397, -0.23042136430740356, -0.21917660534381866, -0.20451048016548157, -0.1539231687784195, -0.18416085839271545, -0.227549210190773, -0.12258712947368622, -0.10091397911310196, -0.10758085548877716, -0.2528248727321625, -0.20815691351890564, -0.18019872903823853, -0.2604575753211975, -0.09581697732210159, -0.2161228060722351, -0.21113495528697968, -0.1037660762667656, -0.2443125694990158, -0.1047460287809372, -0.1495305895805359, -0.22478950023651123, -0.16909466683864594, -0.11137163639068604, -0.14098577201366425, -0.1972423791885376, -0.0924631878733635, -0.22363772988319397, -0.23245787620544434, -0.204880028963089, -0.12410693615674973, -0.08536579459905624, -0.0913771539926529, -0.08556803315877914, -0.08948466181755066, -0.11195888370275497, -0.09537603706121445, -0.11333098262548447, -0.09201651811599731, -0.08227171748876572, -0.10028377175331116, -0.08859238773584366, -0.08227171748876572, -0.08012454211711884, -0.09052146971225739, -0.08175906538963318, -0.07557424902915955, -0.08098062127828598, -0.1557662934064865, -0.188413605093956, -0.2604575753211975, -0.13178539276123047, -0.21715493500232697, -0.23344066739082336, -0.30029428005218506, -0.09581697732210159, -0.15545141696929932, -0.08819466829299927, -0.24950076639652252, -0.10810258239507675, -0.15294785797595978, -0.24697932600975037, -0.1270490139722824, -0.15043184161186218, -0.11470150202512741, -0.22363772988319397, -0.114129438996315, -0.07791929692029953, -0.09019339829683304, -0.07946807891130447, -0.1065005511045456, -0.11322613060474396, -0.2689206600189209, -0.21075938642024994, -0.16732683777809143, -0.1011495515704155, -0.25607138872146606, -0.1871827095746994, -0.23074600100517273, -0.22466173768043518, -0.15685352683067322, -0.2604575753211975, -0.22568023204803467, -0.1231968104839325, -0.2577689588069916, -0.2604575753211975, -0.19593864679336548, -0.25818875432014465, -0.13746203482151031, -0.23149749636650085, -0.142532080411911, -0.09174715727567673, -0.24341434240341187, -0.24775652587413788, -0.21712596714496613, -0.12379061430692673, -0.08875899016857147, -0.25020167231559753, -0.25340819358825684, -0.11470150202512741, -0.237439826130867, -0.21805627644062042, -0.22316874563694, -0.2424544394016266, -0.16054369509220123, -0.18162883818149567, -0.23032918572425842, -0.11470150202512741, -0.2060750275850296, -0.16127867996692657, -0.23214595019817352, -0.15053443610668182, -0.2530979812145233, -0.11470150202512741, -0.2522048056125641, -0.2604575753211975, -0.22363772988319397, -0.13057969510555267, -0.1149589940905571, -0.24748778343200684, -0.18500004708766937, -0.18262334167957306, -0.2400214672088623, -0.21213982999324799, -0.13887514173984528, -0.13992373645305634, -0.2604575753211975, -0.1698361039161682, -0.16824489831924438, -0.13798081874847412, -0.11302785575389862, -0.11470150202512741, -0.18805807828903198, -0.20094381272792816, -0.11409745365381241, -0.08227171748876572, -0.2536216676235199, -0.11337047815322876, -0.2604575753211975, -0.2787514328956604, -0.2604575753211975, -0.2604575753211975, -0.16326859593391418, -0.2697230577468872, -0.22516891360282898, -0.11092063039541245, -0.16473311185836792, -0.21917957067489624, -0.11470150202512741, -0.07878144085407257, -0.2851676344871521, -0.22531366348266602, -0.12595999240875244, -0.0720817968249321, -0.10766976326704025, -0.09291501343250275, -0.18125596642494202, -0.24384789168834686, -0.11335881054401398, -0.1310741901397705, -0.14985553920269012, -0.10948676615953445, -0.1949211210012436, -0.2604575753211975, -0.18392853438854218, -0.17379635572433472, -0.06876266747713089, -0.07633307576179504, -0.1612524688243866, -0.11470150202512741, -0.11000348627567291, -0.305558443069458, -0.09892554581165314, -0.2297622412443161, -0.09581697732210159, -0.22363772988319397, -0.20297236740589142, -0.1822427213191986, -0.2194293588399887, -0.23089781403541565, -0.24865123629570007, -0.2269921451807022, -0.21021175384521484, -0.24810688197612762, -0.1284611076116562, -0.25497859716415405, -0.20528951287269592, -0.2758226990699768, -0.21601788699626923, -0.1244366392493248, -0.1428571492433548, -0.14593999087810516, -0.26452574133872986, -0.09581697732210159, -0.1253102868795395, -0.20773528516292572, -0.21256336569786072, -0.2235134392976761, -0.24321922659873962, -0.21950387954711914, -0.27095934748649597, -0.10485227406024933, -0.07735762745141983, -0.08279411494731903, -0.19650526344776154, -0.09565339982509613, -0.08121974766254425, -0.24149031937122345, -0.12364781647920609, -0.21746410429477692, -0.1260082721710205, -0.12165556848049164, -0.21469837427139282, -0.22363772988319397, -0.24041414260864258, -0.20190615952014923, -0.2700626850128174, -0.11346976459026337, -0.23721230030059814, -0.17575675249099731, -0.2413969188928604, -0.29200035333633423, -0.22339177131652832, -0.2515038251876831, -0.27217450737953186, -0.09394078701734543, -0.12389524281024933, -0.09581697732210159, -0.1317678838968277, -0.17284280061721802, -0.11398965120315552, -0.1210203766822815, -0.1076011136174202, -0.2518868148326874, -0.2504936158657074, -0.12014028429985046, -0.2522113621234894, -0.16490739583969116, -0.11013669520616531, -0.21191348135471344, -0.09173144400119781, -0.1354612410068512, -0.22363772988319397, -0.16633662581443787, -0.1876038759946823, -0.1023782417178154, -0.11164600402116776, -0.08597255498170853, -0.07796881347894669, -0.10845845192670822, -0.2604575753211975, -0.24518688023090363, -0.2073199301958084, -0.1300795078277588, -0.12994514405727386, -0.25439539551734924, -0.2173064798116684, -0.11416521668434143, -0.10669282078742981, -0.18089571595191956, -0.17839688062667847, -0.13629840314388275, -0.09581697732210159, -0.09897392988204956, -0.2366565763950348, -0.2260502129793167, -0.25157028436660767, -0.2544984817504883, -0.1646551638841629, -0.08298857510089874, -0.11949492990970612, -0.11324822902679443, -0.10873978585004807, -0.2573586702346802, -0.18075764179229736, -0.22253280878067017, -0.16075393557548523, -0.22363772988319397]}],
                        {"font": {"size": 15}, "height": 600, "legend": {"bgcolor": "White", "bordercolor": "white", "borderwidth": 2, "font": {"color": "black", "family": "sans-serif", "size": 20}, "traceorder": "normal", "x": 0, "y": 1}, "paper_bgcolor": "rgba(1, 1, 0, 0)", "plot_bgcolor": "rgba(1, 1, 0, 0)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "Actions of A2C & PPO", "x": 0.48, "xanchor": "center", "y": 0.87, "yanchor": "top"}, "width": 900, "xaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Date"}}, "yaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Daily Actions"}, "zeroline": true, "zerolinecolor": "Grey", "zerolinewidth": 1}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('03e7caac-dbd0-4658-b969-2885789d36d9');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.4.2-Inspect-daily-return">
<a class="anchor" href="#3.4.2-Inspect-daily-return" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4.2 Inspect daily return<a class="anchor-link" href="#3.4.2-Inspect-daily-return"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is a visualization of the daily return of the portfolio:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">DRL_strat_a2c</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'A2C'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">DRL_strat_ppo</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'PPO'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">traceorder</span><span class="o">=</span><span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="s2">"sans-serif"</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span>
        <span class="p">),</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">"White"</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span> <span class="s2">"Daily Return of A2C &amp; PPO"</span><span class="p">,</span>
        <span class="s1">'y'</span><span class="p">:</span> <span class="mf">0.87</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span> <span class="mf">0.48</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
        <span class="s1">'yanchor'</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Daily Return"</span><span class="p">),</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="c1"># fig.update_layout(font_size = 20)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zerolinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">'Grey'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="faf18ec6-3b86-4ab8-bd32-f8db8369e871" class="plotly-graph-div" style="height:600px; width:900px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("faf18ec6-3b86-4ab8-bd32-f8db8369e871")) {
                    Plotly.newPlot(
                        'faf18ec6-3b86-4ab8-bd32-f8db8369e871',
                        [{"line": {"width": 2}, "mode": "lines", "name": "A2C", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31"], "y": [0.0, 0.0048802542194163285, 0.013380814431744416, -0.015484779721099448, 0.00786869347471548, -0.013524206042633723, 0.011819827990598653, -0.012223978961216938, 0.013965818837598103, 0.019727212402532484, -0.003783892902943178, 0.0018591006413186777, -0.0008716343392574269, 0.008688917284597053, 0.006701825473365331, -0.0038684977447972662, -0.010010124086249027, 0.0061133757676923774, -0.009715856452446929, 0.01737487788401678, -0.004827541039635688, -0.0026231765301336354, 0.010173387534154804, 0.003691708730697218, 0.010610392317919898, 0.0008324600343704949, 0.005701115735155469, 0.007189725932470668, -0.0013234497607586646, 0.0075503882578738584, -0.005224500834197964, 0.0012576328322956006, 0.0024127529001654636, -0.0037769365974179327, -0.0017774550756022311, -0.003623952268601387, -0.0004151096622312701, 0.01112879748209865, 0.000618510090323739, 0.001734555845276109, 0.0018294253202746124, 0.006706937430773269, -0.006987360151713614, 0.007421062496925192, 0.012326749055743184, -0.02971489593116045, -0.0068875511868611685, -0.021976826221758804, 0.02041382387809565, -0.0136652475525669, 0.0012210607723790714, 0.021015748662428557, 0.0023050424973208713, -0.00041227361894287357, -0.007002602153793203, -0.00848735299650845, -0.015977925633229924, 0.008576901320897714, -0.022367168907896872, 0.00045145660860687067, 0.01564788516310793, 0.016694247406315876, -0.003629858502469173, 0.007067826973559239, 0.01024849545433741, -0.003043989001943204, 0.021450620239760743, -0.008352979027992046, 0.018344853754648845, 0.009310054737826525, 0.006050221337912022, 0.009629881255557598, -0.004112533409980808, -0.00623119710710334, 0.00234834570247195, 0.0005952968796356613, -0.014216624886603932, 0.003146995777640693, -0.006321784039432727, 0.008344154036855256, 0.00530763495211048, -0.01935843357182453, -0.007611368951495348, -0.02891969707512901, 0.010409634172010743, -0.013586688652329836, 0.014733204812923461, 0.021406480766567076, 0.02003589979635319, 0.0224077009813467, -0.004565877691079165, 0.01782327898633044, 0.004904321259279353, 0.004079151880394082, -0.011591080530094406, 0.016888098415667404, 0.01680931021479531, -0.00274066914415027, -0.012115754461023276, 0.003416656978430163, 1.6870385589725723e-05, 0.01351580833856989, 0.014387288896200057, -0.003910577593086903, 0.0023860443129037345, -0.010809827646704875, 0.009775095163126746, 5.71265429288732e-05, 0.0041588627260486155, 0.014198351970591654, -0.0019878440527354305, 0.004766785285946387, -0.005300332994334359, 0.004275657738410443, -0.0048833188786339115, 0.0005579103025083841, 0.015864013285037372, -0.00019740560788054115, 0.006694914123479989, -0.0021716108110227603, -0.0022650718413835193, 0.0014159946370147598, 0.005067910698404481, 0.0018321039423535616, 0.0013637801770884851, -0.006901952860056045, 0.00588563246107009, 0.0028857669374437642, -0.012683562076312771, 0.009993659967490326, 0.01924309336885077, 0.016533064464025273, 0.0012449564663332994, 0.000416246555064026, 0.007101669037793854, -0.002612407082940824, 0.006103593234305401, -0.007859189181118224, 0.010410969099541187, 0.00827623233789372, -0.0029397165484322755, 0.00014263697061355515, -0.0007839244247583345, -0.008921173553599296, -0.028328439583507954, 0.010944724397110873, -0.019018674532754225, 0.020827145798033266, 0.015869817979432325, 0.003904010234611286, 0.011845024390047483, 0.006983194399362431, 0.012953223430941326, 0.0023123960307340516, -0.0023027206247493515, 0.0027665567108183927, 0.0033238403354680654, -0.0017085475826377765, -0.002917340694783776, -0.009340202330239265, 0.009234351852204784, -0.004565076477189536, 0.00033394230669747725, 0.012655722697823547, -0.026301028582915553, -0.0008051865410106974, 0.02816121540477779, -0.009768533411654977, -0.011506414252828693, -0.01943495503840654, 0.01877214525513323, -0.006653317548082807, 0.015304874073413629, 0.010460786478147839, 0.01643190142859548, 0.003196113169261292, 0.007249244907737776, -0.0065326973073855585, 0.0031143770625939606, -0.01218788235506494, 0.002429945710970313, 0.0015502522425097415, -0.018808184492827312, -0.012684655289874391, 0.010047392233244155, 0.018248852264276264, -0.010165859604474765, 0.0047801098410236295, 0.0018314449380644705, 0.013302468513524623, 0.010590739919879943, -0.0014531800114968253, -0.005967726892124093, 0.0037593344494104867, 0.0053209451992917885, 0.0001365877769052505, -0.002251617263820371, 0.0028504205706938166, 0.007454918235577314, 0.005132049574128278, -0.006965082352334511, -0.010938306502493948, 0.012292414266056732, -0.005457439451933008, 0.012378431960446938, 0.005181671185046114, 0.0009163443120081411, -5.7179721309303115e-05, 0.005605531969753657, -0.010555542251641615, 0.003861694616512178, -0.006886272395877599, 0.0012365703504572173, 0.005291532722386786, 0.011340626632049357, -0.010120367163252961, -0.009496402747416388, -0.02690357585644724, 0.010415670076733214, 0.01767000742192582, -0.001591202661121084, -0.007403358805384477, -0.005932839369666378, 0.010258305102290748, 0.0006884048063599569, 0.007768322368264711, -0.003450792999707948, 0.007635599906107752, 0.004061053608199297, 0.0004821834319358937, 0.004535646445562615, -0.0018921306678957796, -0.004399532517532619, 0.006763393703916966, 0.001817091756684503, 0.004153542222238065, -0.003981296501801874, -2.0724428531559373e-06, 0.0060292359459041215, -0.0040744717922289835, -0.001374067945397997, -0.0058805180005009235, -0.008499490218033957, -0.014217891673949148, 0.013858558762999981, 0.0031974103032511554, -0.0009578204214600317, 0.008444269830509119, 0.004731717533236861, -0.0022547324842820847, -0.002727451190965024, 0.0006143666527407474, 0.006069410178047709, 0.0007016331388303616, -0.008017470929152355, 0.00022302808680226997, -0.011046270967527215, 0.016281708937842265, 0.003212556502752119, -0.010697876005860769, -0.005627186152443408, -0.004408024820227034, -0.00922905610650946, -0.014506963444866135, 0.020662654807101395, 0.011687718605728861, -0.002876176710060261, 0.00948019686720838, 0.000965818793439568, -0.004457699640868937, 0.00588167325188523, 0.007791112207479789, -0.004147294138824051, -0.0024761987738391726, 0.007495944503519583, -0.005251008466197464, 0.008683311586391506, 0.0027879382189306677, -0.0016307427213983977, 0.00296140106127571, 0.004844928053466136, 0.00042068696296283694, -0.0006218587786494202, -0.0012853550675648374, -0.008563580504425045, -0.007948943884992503, -0.004219963728466461, 0.01299726523003275, 0.010528511133614176, 0.006503474553466372, 0.00503916725049783, -0.006637235199199969, 0.012651283934631821, -0.0007963025925866146, 0.000425252397433125]}, {"line": {"width": 2}, "mode": "lines", "name": "PPO", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31"], "y": [0.0, 0.005276960729276555, 0.01350097091472913, -0.015266643953850202, 0.01094243088228779, -0.009376526953101046, 0.010457905269965912, -0.008093730339016711, 0.014086931128491947, 0.0197413516531373, -0.004689391355683365, 0.003903914362585337, 0.005125963379695885, 0.0016240752636663192, 0.007144854917534911, -0.002248634372508552, -0.009372076553582775, 0.00802553292152234, -0.008986826909911509, 0.017054448109592002, -0.0034477809659430557, -0.0019215099498902013, 0.011630371797504311, 0.0031721188810364615, 0.010771162602081889, 0.001937070243293175, 0.00260708350489594, 0.005443699260418691, -0.005194749674137479, 0.009602333845315853, -0.0035309844498392267, -0.0006807328662028771, 0.0022057354833914574, -0.002212662545733527, -0.002868596623547393, -0.0014662591153721083, -4.1366455261176885e-05, 0.011748480083723442, 0.002404201461540671, 0.002737750484763508, 0.0017968933647748925, 0.006914488038361265, -0.007094927463792535, 0.0078950930353641, 0.012222471670261081, -0.031753764385569504, -0.0055093098012197, -0.023017561043118393, 0.01823374699835303, -0.013847660242400911, 0.00069172380984902, 0.021157248476215536, 0.002130143674479081, 0.0013613855834213005, -0.006476602917734775, -0.008825859240446904, -0.018824681338406646, 0.007601523124283012, -0.021285585393822557, -0.00013286280566353835, 0.013806629623405568, 0.017119907805213518, -0.00419123290611985, 0.007140207621763281, 0.010888938689751998, -0.0027796480022664583, 0.02200283731404262, -0.009250639604473424, 0.018225328086632128, 0.009025985149197266, 0.007477958262435547, 0.011286584583222778, -0.0028850683155307736, -0.005845306952715391, 0.0029710909182183638, 0.0002988070367645235, -0.01421520408347159, 0.0036115136244295374, -0.0065156724692731266, 0.00630767904539262, 0.005607570631954696, -0.01867969512540584, -0.004094728920904898, -0.029853506254774294, 0.01072211935524026, -0.013630745997855263, 0.017028756861481007, 0.023544959344872066, 0.02033764281619923, 0.022231998380901348, -0.004588952194384594, 0.013638840412066963, -0.00037578243319655183, 0.008031100998069111, -0.011817598359784964, 0.01627462870427569, 0.01439915118648907, -0.002371649542127813, -0.011245401159744803, 0.004978243614665622, -0.0013899899911229427, 0.012024692204486414, 0.012657388227252672, -0.0034700893849746953, 0.004007654177838072, -0.011075702705782316, 0.00975398091969203, 0.0009388736305835467, 0.004398729400713579, 0.014584769912262497, -0.0005883435615490996, 0.004399804804039788, -0.0078057201130825316, 0.0028615630271452645, -0.003986205555313773, 0.0014675248724766688, 0.016396983303703098, 0.0011397477665181302, 0.008649498773930429, -0.0023006555260831046, -0.0009013564655863987, 0.0037524523261657857, 0.0034694875749505705, 0.001149197008681276, 0.0012368400691696903, -0.0073926395007270175, 0.00631835052747832, 0.0017720962802389056, -0.013577542393777274, 0.009195388009790853, 0.01667770165037308, 0.017442193580952153, 0.0011782590223869405, -0.0006865965809046324, 0.007537020283209904, -0.0024704380225557022, 0.00650236214804345, -0.00839046422734961, 0.011777544847393497, 0.010067133793971375, -0.003088234158321987, 0.00047650448540479437, -0.0011083952771123837, -0.009324361045757663, -0.027955160098192766, 0.011721523819744983, -0.019392428477326897, 0.020603750797332326, 0.01616669913268086, 0.0037808370744337417, 0.01135873480440338, 0.006597281259522355, 0.013882314631385506, 0.00209397943183977, -0.0021841658265089677, 0.004200857974793816, 0.0037137787071128024, -0.002786081547003731, -0.004058420154265129, -0.008408916163059965, 0.008584704382750157, -0.011740858509948887, 0.0008153662911496977, 0.012408938181673563, -0.027880994935684293, -0.0029093017600373265, 0.028770231509558097, -0.011528085807083692, -0.014962534625265924, -0.021078176962338536, 0.019316763230975205, -0.006358510122353966, 0.012484338894173207, 0.008893616731745449, 0.015534974318405226, 0.0014450564405528016, 0.007838574019023097, -0.0067759719792659535, 0.0030991383542782612, -0.02014593018645275, 0.003778499758513638, 0.0004476247066066665, -0.019188456903567106, -0.013149127717698455, 0.011630569569685, 0.01750634065602126, -0.009821000868132127, 0.006513141504667164, 0.0039347335811591826, 0.013275637436623931, 0.009673056018926277, -0.0009330267835281676, -0.006350903891458799, 0.005387277507897495, 0.0052849479051317125, -0.0004509968443995245, -0.0008759306828074079, 0.0015929115979432323, 0.00845748103912647, 0.004335491783891769, -0.008831484449237828, -0.011927061727125649, 0.012514501605330198, -0.004358531490491288, 0.014145083169219488, 0.007197649465809709, 0.0008893385703238668, 0.0003293968765788763, 0.002360757869143082, -0.011013051331966384, 0.0029329004410131756, -0.00811726244826035, 0.000831169936350371, 5.896879948444865e-05, 0.011725082449105924, -0.014833992531323406, -0.009137547945616598, -0.026301098627263153, 0.01178067021743992, 0.017925646346988042, -0.0010992916484770174, -0.006380968021304525, -0.005417519864404327, 0.00965592157638029, 0.00046387790411317833, 0.0073652612558105434, -0.0021885287818886445, 0.0074446445408507325, 0.005251578051226362, 0.0004460327960842679, 0.004128013320611154, -0.0017170561391879578, -0.006186516160902036, 0.0075961691358498555, 0.0031640587482264573, 0.004064991317206937, -0.0036412982937888334, 0.001050414750981977, 0.005242382891828887, -0.001953108494962664, -0.0033797556506981303, -0.004538728634429097, -0.006065243973459674, -0.015440246716629843, 0.01746002882293701, 0.002728250836233668, -8.932777570889796e-05, 0.009559409557557384, 0.005304951617524492, -0.002198906040077306, -0.0015486795010929198, -0.00017377244695934366, 0.005414963686778283, -0.0001090780456415928, -0.007751226407439421, 8.744351107366644e-05, -0.010767332862088292, 0.015283492524293176, 0.00319396881734381, -0.008848531556883699, -0.007512039002159261, -0.004440247391765366, -0.00881326297847494, -0.01507229316991075, 0.020754034888557857, 0.01229714172994598, -0.0031224087437656074, 0.00896585671628266, 0.0005427330047332275, -0.006324039260275566, 0.007887012721087994, 0.006567438758459631, -0.005358998698658117, -0.0017219097952016322, 0.006499973471972609, -0.005161259441966815, 0.008586986344854684, 0.002349706284494723, -0.0024351731654108652, 0.003752364843968651, 0.004272769591785081, 0.0011364381742441393, -0.0005851170073008545, -0.002269724997289371, -0.00914945812874009, -0.00819705728023308, -0.0036249224167159665, 0.013380973210594435, 0.009615416454497037, 0.0072566087173837664, 0.005310970562248083, -0.006938441870788436, 0.013701221217994365, -6.948333490427766e-06, -9.14452718151187e-05]}],
                        {"font": {"size": 15}, "height": 600, "legend": {"bgcolor": "White", "bordercolor": "white", "borderwidth": 2, "font": {"color": "black", "family": "sans-serif", "size": 20}, "traceorder": "normal", "x": 0, "y": 1}, "paper_bgcolor": "rgba(1, 1, 0, 0)", "plot_bgcolor": "rgba(1, 1, 0, 0)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "Daily Return of A2C & PPO", "x": 0.48, "xanchor": "center", "y": 0.87, "yanchor": "top"}, "width": 900, "xaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Date"}}, "yaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Daily Return"}, "zeroline": true, "zerolinecolor": "Grey", "zerolinewidth": 1}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('faf18ec6-3b86-4ab8-bd32-f8db8369e871');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.4.3-Inspect-cumulative-return">
<a class="anchor" href="#3.4.3-Inspect-cumulative-return" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4.3 Inspect cumulative return<a class="anchor-link" href="#3.4.3-Inspect-cumulative-return"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we inspect the cumulative return of the portfolio brought about by each of the agents. The DJIA index is used as a baseline for reference. Both agents end up with a larger cumulative return than the DJIA.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">900</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dji_cumpod</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'DJIA'</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"#a9a9a9"</span><span class="p">)))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">a2c_cumpod</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'A2C'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ppo_cumpod</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'PPO'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">traceorder</span><span class="o">=</span><span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="s2">"sans-serif"</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span>
        <span class="p">),</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">"White"</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span> <span class="s2">"Cumulative Return of A2C &amp; PPO against DJIA"</span><span class="p">,</span>
        <span class="s1">'y'</span><span class="p">:</span> <span class="mf">0.92</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span> <span class="mf">0.48</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
        <span class="s1">'yanchor'</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Cumulative Return"</span><span class="p">),</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="c1"># fig.update_layout(font_size = 20)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zerolinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">'Grey'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="ea10651f-6899-45a6-bc83-326c0f3a4d72" class="plotly-graph-div" style="height:900px; width:900px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("ea10651f-6899-45a6-bc83-326c0f3a4d72")) {
                    Plotly.newPlot(
                        'ea10651f-6899-45a6-bc83-326c0f3a4d72',
                        [{"line": {"color": "#a9a9a9", "width": 2}, "mode": "lines", "name": "DJIA", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31"], "y": [null, 0.0035900049368924325, 0.021451689225469472, 0.006031053470604952, 0.01291272477375105, -0.0011222417817438046, 0.013224420655107982, 0.013632425782493796, 0.035267929817957455, 0.044108420380372326, 0.03884753730275681, 0.03640876558337114, 0.036755372617740756, 0.04295437909186228, 0.049382964343949176, 0.03564641225290388, 0.028557247270763586, 0.03302116944014255, 0.025036305701787942, 0.031264834868348634, 0.022486121868004583, 0.02694192339961754, 0.03611543600425149, 0.04249081969489921, 0.05698661347016465, 0.06419318617776382, 0.06600006602761543, 0.07990950421988563, 0.07584774335445332, 0.08711372421934693, 0.08400048420251371, 0.08533325541568781, 0.08198724908083133, 0.07939001108429133, 0.07607975073436779, 0.07790021557637017, 0.08530646490044091, 0.0999997343716621, 0.09766744166896602, 0.10091129493435425, 0.10714210091524179, 0.11342147893510401, 0.10472442767528567, 0.11310249724790111, 0.13077649614212827, 0.0993884856186924, 0.09319380509179198, 0.06861946501693783, 0.08570050556662157, 0.0699285573611117, 0.07502125975377805, 0.08775449566475624, 0.08784268427301933, 0.08927191651984412, 0.08420486623526124, 0.07470182270370973, 0.05489528361706886, 0.06035402185969452, 0.039951868145128966, 0.04198445618859026, 0.055915751798398805, 0.07185125116639313, 0.06674534325063086, 0.0795310217849392, 0.08089885593874802, 0.0756884422453794, 0.09378949561352767, 0.07918365581246056, 0.09980544621576404, 0.10454797456494846, 0.11081923194704446, 0.1205576980800005, 0.1144295005314464, 0.10798649545528893, 0.1072170840004083, 0.11157346463974527, 0.09560722827833734, 0.10001248453189238, 0.0962056509772653, 0.10214464525525124, 0.10105314046692104, 0.07578831850052015, 0.06715448678517966, 0.030502405644070807, 0.03590983967052974, 0.029789383290687255, 0.04624369274997808, 0.0678088432227395, 0.08209410756657487, 0.10317513141962009, 0.10058024613121797, 0.13300967152779153, 0.14322725528894464, 0.1423222974878009, 0.12998651746449386, 0.1455156054751312, 0.16380312993665513, 0.15731041441435978, 0.14390726383458796, 0.14564849553801307, 0.13710953108629464, 0.14984663758162853, 0.16752572136118582, 0.1607734490056203, 0.16224609251227862, 0.15168736607114064, 0.158886880654326, 0.16121325363977235, 0.16454453657531465, 0.1742099928621872, 0.16844077303917926, 0.17248553369097053, 0.16840275023991946, 0.16570017163385353, 0.16753073035270516, 0.16034912670889145, 0.1734736711088578, 0.17173395728165053, 0.17751714156586385, 0.17268642460841632, 0.17413963929948495, 0.16633160814052195, 0.17077382467998437, 0.17349537673877458, 0.18142627997758098, 0.1787722734104895, 0.18164348806437003, 0.18929532976050556, 0.17442879471900485, 0.18094556857935506, 0.197957469867311, 0.20618481433148372, 0.2083934760162276, 0.2049242181324733, 0.2072556760032498, 0.20693631484699226, 0.20425703564087194, 0.1973691410452323, 0.20188672013891606, 0.21190660052268084, 0.21142588912445515, 0.2044692347361421, 0.2030322613206057, 0.20214005367969268, 0.17750940039715246, 0.18917405145069144, 0.16505355636500552, 0.17396326208295898, 0.19244279788605412, 0.19384630213098464, 0.20675712955946324, 0.21034683092111206, 0.21957627726437767, 0.21919043312977404, 0.2215984678557461, 0.22132251795932234, 0.22239891987928395, 0.2248993932669292, 0.22840705341899747, 0.22375658426243206, 0.22379468295550264, 0.22485818292761173, 0.22546669950338916, 0.24196214340818667, 0.2202077137710463, 0.20195859157783658, 0.2253952075335237, 0.2198000881127149, 0.2150816181015851, 0.20163885095252465, 0.22387163927975307, 0.23576746288128625, 0.2369448794635527, 0.2549856731458482, 0.2623130688003963, 0.27370032797510424, 0.2804934312009326, 0.2755386278626675, 0.2828991132187668, 0.27695116347109483, 0.26784565172102526, 0.27185686730839964, 0.2598868195598085, 0.2597667555509684, 0.26751574132505307, 0.2851337305868378, 0.2889609036827854, 0.2849037723398178, 0.2815849359892628, 0.288255243029059, 0.30278723815212283, 0.2990198693791626, 0.299642502203767, 0.30186937840312633, 0.3134113091644435, 0.31126624649323187, 0.30861891858149937, 0.310702507265884, 0.32255787946620873, 0.32895709381347826, 0.32417593551454704, 0.314215631772337, 0.3264949468003362, 0.31400570949139395, 0.3228493117000557, 0.3204433261069779, 0.3205738634617219, 0.3141798098935933, 0.32350488243858977, 0.31629648827952916, 0.3255593278995894, 0.32632873935447004, 0.33010992080101365, 0.3424740851095964, 0.351381438119412, 0.3500236978424527, 0.3316183861864157, 0.3051369105375141, 0.3219929259378862, 0.33600808420873673, 0.3338965666019418, 0.32351657008546764, 0.31711978434014676, 0.324429269055323, 0.3292356240994725, 0.3364686078532637, 0.3333009519740169, 0.333712448216704, 0.33921429414391957, 0.3417326025771259, 0.34351458925700307, 0.3444887622136854, 0.3435818311734584, 0.3505510080405694, 0.345649026794689, 0.34446705658376864, 0.33853428559827603, 0.33927637528123333, 0.33979564073539503, 0.336459652383577, 0.3327906419895401, 0.32246786940648287, 0.3142991149643233, 0.2935735777215227, 0.3163787571705412, 0.3190447549597544, 0.31627265762290624, 0.32880743121838685, 0.3380174487460623, 0.33216664307633925, 0.3325171206950648, 0.34068587513722437, 0.3457769837598619, 0.351715219099739, 0.3435947331213103, 0.3476521680395215, 0.3375546482872085, 0.35497182252535775, 0.359868642992097, 0.3556956976936996, 0.3574225854668651, 0.3595127010189869, 0.3478877424285476, 0.3196843879979996, 0.34105411190769974, 0.35216784978793236, 0.3531529514533842, 0.3624088088428421, 0.365624581398198, 0.3622910216483288, 0.3573331825576278, 0.36330177542186415, 0.3575095597741542, 0.3537283783276106, 0.3645400588404708, 0.351960811471804, 0.36251369408950285, 0.3681193627500263, 0.36397480173690466, 0.3703016133885779, 0.3788618281073477, 0.37944013894638795, 0.38004349474302446, 0.3843185931108901, 0.3733561874895872, 0.3584896524480867, 0.3559028877974506, 0.3646830427802019, 0.37306202307854797, 0.3742491540686095, 0.37577386072954355, 0.368298472143745, 0.377728429935402, 0.375553920465562, 0.37403422279614706]}, {"line": {"width": 2}, "mode": "lines", "name": "A2C", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31"], "y": [0.0, 0.004880254219416402, 0.018326370427250493, 0.002557810896997914, 0.010446631001628015, -0.0032188574311230456, 0.008562924218313395, -0.003765727748394676, 0.010147499617677802, 0.03007489390052287, 0.026177200819992752, 0.028084967512143733, 0.027188853350785802, 0.036114012333210876, 0.043057867614376244, 0.03902280060581709, 0.028622053443310813, 0.034910406578945175, 0.024855365627480808, 0.042662102454037676, 0.037628608363968086, 0.03490672535151251, 0.04543523253021653, 0.04929467490552675, 0.060428103063378646, 0.06131086707850231, 0.06736152316269495, 0.07503555998509914, 0.07361280443042983, 0.08171899794250437, 0.07606755613538585, 0.07742085402374976, 0.08002040431399426, 0.0759412357229825, 0.074028798512497, 0.07013656941158453, 0.06969234538171487, 0.08159673486161911, 0.08226571335579225, 0.08414296367503549, 0.08612632226358019, 0.0934109035489179, 0.08577084777201094, 0.09382842109066636, 0.10731176954749078, 0.07440811555203797, 0.06700807466059433, 0.04355862362656504, 0.06486164557574559, 0.05031004757971913, 0.05159253997765423, 0.07369254449310936, 0.07616745143722237, 0.07572377598742985, 0.06819091035681368, 0.05912479703295359, 0.04220217978965124, 0.05114104504213146, 0.027629995741650815, 0.028093926094431065, 0.044181421786845476, 0.06161324477923369, 0.05775973891633779, 0.06523580173059584, 0.07615286600242932, 0.07287706851390818, 0.0958909470745477, 0.0867369929766677, 0.1066730241825915, 0.11697621061460728, 0.12373416391800807, 0.13455559047935162, 0.12988969270802464, 0.12284912732347664, 0.12548596524615108, 0.1261559635293359, 0.11014582663202743, 0.11363945086100391, 0.1065992627548682, 0.11583289746036529, 0.12175533114764048, 0.10003990508577876, 0.09166709550680285, 0.060096413797860126, 0.07113162965255637, 0.0565784976948045, 0.07214528510227303, 0.09509614252678045, 0.1170373791058199, 0.14206761868181017, 0.136853077619967, 0.15711552718885602, 0.1627903934682906, 0.16753359208831076, 0.15400061620082472, 0.17348949217896514, 0.19321504108680387, 0.18994483344136137, 0.17552775401722265, 0.179544129121324, 0.17956402848560216, 0.19550678981768477, 0.2127068913801604, 0.20796450698374702, 0.21084676382582512, 0.19775771900229766, 0.20946591468791476, 0.2095350072944111, 0.21456529735209884, 0.23181012293517034, 0.22936147650819438, 0.23522157870552296, 0.22867449301659626, 0.23392788462065028, 0.22790222128680937, 0.22858728058653832, 0.24807760552759106, 0.24783122800918989, 0.2561853509213079, 0.25345740523259863, 0.2506182341596326, 0.25238910287215544, 0.25873609900516636, 0.26104223437453666, 0.26276201877624805, 0.2540464948491852, 0.26142735160696073, 0.2650675369522153, 0.2490219743165536, 0.2615042752197967, 0.2857795197730557, 0.3070373954599872, 0.3086646001172044, 0.3092093272487375, 0.3185068985920507, 0.31506242183126254, 0.32308902793184124, 0.31269062095786304, 0.3263570024499127, 0.3373342411651805, 0.33340285756564203, 0.3335930501098525, 0.3325476139451833, 0.3206597254127437, 0.2832474961710165, 0.2972922863498908, 0.27261950658194967, 0.2991245385909531, 0.3197414085510055, 0.32489369251702893, 0.3405870906191131, 0.34994867088218196, 0.36743485763642103, 0.3705969085735068, 0.367440806803917, 0.37122390934462723, 0.37578163868346515, 0.373431050290455, 0.36942428399596294, 0.3566335841074977, 0.36916121595766405, 0.36291089029721557, 0.3633660239037446, 0.3806204062379046, 0.34430866947128513, 0.34322625022366293, 0.38105313399356366, 0.36756227031087674, 0.3518265323121408, 0.32555384443692925, 0.35043733374819963, 0.3414524453379866, 0.3619832060893573, 0.37623062159508125, 0.3988447075121462, 0.40331557350357716, 0.413488551778747, 0.40425465892252155, 0.40862803742231035, 0.39145984462016115, 0.3948410165015832, 0.3970033719153594, 0.3707282747592735, 0.35334105909786784, 0.3669386075439782, 0.39188366824738385, 0.3777339742902195, 0.38431969401903676, 0.386854999315311, 0.40530359427652707, 0.4201867991519821, 0.41812301208286273, 0.4096600412473157, 0.41495942480233405, 0.4224883463609286, 0.4226826408818316, 0.41947930408668443, 0.42352541709472735, 0.43413768268543484, 0.44149774836910183, 0.43145759784100624, 0.4157998758904975, 0.4332034744827753, 0.42538185329848566, 0.4430258455871967, 0.45050313103055273, 0.45183229132422253, 0.45174927595841674, 0.4598871029368683, 0.4444772029391917, 0.4500553327774566, 0.44006985676685617, 0.44185060445432134, 0.4494802041085846, 0.4659182179139265, 0.4510825873173361, 0.43730252264840774, 0.3986339452016734, 0.413201654933014, 0.43817293866435825, 0.4358845140572032, 0.42525414579654264, 0.4167983418885808, 0.43133229154809327, 0.43231762757709324, 0.44344433264186023, 0.43846330504331155, 0.44944683532023966, 0.45533311662070997, 0.4560348541374921, 0.462638913448276, 0.4598714095040828, 0.4534486577665533, 0.463278903267458, 0.4659378153003155, 0.4720266499113408, 0.4661660753594896, 0.4661630368140852, 0.4750028796982009, 0.468993022071414, 0.46697452584777244, 0.4583479557422483, 0.4459527415579272, 0.4253943421128068, 0.4451482533634248, 0.4497689852784543, 0.44838036693795535, 0.4606108815735914, 0.46752207969116966, 0.4642132099866887, 0.46021963992328363, 0.4611167501757296, 0.46998486705056197, 0.4710162571468637, 0.45922242706887806, 0.45954787465500635, 0.4434253133414887, 0.46692674416682856, 0.47163932921786267, 0.4558959141485417, 0.447703316821046, 0.4413218046681737, 0.42801976486535565, 0.40730353433790767, 0.4363821614767456, 0.45317019199037456, 0.448990617728418, 0.4627273340432214, 0.46414006359211823, 0.4576133669564617, 0.4661865725084797, 0.47760979661199365, 0.47148171416303564, 0.46783803294669823, 0.47884086538182213, 0.4710754594775435, 0.48384926605928125, 0.48798614613926006, 0.48555962356190174, 0.48995896140770645, 0.49717770537834394, 0.4978075485202351, 0.4968761237474604, 0.49495210643628473, 0.4821499637225577, 0.47036843683178353, 0.4641635353608715, 0.4831936571700992, 0.49880947810292064, 0.5085569474042573, 0.5161588181691279, 0.5060957154935983, 0.5251497600230401, 0.5239352793150511, 0.5245833364461128]}, {"line": {"width": 2}, "mode": "lines", "name": "PPO", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30", "2021-07-01", "2021-07-02", "2021-07-06", "2021-07-07", "2021-07-08", "2021-07-09", "2021-07-12", "2021-07-13", "2021-07-14", "2021-07-15", "2021-07-16", "2021-07-19", "2021-07-20", "2021-07-21", "2021-07-22", "2021-07-23", "2021-07-26", "2021-07-27", "2021-07-28", "2021-07-29", "2021-07-30", "2021-08-02", "2021-08-03", "2021-08-04", "2021-08-05", "2021-08-06", "2021-08-09", "2021-08-10", "2021-08-11", "2021-08-12", "2021-08-13", "2021-08-16", "2021-08-17", "2021-08-18", "2021-08-19", "2021-08-20", "2021-08-23", "2021-08-24", "2021-08-25", "2021-08-26", "2021-08-27", "2021-08-30", "2021-08-31"], "y": [0.0, 0.005276960729276636, 0.018849175737329915, 0.0032947681286743524, 0.014273251783483376, 0.004762891300326144, 0.015270606436321943, 0.007053279926696465, 0.021239570123745777, 0.04140021959965745, 0.03651668641206007, 0.040563158791203646, 0.04589704743742806, 0.04759566296051276, 0.055080581984604304, 0.05270809152218736, 0.04284203069986536, 0.05121139374919448, 0.0417643389078437, 0.05953105476817089, 0.05587802376471562, 0.05384914363618143, 0.06610580099515184, 0.06948761533567116, 0.08100724034136442, 0.08310122729941427, 0.08592496264323901, 0.09183641155925026, 0.08616459471609139, 0.09659430976551753, 0.09272225230995335, 0.09197840035917482, 0.09438701586394416, 0.09196550670340486, 0.08883309813784512, 0.08723658668258172, 0.08719161155896038, 0.09996446055455221, 0.10260899671826018, 0.10562766503353016, 0.10761436004874048, 0.11527294629241469, 0.10736016563613981, 0.11610287716749323, 0.1297444129647698, 0.09387077505957286, 0.08784430207726945, 0.06280477944879737, 0.08218369290590721, 0.06719798080667938, 0.06793618705982607, 0.09053077832619283, 0.09285376556546932, 0.09434156092669799, 0.08725394518020169, 0.07765799490142067, 0.05737142655561511, 0.0654090599055337, 0.04273120438156219, 0.042592664188195295, 0.05698735495072138, 0.07508288101875427, 0.07057695827102228, 0.07822110002815319, 0.08996178348035655, 0.08693207338635855, 0.11084766296849358, 0.10057161158290051, 0.12062989028683213, 0.13074467903430742, 0.13920034054959718, 0.15205802155044656, 0.14873425545481833, 0.14201955112458609, 0.14541259504136006, 0.14575485238475694, 0.12946771332847984, 0.13354680136351882, 0.126160981677242, 0.1332644437031063, 0.13961930411585444, 0.11833156295594316, 0.11375229836194678, 0.0805028871565292, 0.09208816807630327, 0.07720219164999209, 0.09554560586225436, 0.12134018261273427, 0.1441455987221636, 0.16958224182047021, 0.16421508482535496, 0.1800936285726089, 0.1796501701174642, 0.18912405977606705, 0.17507146923767647, 0.1941953211005074, 0.21139072007523163, 0.2085177258286275, 0.19492745919302212, 0.20087609918673843, 0.19920689342829, 0.2136269872112635, 0.22898833515146744, 0.22472363577540055, 0.22963190457101268, 0.21601286715843937, 0.22787383346280277, 0.22902665182672455, 0.23443280749437534, 0.25243672596382916, 0.25169986287986057, 0.25720709794977537, 0.24739369121899868, 0.2509631868860853, 0.24597659048102694, 0.24780509211808166, 0.2682653313798178, 0.2697108339586103, 0.2806931962601815, 0.2777467623809886, 0.2765950570753344, 0.2813854191668286, 0.2858311699573508, 0.28730884329153494, 0.28890103845031456, 0.2793726577209388, 0.28745618262769135, 0.28973767893989666, 0.2722262109272382, 0.2839248245729402, 0.3053377397386754, 0.32810569328371986, 0.32967054579951505, 0.3287575985490394, 0.3387724715207727, 0.33546511710357696, 0.34414879493106354, 0.3328707625509595, 0.3485687077326831, 0.36214492934379106, 0.35793830684440664, 0.3585853705385209, 0.35707952093026196, 0.34442562150930445, 0.3068419880198996, 0.32216016751111787, 0.296520271027088, 0.3232334515950197, 0.3446257686892551, 0.3497095796467542, 0.3650405728249244, 0.3740461294145099, 0.39312107010107966, 0.39603823696793383, 0.3929890579582487, 0.3988408071511731, 0.40403579235541165, 0.40012403414299746, 0.3944417425443605, 0.38271599883703367, 0.39458620693234847, 0.37821256759682953, 0.37933631566648685, 0.3964524147393298, 0.3575179320360584, 0.3535685027271036, 0.3925109819146084, 0.3764579958277905, 0.35586269540499305, 0.32728358157461335, 0.352922404260251, 0.34431983345800266, 0.3611027778410507, 0.3732079042796832, 0.39454065380649905, 0.39655584375989483, 0.4075028501129059, 0.3979656502398039, 0.4022981392044256, 0.3740475387914206, 0.3792393770849305, 0.37985675870643854, 0.35337943675890426, 0.3355836776944545, 0.3511172765740156, 0.3747703958839559, 0.3612687746324972, 0.37013491078756333, 0.3755260266317577, 0.39378701144596073, 0.40726919128612926, 0.4059561714390254, 0.3970270789186128, 0.40455325147879484, 0.4119762422428437, 0.4113394454132251, 0.4101032098891313, 0.41234937964646057, 0.4242942977454425, 0.4304693139711617, 0.41783614646971334, 0.40092552723181907, 0.4184574119913098, 0.41227502069322486, 0.4322517683187419, 0.4425606144938863, 0.44384353928838594, 0.4443191368404962, 0.4477288246083464, 0.4317849127481672, 0.4359841953502024, 0.42432793476499087, 0.42551179332387146, 0.42559585404297473, 0.4423110829707322, 0.42091585113809926, 0.40793216442163827, 0.3709020017046887, 0.38705214608719984, 0.41191595232279, 0.41036384490805, 0.4013643583152877, 0.39377243906684645, 0.4072305964337961, 0.407883379613474, 0.4182528085220407, 0.4151489214305957, 0.4256842021230147, 0.43317129398686416, 0.4338105353863888, 0.43972932437569656, 0.4372572283005083, 0.428365613230254, 0.43921572001618303, 0.4437694831056853, 0.44963839351855817, 0.44435982770962834, 0.4458770045783804, 0.45345684545087095, 0.4506180865389593, 0.44571535186397426, 0.43915364219923547, 0.4304248242440041, 0.4083387120480848, 0.43292834655290235, 0.4368377345126482, 0.43670938499376954, 0.45044347842011123, 0.45813801089708384, 0.4549317024176558, 0.45267847951463125, 0.4524260440206007, 0.46029087830670323, 0.46013159263162917, 0.44881378207248623, 0.4489404714364824, 0.43333924708317473, 0.4552456767507467, 0.45989368606386316, 0.44697577071303174, 0.43610603228825595, 0.4297293662240895, 0.4171287853315082, 0.3957694048194722, 0.4247372517434771, 0.4422574476561003, 0.43775413039077793, 0.45064482791710536, 0.45143214074336147, 0.44225322690167457, 0.45362829644927816, 0.46317491126377264, 0.455333758818401, 0.45282780536380396, 0.4622711475580128, 0.4547239867909634, 0.46721568180107, 0.47066320770930736, 0.4670818881305365, 0.4725869146307806, 0.47887893922087543, 0.4805595937024918, 0.47969329310389397, 0.4763347962482145, 0.46282713284593946, 0.45083625504692204, 0.44557708618301817, 0.4649203144470824, 0.4790061333431439, 0.48973870214342585, 0.4976506605359512, 0.48725929848507454, 0.5076365671421377, 0.5076260915804867, 0.5074882263027465]}],
                        {"font": {"size": 15}, "height": 900, "legend": {"bgcolor": "White", "bordercolor": "white", "borderwidth": 2, "font": {"color": "black", "family": "sans-serif", "size": 16}, "traceorder": "normal", "x": 0, "y": 1}, "paper_bgcolor": "rgba(1, 1, 0, 0)", "plot_bgcolor": "rgba(1, 1, 0, 0)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "Cumulative Return of A2C & PPO against DJIA", "x": 0.48, "xanchor": "center", "y": 0.92, "yanchor": "top"}, "width": 900, "xaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Date"}}, "yaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Cumulative Return"}, "zeroline": true, "zerolinecolor": "Grey", "zerolinewidth": 1}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('ea10651f-6899-45a6-bc83-326c0f3a4d72');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

</div>


</body>
  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="LearnableLoopAI/portfolio2"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/19/PortfolioManagement_FidelityFunds.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Portfolio of Data Science Projects</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/LearnableLoopAI" target="_blank" title="LearnableLoopAI"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
