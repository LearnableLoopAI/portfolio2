<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Portfolio Management with Deep Reinforcement Learning | Kobus Esterhuysen — MS(Data Science), MBA, MSEE, BSc, DipData</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Portfolio Management with Deep Reinforcement Learning" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="DRL is used to provide dynamic asset allocation for a portfolio" />
<meta property="og:description" content="DRL is used to provide dynamic asset allocation for a portfolio" />
<link rel="canonical" href="https://www.learnableloop.ai/portfolio2/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/11/PortfolioManagement.html" />
<meta property="og:url" content="https://www.learnableloop.ai/portfolio2/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/11/PortfolioManagement.html" />
<meta property="og:site_name" content="Kobus Esterhuysen — MS(Data Science), MBA, MSEE, BSc, DipData" />
<meta property="og:image" content="https://www.learnableloop.ai/portfolio2/images/PortfolioManagement.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-11T00:00:00-06:00" />
<script type="application/ld+json">
{"datePublished":"2021-11-11T00:00:00-06:00","url":"https://www.learnableloop.ai/portfolio2/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/11/PortfolioManagement.html","@type":"BlogPosting","image":"https://www.learnableloop.ai/portfolio2/images/PortfolioManagement.png","headline":"Portfolio Management with Deep Reinforcement Learning","dateModified":"2021-11-11T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.learnableloop.ai/portfolio2/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/11/PortfolioManagement.html"},"description":"DRL is used to provide dynamic asset allocation for a portfolio","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/portfolio2/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://www.learnableloop.ai/portfolio2/feed.xml" title="Kobus Esterhuysen --- MS(Data Science), MBA, MSEE, BSc, DipData" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7YVR807GNV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7YVR807GNV');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/portfolio2/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/portfolio2/">Kobus Esterhuysen --- MS(Data Science), MBA, MSEE, BSc, DipData</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/portfolio2/about/">About Me</a><a class="page-link" href="/portfolio2/search/">Search</a><a class="page-link" href="/portfolio2/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Portfolio Management with Deep Reinforcement Learning</h1><p class="page-description">DRL is used to provide dynamic asset allocation for a portfolio</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-11-11T00:00:00-06:00" itemprop="datePublished">
        Nov 11, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      53 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/portfolio2/categories/#Investment_Industry">Investment_Industry</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio2/categories/#Reinforcement_Learning">Reinforcement_Learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio2/categories/#A2C">A2C</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio2/categories/#PPO">PPO</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio2/categories/#OpenAI">OpenAI</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio2/categories/#Gym">Gym</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio2/categories/#finrl">finrl</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio2/categories/#stable_baselines3">stable_baselines3</a>
        &nbsp;
      
        <a class="category-tags-link" href="/portfolio2/categories/#pyfolio">pyfolio</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#1.-Problem:-Dynamic-Asset-Allocation">1. Problem: Dynamic Asset Allocation </a></li>
<li class="toc-entry toc-h2"><a href="#2.-Solution-Proposal">2. Solution Proposal </a></li>
<li class="toc-entry toc-h2"><a href="#3.-Implementation-of-the-Solution">3. Implementation of the Solution </a>
<ul>
<li class="toc-entry toc-h3"><a href="#3.0-PARAMETERS">3.0 PARAMETERS </a></li>
<li class="toc-entry toc-h3"><a href="#3.1-Download-Data">3.1 Download Data </a></li>
<li class="toc-entry toc-h3"><a href="#3.2-Data-Understanding-and-Preparation">3.2 Data Understanding and Preparation </a>
<ul>
<li class="toc-entry toc-h4"><a href="#3.2.1-Add-technical-indicators">3.2.1 Add technical indicators </a></li>
<li class="toc-entry toc-h4"><a href="#3.2.2-Add-covariance-matrix-as-a-feature">3.2.2 Add covariance matrix as a feature </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#3.3-Modeling">3.3 Modeling </a>
<ul>
<li class="toc-entry toc-h4"><a href="#3.3.1-Training-data">3.3.1 Training data </a></li>
<li class="toc-entry toc-h4"><a href="#3.3.2-Portfolio-(Environment)">3.3.2 Portfolio (Environment) </a></li>
<li class="toc-entry toc-h4"><a href="#3.3.3-Portfolio-Manager-(Agent)">3.3.3 Portfolio Manager (Agent) </a>
<ul>
<li class="toc-entry toc-h5"><a href="#3.3.3.1-A2C">3.3.3.1 A2C </a></li>
<li class="toc-entry toc-h5"><a href="#3.3.3.2-PPO">3.3.3.2 PPO </a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#3.4-Evaluation">3.4 Evaluation </a>
<ul>
<li class="toc-entry toc-h4"><a href="#3.4.1-Inspect-actions">3.4.1 Inspect actions </a></li>
<li class="toc-entry toc-h4"><a href="#3.4.2-Inspect-daily-return">3.4.2 Inspect daily return </a></li>
<li class="toc-entry toc-h4"><a href="#3.4.3-Inspect-cumulative-return">3.4.3 Inspect cumulative return </a></li>
</ul>
</li>
</ul>
</li>
</ul><body>
<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-11-11-PortfolioManagement.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-Problem:-Dynamic-Asset-Allocation">
<a class="anchor" href="#1.-Problem:-Dynamic-Asset-Allocation" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Problem: Dynamic Asset Allocation<a class="anchor-link" href="#1.-Problem:-Dynamic-Asset-Allocation"> </a>
</h2>
<p><em>Asset allocation</em> refers to the partitioning of available funds in a portfolio among various investment products. Investment products may be categorized in multiple ways. One common (and high level) classification contains three classes:</p>
<ul>
<li>Stocks</li>
<li>Bonds (fixed income)</li>
<li>Cash and cash equivalents</li>
</ul>
<p>Other classification systems may sub-classify each of these categories into subclasses, for example stocks into US and International stocks, or into small-cap, medium-cap, and large-cap stocks, etc.</p>
<p>Another aspect of asset allocation is concerns the underlying <em>strategy</em>. Some strategies are:</p>
<ul>
<li>Tactical asset allocation</li>
<li>Strategic asset allocation</li>
<li>Constant weight asset allocation</li>
<li>Integrated asset allocation</li>
<li>Insured asset allocation</li>
<li>Dynamic asset allocation</li>
</ul>
<p>We will focus on the last of these strategies: Dynamic asset allocation. With this approach the combination of assets are adjusted at regular intervals to capitalize on the strengthening and weakening of the economy and rise and fall of markets. This strategy depends on the decisions of a portfolio manager. In this project, however, we will attempt to replace the portfolio manager with an <em>AI agent</em>. The agent will be trained on past market behavior by means of <em>Deep Reinforcement Learning</em>.</p>
<p>For this Proof-Of-Concept (POC) project we will make things as simple as possible. The portfolio will consist of the 30 investment products in the Dow-Jones (DJIA). The fixed allocation in the DJIA also provides a handy reference against which the performance of our agent's dynamic behavior can be juxtaposed. Our agent will have the opportunity to adjust the mix of stocks on a daily basis. In practice, a 401K agent, for example, might be setup to make monthly adjustments to reduce transation costs or to avoid constraints related to trading. For simplicity, trading costs will not be taken into account for now.</p>
<p>Our agent will have $ 1,000,000 when the project starts.</p>
<p>To implement this POC we will make use of the FinRL framework as well as some Yahoo technology to acquire financial data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Solution-Proposal">
<a class="anchor" href="#2.-Solution-Proposal" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Solution Proposal<a class="anchor-link" href="#2.-Solution-Proposal"> </a>
</h2>
<p>Investment decisions are sequential by nature. Furthermore, an optimal decision in the present may turn out not to be optimal over the longer term. Then there are the complexities of the investment landscape like varying market conditions, political disruptive event, and other economic uncertainties. The ideal tool for this kind of problem is <strong>Reinforcement Learning</strong>.</p>
<p>The solution requires the setup of a <strong>digital twin</strong> for the investor's portfolio. In RL parlance this model of the portfolio is called an <strong>environment</strong>. The environment contains <strong>states</strong> which are modified by applying <strong>actions</strong> to it.</p>
<p>We will choose the following <strong>states</strong> (measured daily in our case) for the environment:</p>
<p>s1 = Value of AAPL holdings</p>
<p>s2 = Value of AMGN holdings</p>
<p>s3 = Value of AXP holdings</p>
<p>...</p>
<p>s29 = Value of WBA holdings</p>
<p>s30 = Value of WMT holdings</p>
<p>The following <strong>actions</strong> (applied daily in our case) will be setup to influence the environment/portfolio:</p>
<p>a1 = Fraction to be invested in AAPL this cycle}</p>
<p>a2 = Fraction to be invested in AMGN this cycle}</p>
<p>a3 = Fraction to be invested in AXP this cycle}</p>
<p>...</p>
<p>a29 = Fraction to be invested in WBA this cycle}</p>
<p>a30 = Fraction to be invested in WMT this cycle}</p>
<p>All action values are in the [0, 1] interval.</p>
<p>The <em>reward</em> <em>r</em> is given by</p>
<p>r(s,a,s') = log(v'/v)</p>
<p>where <em>v</em> and <em>v'</em> are the portfolio value at states $s'$ and $s$ respectively.</p>
<p>The model of the portfolio/environment will have the following <strong>parameters</strong>:</p>
<p>p1=Initial Amount</p>
<p>p2=Transaction Cost Pct</p>
<p>p3=Size of State and Action Spaces</p>
<p>p4=Reward Scaling</p>
<p>p5=Technical Indicator List</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-Implementation-of-the-Solution">
<a class="anchor" href="#3.-Implementation-of-the-Solution" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Implementation of the Solution<a class="anchor-link" href="#3.-Implementation-of-the-Solution"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To implement the <em>environment</em> we use the OpenAI Gym tools. We will use the FinRL python library to implement the <em>agent</em>. For a function approximator for the agent, two algorithms will be investigated:</p>
<ul>
<li>Advantage Actor-Critic (A2C)</li>
<li>Proximal Policy Optimization (PPO)</li>
</ul>
<p>This implementation allows the agent to allocate the investor's funds between the 30 DJIA  instruments. The goal is to maximize net worth at the end of the investment horizon.</p>
<p>The plotly library will be used for visualization. The code will run on the Google Colab platform. To start with, we install the python packages needed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import the packages needed:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">'Agg'</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">datetime</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">finrl.apps</span> <span class="kn">import</span> <span class="n">config</span>
<span class="kn">from</span> <span class="nn">finrl.neo_finrl.preprocessor.yahoodownloader</span> <span class="kn">import</span> <span class="n">YahooDownloader</span>
<span class="kn">from</span> <span class="nn">finrl.neo_finrl.preprocessor.preprocessors</span> <span class="kn">import</span> <span class="n">FeatureEngineer</span><span class="p">,</span> <span class="n">data_split</span>
<span class="kn">from</span> <span class="nn">finrl.neo_finrl.env_portfolio_allocation.env_portfolio</span> <span class="kn">import</span> <span class="n">StockPortfolioEnv</span>
<span class="kn">from</span> <span class="nn">finrl.drl_agents.stablebaselines3.models</span> <span class="kn">import</span> <span class="n">DRLAgent</span>
<span class="kn">from</span> <span class="nn">finrl.plot</span> <span class="kn">import</span> <span class="n">backtest_stats</span><span class="p">,</span> <span class="n">backtest_plot</span><span class="p">,</span> <span class="n">get_daily_return</span><span class="p">,</span> <span class="n">get_baseline</span><span class="p">,</span><span class="n">convert_daily_return_to_pyfolio_ts</span>

<span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">from</span> <span class="nn">gym.utils</span> <span class="kn">import</span> <span class="n">seeding</span>
<span class="kn">from</span> <span class="nn">gym</span> <span class="kn">import</span> <span class="n">spaces</span>
<span class="kn">from</span> <span class="nn">stable_baselines3.common.vec_env</span> <span class="kn">import</span> <span class="n">DummyVecEnv</span>

<span class="kn">from</span> <span class="nn">pyfolio</span> <span class="kn">import</span> <span class="n">timeseries</span>
<span class="kn">import</span> <span class="nn">plotly</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/pyfolio/pos.py:27: UserWarning: Module "zipline.assets" not found; multipliers will not be applied to position notionals.
  'Module "zipline.assets" not found; multipliers will not be applied'
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"../FinRL-Library"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Setup some directories:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">DATA_SAVE_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">DATA_SAVE_DIR</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TRAINED_MODEL_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TRAINED_MODEL_DIR</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TENSORBOARD_LOG_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">TENSORBOARD_LOG_DIR</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">RESULTS_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"./"</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">RESULTS_DIR</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.0-PARAMETERS">
<a class="anchor" href="#3.0-PARAMETERS" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.0 PARAMETERS<a class="anchor-link" href="#3.0-PARAMETERS"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DATA_START</span> <span class="o">=</span> <span class="s1">'2008-01-01'</span> 
<span class="n">TRAIN_START</span> <span class="o">=</span> <span class="s1">'2009-01-01'</span>
<span class="n">TRADE_START</span> <span class="o">=</span> <span class="s1">'2020-07-01'</span>
<span class="c1"># DATA_END = '2021-09-02'</span>
<span class="n">DATA_END</span> <span class="o">=</span> <span class="s1">'2021-07-01'</span>
<span class="n">LOOKBACK</span> <span class="o">=</span> <span class="mi">252</span> <span class="c1">#trading days in one year</span>
<span class="n">INITIAL_AMOUNT</span> <span class="o">=</span> <span class="mi">1_000_000</span> <span class="c1">#dollars</span>
<span class="n">TRANSACTION_COST_PCT</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">REWARD_SCALING</span> <span class="o">=</span> <span class="mf">1e-1</span> <span class="c1">#scaling factor applied to the reward signal</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.1-Download-Data">
<a class="anchor" href="#3.1-Download-Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.1 Download Data<a class="anchor-link" href="#3.1-Download-Data"> </a>
</h3>
<p>We use the data from Yahoo Finance.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">YahooDownloader</span><span class="p">(</span><span class="n">start_date</span> <span class="o">=</span> <span class="n">DATA_START</span><span class="p">,</span>
                     <span class="n">end_date</span> <span class="o">=</span> <span class="n">DATA_END</span><span class="p">,</span>
                     <span class="n">ticker_list</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">DOW_30_TICKER</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
Shape of DataFrame:  (99065, 8)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>7.116786</td>
      <td>7.152143</td>
      <td>6.876786</td>
      <td>5.966037</td>
      <td>1079178800</td>
      <td>AAPL</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-01-02</td>
      <td>46.599998</td>
      <td>47.040001</td>
      <td>46.259998</td>
      <td>36.337452</td>
      <td>7934400</td>
      <td>AMGN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-01-02</td>
      <td>52.090000</td>
      <td>52.320000</td>
      <td>50.790001</td>
      <td>40.694553</td>
      <td>8053700</td>
      <td>AXP</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-01-02</td>
      <td>87.570000</td>
      <td>87.839996</td>
      <td>86.000000</td>
      <td>63.481598</td>
      <td>4303000</td>
      <td>BA</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-01-02</td>
      <td>72.559998</td>
      <td>72.669998</td>
      <td>70.050003</td>
      <td>47.633072</td>
      <td>6337800</td>
      <td>CAT</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99060</th>
      <td>2021-06-30</td>
      <td>397.540009</td>
      <td>401.399994</td>
      <td>396.799988</td>
      <td>399.039337</td>
      <td>2875600</td>
      <td>UNH</td>
      <td>2</td>
    </tr>
    <tr>
      <th>99061</th>
      <td>2021-06-30</td>
      <td>235.110001</td>
      <td>236.399994</td>
      <td>233.820007</td>
      <td>233.091354</td>
      <td>7797100</td>
      <td>V</td>
      <td>2</td>
    </tr>
    <tr>
      <th>99062</th>
      <td>2021-06-30</td>
      <td>55.759998</td>
      <td>56.139999</td>
      <td>55.759998</td>
      <td>54.757252</td>
      <td>14559700</td>
      <td>VZ</td>
      <td>2</td>
    </tr>
    <tr>
      <th>99063</th>
      <td>2021-06-30</td>
      <td>52.060001</td>
      <td>52.810001</td>
      <td>51.869999</td>
      <td>52.096992</td>
      <td>4398600</td>
      <td>WBA</td>
      <td>2</td>
    </tr>
    <tr>
      <th>99064</th>
      <td>2021-06-30</td>
      <td>139.559998</td>
      <td>142.580002</td>
      <td>138.690002</td>
      <td>140.502975</td>
      <td>15170400</td>
      <td>WMT</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>99065 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Verify 30 unique tickers</span>
<span class="c1"># https://www.investopedia.com/ask/answers/who-or-what-is-dow-jones/</span>
<span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'tic'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">),</span> <span class="n">lst</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>30 ['AAPL', 'AMGN', 'AXP', 'BA', 'CAT', 'CRM', 'CSCO', 'CVX', 'DIS', 'GS', 'HD', 'HON', 'IBM', 'INTC', 'JNJ', 'JPM', 'KO', 'MCD', 'MMM', 'MRK', 'MSFT', 'NKE', 'PG', 'TRV', 'UNH', 'VZ', 'WBA', 'WMT', 'V', 'DOW']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.2-Data-Understanding-and-Preparation">
<a class="anchor" href="#3.2-Data-Understanding-and-Preparation" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2 Data Understanding and Preparation<a class="anchor-link" href="#3.2-Data-Understanding-and-Preparation"> </a>
</h3>
<p>We will keep showing snippets of the data set as it evolves to assist with understanding. There is a need to check for missing data and also to do some feature engineering. We rely on the FeatureEngineer class to take care of these needs. Some indicators used are:</p>
<ul>
<li>Moving Average Convergence Divergence (MACD)</li>
</ul>
<p>The MACD is primarily used to gauge the strength of stock price movement. It does this by measuring the divergence of two exponential moving averages (EMAs), commonly a 12-period EMA and a 26-period EMA.</p>
<ul>
<li>Relative Strength Index (RSI)</li>
</ul>
<p>The RSI aims to indicate whether a market is considered to be overbought or oversold in relation to recent price levels.</p>
<ul>
<li>Commodity Channel Index (CCI)</li>
</ul>
<p>The Commodity Channel Index​ (CCI) is a momentum-based oscillator used to help determine when an investment vehicle is reaching a condition of being overbought or oversold.</p>
<p>FinRL also uses the financial turbulence index that measures extreme asset price fluctuation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.2.1-Add-technical-indicators">
<a class="anchor" href="#3.2.1-Add-technical-indicators" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2.1 Add technical indicators<a class="anchor-link" href="#3.2.1-Add-technical-indicators"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">fe</span> <span class="o">=</span> <span class="n">FeatureEngineer</span><span class="p">(</span>
  <span class="n">use_technical_indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">use_turbulence</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">user_defined_feature</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">preprocess_data</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Successfully added technical indicators
CPU times: user 58.7 s, sys: 5.93 s, total: 1min 4s
Wall time: 58.6 s
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>7.116786</td>
      <td>7.152143</td>
      <td>6.876786</td>
      <td>5.966037</td>
      <td>1079178800</td>
      <td>AAPL</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>5.966037</td>
      <td>5.966037</td>
    </tr>
    <tr>
      <th>3398</th>
      <td>2008-01-02</td>
      <td>46.599998</td>
      <td>47.040001</td>
      <td>46.259998</td>
      <td>36.337452</td>
      <td>7934400</td>
      <td>AMGN</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>36.337452</td>
      <td>36.337452</td>
    </tr>
    <tr>
      <th>6796</th>
      <td>2008-01-02</td>
      <td>52.090000</td>
      <td>52.320000</td>
      <td>50.790001</td>
      <td>40.694553</td>
      <td>8053700</td>
      <td>AXP</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>40.694553</td>
      <td>40.694553</td>
    </tr>
    <tr>
      <th>10194</th>
      <td>2008-01-02</td>
      <td>87.570000</td>
      <td>87.839996</td>
      <td>86.000000</td>
      <td>63.481598</td>
      <td>4303000</td>
      <td>BA</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>63.481598</td>
      <td>63.481598</td>
    </tr>
    <tr>
      <th>13592</th>
      <td>2008-01-02</td>
      <td>72.559998</td>
      <td>72.669998</td>
      <td>70.050003</td>
      <td>47.633072</td>
      <td>6337800</td>
      <td>CAT</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>47.633072</td>
      <td>47.633072</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>81551</th>
      <td>2021-06-30</td>
      <td>149.139999</td>
      <td>150.169998</td>
      <td>148.899994</td>
      <td>148.880066</td>
      <td>996900</td>
      <td>TRV</td>
      <td>2</td>
      <td>-1.862937</td>
      <td>159.502541</td>
      <td>143.358709</td>
      <td>46.456282</td>
      <td>-85.980567</td>
      <td>23.655657</td>
      <td>153.281467</td>
      <td>153.841134</td>
    </tr>
    <tr>
      <th>84949</th>
      <td>2021-06-30</td>
      <td>397.540009</td>
      <td>401.399994</td>
      <td>396.799988</td>
      <td>399.039337</td>
      <td>2875600</td>
      <td>UNH</td>
      <td>2</td>
      <td>-0.570259</td>
      <td>405.003754</td>
      <td>390.157858</td>
      <td>53.742914</td>
      <td>-45.875840</td>
      <td>11.026717</td>
      <td>400.883542</td>
      <td>397.679197</td>
    </tr>
    <tr>
      <th>88347</th>
      <td>2021-06-30</td>
      <td>55.759998</td>
      <td>56.139999</td>
      <td>55.759998</td>
      <td>54.757252</td>
      <td>14559700</td>
      <td>VZ</td>
      <td>2</td>
      <td>-0.310560</td>
      <td>56.432618</td>
      <td>54.336725</td>
      <td>45.058622</td>
      <td>-125.801926</td>
      <td>30.282792</td>
      <td>55.369361</td>
      <td>56.008212</td>
    </tr>
    <tr>
      <th>91745</th>
      <td>2021-06-30</td>
      <td>52.060001</td>
      <td>52.810001</td>
      <td>51.869999</td>
      <td>52.096992</td>
      <td>4398600</td>
      <td>WBA</td>
      <td>2</td>
      <td>-0.448763</td>
      <td>55.401845</td>
      <td>50.030942</td>
      <td>49.582808</td>
      <td>-61.117999</td>
      <td>28.020745</td>
      <td>52.877045</td>
      <td>52.935166</td>
    </tr>
    <tr>
      <th>95143</th>
      <td>2021-06-30</td>
      <td>139.559998</td>
      <td>142.580002</td>
      <td>138.690002</td>
      <td>140.502975</td>
      <td>15170400</td>
      <td>WMT</td>
      <td>2</td>
      <td>-0.501083</td>
      <td>142.303471</td>
      <td>134.252829</td>
      <td>53.317367</td>
      <td>31.522244</td>
      <td>20.340870</td>
      <td>139.315001</td>
      <td>139.095497</td>
    </tr>
  </tbody>
</table>
<p>95144 rows × 16 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see that the FeatureEngineer has added some features:</p>
<ul>
<li>macd</li>
<li>boll_ub (upper Bollinger Band)</li>
<li>boll_lb (lower Bollinger Band)</li>
<li>rsi_30 (with a lookback of 30)</li>
<li>cci_30 (with a lookback of 30)</li>
<li>dx_30 (with a lookback of 30)</li>
<li>close_30_sma (close price simple moving average with a lookback of 30)</li>
<li>close_60_sma (close price simple moving average with a lookback of 60)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.2.2-Add-covariance-matrix-as-a-feature">
<a class="anchor" href="#3.2.2-Add-covariance-matrix-as-a-feature" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2.2 Add covariance matrix as a feature<a class="anchor-link" href="#3.2.2-Add-covariance-matrix-as-a-feature"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Adding the portfolio's covariance matrix as a feature has some advantages. It can be used to quantify the risk (standard deviation) associated with a portfolio.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'tic'</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>7.116786</td>
      <td>7.152143</td>
      <td>6.876786</td>
      <td>5.966037</td>
      <td>1079178800</td>
      <td>AAPL</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>5.966037</td>
      <td>5.966037</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-01-02</td>
      <td>46.599998</td>
      <td>47.040001</td>
      <td>46.259998</td>
      <td>36.337452</td>
      <td>7934400</td>
      <td>AMGN</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>36.337452</td>
      <td>36.337452</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-01-02</td>
      <td>52.090000</td>
      <td>52.320000</td>
      <td>50.790001</td>
      <td>40.694553</td>
      <td>8053700</td>
      <td>AXP</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>40.694553</td>
      <td>40.694553</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-01-02</td>
      <td>87.570000</td>
      <td>87.839996</td>
      <td>86.000000</td>
      <td>63.481598</td>
      <td>4303000</td>
      <td>BA</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>63.481598</td>
      <td>63.481598</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-01-02</td>
      <td>72.559998</td>
      <td>72.669998</td>
      <td>70.050003</td>
      <td>47.633072</td>
      <td>6337800</td>
      <td>CAT</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>47.633072</td>
      <td>47.633072</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95139</th>
      <td>2021-06-30</td>
      <td>149.139999</td>
      <td>150.169998</td>
      <td>148.899994</td>
      <td>148.880066</td>
      <td>996900</td>
      <td>TRV</td>
      <td>2</td>
      <td>-1.862937</td>
      <td>159.502541</td>
      <td>143.358709</td>
      <td>46.456282</td>
      <td>-85.980567</td>
      <td>23.655657</td>
      <td>153.281467</td>
      <td>153.841134</td>
    </tr>
    <tr>
      <th>95140</th>
      <td>2021-06-30</td>
      <td>397.540009</td>
      <td>401.399994</td>
      <td>396.799988</td>
      <td>399.039337</td>
      <td>2875600</td>
      <td>UNH</td>
      <td>2</td>
      <td>-0.570259</td>
      <td>405.003754</td>
      <td>390.157858</td>
      <td>53.742914</td>
      <td>-45.875840</td>
      <td>11.026717</td>
      <td>400.883542</td>
      <td>397.679197</td>
    </tr>
    <tr>
      <th>95141</th>
      <td>2021-06-30</td>
      <td>55.759998</td>
      <td>56.139999</td>
      <td>55.759998</td>
      <td>54.757252</td>
      <td>14559700</td>
      <td>VZ</td>
      <td>2</td>
      <td>-0.310560</td>
      <td>56.432618</td>
      <td>54.336725</td>
      <td>45.058622</td>
      <td>-125.801926</td>
      <td>30.282792</td>
      <td>55.369361</td>
      <td>56.008212</td>
    </tr>
    <tr>
      <th>95142</th>
      <td>2021-06-30</td>
      <td>52.060001</td>
      <td>52.810001</td>
      <td>51.869999</td>
      <td>52.096992</td>
      <td>4398600</td>
      <td>WBA</td>
      <td>2</td>
      <td>-0.448763</td>
      <td>55.401845</td>
      <td>50.030942</td>
      <td>49.582808</td>
      <td>-61.117999</td>
      <td>28.020745</td>
      <td>52.877045</td>
      <td>52.935166</td>
    </tr>
    <tr>
      <th>95143</th>
      <td>2021-06-30</td>
      <td>139.559998</td>
      <td>142.580002</td>
      <td>138.690002</td>
      <td>140.502975</td>
      <td>15170400</td>
      <td>WMT</td>
      <td>2</td>
      <td>-0.501083</td>
      <td>142.303471</td>
      <td>134.252829</td>
      <td>53.317367</td>
      <td>31.522244</td>
      <td>20.340870</td>
      <td>139.315001</td>
      <td>139.095497</td>
    </tr>
  </tbody>
</table>
<p>95144 rows × 16 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">factorize</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#. now each new date has a new index</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>7.116786</td>
      <td>7.152143</td>
      <td>6.876786</td>
      <td>5.966037</td>
      <td>1079178800</td>
      <td>AAPL</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>5.966037</td>
      <td>5.966037</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>46.599998</td>
      <td>47.040001</td>
      <td>46.259998</td>
      <td>36.337452</td>
      <td>7934400</td>
      <td>AMGN</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>36.337452</td>
      <td>36.337452</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>52.090000</td>
      <td>52.320000</td>
      <td>50.790001</td>
      <td>40.694553</td>
      <td>8053700</td>
      <td>AXP</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>40.694553</td>
      <td>40.694553</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>87.570000</td>
      <td>87.839996</td>
      <td>86.000000</td>
      <td>63.481598</td>
      <td>4303000</td>
      <td>BA</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>63.481598</td>
      <td>63.481598</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2008-01-02</td>
      <td>72.559998</td>
      <td>72.669998</td>
      <td>70.050003</td>
      <td>47.633072</td>
      <td>6337800</td>
      <td>CAT</td>
      <td>2</td>
      <td>0.000000</td>
      <td>5.971310</td>
      <td>5.963519</td>
      <td>100.000000</td>
      <td>-66.666667</td>
      <td>100.000000</td>
      <td>47.633072</td>
      <td>47.633072</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3397</th>
      <td>2021-06-30</td>
      <td>149.139999</td>
      <td>150.169998</td>
      <td>148.899994</td>
      <td>148.880066</td>
      <td>996900</td>
      <td>TRV</td>
      <td>2</td>
      <td>-1.862937</td>
      <td>159.502541</td>
      <td>143.358709</td>
      <td>46.456282</td>
      <td>-85.980567</td>
      <td>23.655657</td>
      <td>153.281467</td>
      <td>153.841134</td>
    </tr>
    <tr>
      <th>3397</th>
      <td>2021-06-30</td>
      <td>397.540009</td>
      <td>401.399994</td>
      <td>396.799988</td>
      <td>399.039337</td>
      <td>2875600</td>
      <td>UNH</td>
      <td>2</td>
      <td>-0.570259</td>
      <td>405.003754</td>
      <td>390.157858</td>
      <td>53.742914</td>
      <td>-45.875840</td>
      <td>11.026717</td>
      <td>400.883542</td>
      <td>397.679197</td>
    </tr>
    <tr>
      <th>3397</th>
      <td>2021-06-30</td>
      <td>55.759998</td>
      <td>56.139999</td>
      <td>55.759998</td>
      <td>54.757252</td>
      <td>14559700</td>
      <td>VZ</td>
      <td>2</td>
      <td>-0.310560</td>
      <td>56.432618</td>
      <td>54.336725</td>
      <td>45.058622</td>
      <td>-125.801926</td>
      <td>30.282792</td>
      <td>55.369361</td>
      <td>56.008212</td>
    </tr>
    <tr>
      <th>3397</th>
      <td>2021-06-30</td>
      <td>52.060001</td>
      <td>52.810001</td>
      <td>51.869999</td>
      <td>52.096992</td>
      <td>4398600</td>
      <td>WBA</td>
      <td>2</td>
      <td>-0.448763</td>
      <td>55.401845</td>
      <td>50.030942</td>
      <td>49.582808</td>
      <td>-61.117999</td>
      <td>28.020745</td>
      <td>52.877045</td>
      <td>52.935166</td>
    </tr>
    <tr>
      <th>3397</th>
      <td>2021-06-30</td>
      <td>139.559998</td>
      <td>142.580002</td>
      <td>138.690002</td>
      <td>140.502975</td>
      <td>15170400</td>
      <td>WMT</td>
      <td>2</td>
      <td>-0.501083</td>
      <td>142.303471</td>
      <td>134.252829</td>
      <td>53.317367</td>
      <td>31.522244</td>
      <td>20.340870</td>
      <td>139.315001</td>
      <td>139.095497</td>
    </tr>
  </tbody>
</table>
<p>95144 rows × 16 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">cov_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">return_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">LOOKBACK</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unique</span><span class="p">())):</span>
  <span class="n">data_lookback</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">LOOKBACK</span><span class="p">:</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
  <span class="n">price_lookback</span> <span class="o">=</span> <span class="n">data_lookback</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">'date'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'tic'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">'close'</span><span class="p">)</span>
  <span class="n">return_lookback</span> <span class="o">=</span> <span class="n">price_lookback</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
  <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">return_lookback</span><span class="p">)</span>
  <span class="n">covs</span> <span class="o">=</span> <span class="n">return_lookback</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> 
  <span class="n">cov_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">covs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1min 18s, sys: 1min 6s, total: 2min 24s
Wall time: 1min 13s
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">LOOKBACK</span><span class="p">:])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3398, 3146)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">cov_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3146, 3146)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># form a dataframe with the cov_list and return_list</span>
<span class="n">df_cov</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'date'</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">LOOKBACK</span><span class="p">:],</span> <span class="s1">'cov_list'</span><span class="p">:</span><span class="n">cov_list</span><span class="p">,</span> <span class="s1">'return_list'</span><span class="p">:</span><span class="n">return_list</span><span class="p">})</span>
<span class="n">df_cov</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-12-31</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-01-02</td>
      <td>[[0.0013661525204023803, 0.0004339387254358675...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009-01-05</td>
      <td>[[0.0013520236347659828, 0.0004294715465444739...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2009-01-06</td>
      <td>[[0.001352347215232941, 0.0004313719320713819,...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2009-01-07</td>
      <td>[[0.0013492645221634674, 0.0004343000887134513...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3141</th>
      <td>2021-06-24</td>
      <td>[[0.0004731677033495904, 9.642107007054388e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3142</th>
      <td>2021-06-25</td>
      <td>[[0.0004727075227696167, 9.581653646468605e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3143</th>
      <td>2021-06-28</td>
      <td>[[0.0004689360329900794, 9.452633131830962e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3144</th>
      <td>2021-06-29</td>
      <td>[[0.00046752267129975466, 9.494816610080615e-0...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3145</th>
      <td>2021-06-30</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
  </tbody>
</table>
<p>3146 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># merge df_cov with the main dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_cov</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'date'</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-12-31</td>
      <td>3.070357</td>
      <td>3.133571</td>
      <td>3.047857</td>
      <td>2.613432</td>
      <td>607541200</td>
      <td>AAPL</td>
      <td>2</td>
      <td>-0.083547</td>
      <td>3.128999</td>
      <td>2.482334</td>
      <td>42.254774</td>
      <td>-80.488386</td>
      <td>16.129793</td>
      <td>2.780976</td>
      <td>2.894368</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-12-31</td>
      <td>57.110001</td>
      <td>58.220001</td>
      <td>57.060001</td>
      <td>45.031925</td>
      <td>6287200</td>
      <td>AMGN</td>
      <td>2</td>
      <td>0.168716</td>
      <td>45.965627</td>
      <td>43.970343</td>
      <td>51.060612</td>
      <td>51.616099</td>
      <td>10.432018</td>
      <td>44.190811</td>
      <td>43.701894</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-12-31</td>
      <td>17.969999</td>
      <td>18.750000</td>
      <td>17.910000</td>
      <td>14.988310</td>
      <td>9625600</td>
      <td>AXP</td>
      <td>2</td>
      <td>-0.961734</td>
      <td>19.168081</td>
      <td>13.014358</td>
      <td>42.554851</td>
      <td>-75.368750</td>
      <td>25.776759</td>
      <td>16.184139</td>
      <td>18.108783</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-12-31</td>
      <td>41.590000</td>
      <td>43.049999</td>
      <td>41.500000</td>
      <td>32.005890</td>
      <td>5443100</td>
      <td>BA</td>
      <td>2</td>
      <td>-0.279801</td>
      <td>32.174381</td>
      <td>28.867838</td>
      <td>47.440239</td>
      <td>156.994738</td>
      <td>5.366299</td>
      <td>30.327214</td>
      <td>32.389915</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-12-31</td>
      <td>43.700001</td>
      <td>45.099998</td>
      <td>43.700001</td>
      <td>30.925051</td>
      <td>6277400</td>
      <td>CAT</td>
      <td>2</td>
      <td>0.684759</td>
      <td>31.697349</td>
      <td>26.587395</td>
      <td>51.205325</td>
      <td>98.425763</td>
      <td>26.331746</td>
      <td>27.876155</td>
      <td>27.598371</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>88083</th>
      <td>2021-06-30</td>
      <td>149.139999</td>
      <td>150.169998</td>
      <td>148.899994</td>
      <td>148.880066</td>
      <td>996900</td>
      <td>TRV</td>
      <td>2</td>
      <td>-1.862937</td>
      <td>159.502541</td>
      <td>143.358709</td>
      <td>46.456282</td>
      <td>-85.980567</td>
      <td>23.655657</td>
      <td>153.281467</td>
      <td>153.841134</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>88084</th>
      <td>2021-06-30</td>
      <td>397.540009</td>
      <td>401.399994</td>
      <td>396.799988</td>
      <td>399.039337</td>
      <td>2875600</td>
      <td>UNH</td>
      <td>2</td>
      <td>-0.570259</td>
      <td>405.003754</td>
      <td>390.157858</td>
      <td>53.742914</td>
      <td>-45.875840</td>
      <td>11.026717</td>
      <td>400.883542</td>
      <td>397.679197</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>88085</th>
      <td>2021-06-30</td>
      <td>55.759998</td>
      <td>56.139999</td>
      <td>55.759998</td>
      <td>54.757252</td>
      <td>14559700</td>
      <td>VZ</td>
      <td>2</td>
      <td>-0.310560</td>
      <td>56.432618</td>
      <td>54.336725</td>
      <td>45.058622</td>
      <td>-125.801926</td>
      <td>30.282792</td>
      <td>55.369361</td>
      <td>56.008212</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>88086</th>
      <td>2021-06-30</td>
      <td>52.060001</td>
      <td>52.810001</td>
      <td>51.869999</td>
      <td>52.096992</td>
      <td>4398600</td>
      <td>WBA</td>
      <td>2</td>
      <td>-0.448763</td>
      <td>55.401845</td>
      <td>50.030942</td>
      <td>49.582808</td>
      <td>-61.117999</td>
      <td>28.020745</td>
      <td>52.877045</td>
      <td>52.935166</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>88087</th>
      <td>2021-06-30</td>
      <td>139.559998</td>
      <td>142.580002</td>
      <td>138.690002</td>
      <td>140.502975</td>
      <td>15170400</td>
      <td>WMT</td>
      <td>2</td>
      <td>-0.501083</td>
      <td>142.303471</td>
      <td>134.252829</td>
      <td>53.317367</td>
      <td>31.522244</td>
      <td>20.340870</td>
      <td>139.315001</td>
      <td>139.095497</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
  </tbody>
</table>
<p>88088 rows × 18 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'tic'</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2008-12-31</td>
      <td>3.070357</td>
      <td>3.133571</td>
      <td>3.047857</td>
      <td>2.613432</td>
      <td>607541200</td>
      <td>AAPL</td>
      <td>2</td>
      <td>-0.083547</td>
      <td>3.128999</td>
      <td>2.482334</td>
      <td>42.254774</td>
      <td>-80.488386</td>
      <td>16.129793</td>
      <td>2.780976</td>
      <td>2.894368</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2008-12-31</td>
      <td>57.110001</td>
      <td>58.220001</td>
      <td>57.060001</td>
      <td>45.031925</td>
      <td>6287200</td>
      <td>AMGN</td>
      <td>2</td>
      <td>0.168716</td>
      <td>45.965627</td>
      <td>43.970343</td>
      <td>51.060612</td>
      <td>51.616099</td>
      <td>10.432018</td>
      <td>44.190811</td>
      <td>43.701894</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008-12-31</td>
      <td>17.969999</td>
      <td>18.750000</td>
      <td>17.910000</td>
      <td>14.988310</td>
      <td>9625600</td>
      <td>AXP</td>
      <td>2</td>
      <td>-0.961734</td>
      <td>19.168081</td>
      <td>13.014358</td>
      <td>42.554851</td>
      <td>-75.368750</td>
      <td>25.776759</td>
      <td>16.184139</td>
      <td>18.108783</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2008-12-31</td>
      <td>41.590000</td>
      <td>43.049999</td>
      <td>41.500000</td>
      <td>32.005890</td>
      <td>5443100</td>
      <td>BA</td>
      <td>2</td>
      <td>-0.279801</td>
      <td>32.174381</td>
      <td>28.867838</td>
      <td>47.440239</td>
      <td>156.994738</td>
      <td>5.366299</td>
      <td>30.327214</td>
      <td>32.389915</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2008-12-31</td>
      <td>43.700001</td>
      <td>45.099998</td>
      <td>43.700001</td>
      <td>30.925051</td>
      <td>6277400</td>
      <td>CAT</td>
      <td>2</td>
      <td>0.684759</td>
      <td>31.697349</td>
      <td>26.587395</td>
      <td>51.205325</td>
      <td>98.425763</td>
      <td>26.331746</td>
      <td>27.876155</td>
      <td>27.598371</td>
      <td>[[0.0013489708601149843, 0.0004284132050414053...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>88083</th>
      <td>2021-06-30</td>
      <td>149.139999</td>
      <td>150.169998</td>
      <td>148.899994</td>
      <td>148.880066</td>
      <td>996900</td>
      <td>TRV</td>
      <td>2</td>
      <td>-1.862937</td>
      <td>159.502541</td>
      <td>143.358709</td>
      <td>46.456282</td>
      <td>-85.980567</td>
      <td>23.655657</td>
      <td>153.281467</td>
      <td>153.841134</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>88084</th>
      <td>2021-06-30</td>
      <td>397.540009</td>
      <td>401.399994</td>
      <td>396.799988</td>
      <td>399.039337</td>
      <td>2875600</td>
      <td>UNH</td>
      <td>2</td>
      <td>-0.570259</td>
      <td>405.003754</td>
      <td>390.157858</td>
      <td>53.742914</td>
      <td>-45.875840</td>
      <td>11.026717</td>
      <td>400.883542</td>
      <td>397.679197</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>88085</th>
      <td>2021-06-30</td>
      <td>55.759998</td>
      <td>56.139999</td>
      <td>55.759998</td>
      <td>54.757252</td>
      <td>14559700</td>
      <td>VZ</td>
      <td>2</td>
      <td>-0.310560</td>
      <td>56.432618</td>
      <td>54.336725</td>
      <td>45.058622</td>
      <td>-125.801926</td>
      <td>30.282792</td>
      <td>55.369361</td>
      <td>56.008212</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>88086</th>
      <td>2021-06-30</td>
      <td>52.060001</td>
      <td>52.810001</td>
      <td>51.869999</td>
      <td>52.096992</td>
      <td>4398600</td>
      <td>WBA</td>
      <td>2</td>
      <td>-0.448763</td>
      <td>55.401845</td>
      <td>50.030942</td>
      <td>49.582808</td>
      <td>-61.117999</td>
      <td>28.020745</td>
      <td>52.877045</td>
      <td>52.935166</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>88087</th>
      <td>2021-06-30</td>
      <td>139.559998</td>
      <td>142.580002</td>
      <td>138.690002</td>
      <td>140.502975</td>
      <td>15170400</td>
      <td>WMT</td>
      <td>2</td>
      <td>-0.501083</td>
      <td>142.303471</td>
      <td>134.252829</td>
      <td>53.317367</td>
      <td>31.522244</td>
      <td>20.340870</td>
      <td>139.315001</td>
      <td>139.095497</td>
      <td>[[0.0004673859966198239, 9.453361889098358e-05...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
  </tbody>
</table>
<p>88088 rows × 18 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.3-Modeling">
<a class="anchor" href="#3.3-Modeling" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3 Modeling<a class="anchor-link" href="#3.3-Modeling"> </a>
</h3>
<p>The portfolio within the market will be modeled by the OpenAI Gym framework. This is referred to as the <em>environment</em>. For the <em>agent</em>, we will use the FinRL framework. As the agent interacts with the environment it will gradually learn a trading strategy based on the reward function. The agent is rewarded according to the total value of the portfolio.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.3.1-Training-data">
<a class="anchor" href="#3.3.1-Training-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.1 Training data<a class="anchor-link" href="#3.3.1-Training-data"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TRAIN_START</span><span class="p">,</span> <span class="n">TRADE_START</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>('2009-01-01', '2020-07-01')</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">data_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">TRAIN_START</span><span class="p">,</span> <span class="n">TRADE_START</span><span class="p">)</span>
<span class="n">train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>tic</th>
      <th>day</th>
      <th>macd</th>
      <th>boll_ub</th>
      <th>boll_lb</th>
      <th>rsi_30</th>
      <th>cci_30</th>
      <th>dx_30</th>
      <th>close_30_sma</th>
      <th>close_60_sma</th>
      <th>cov_list</th>
      <th>return_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>3.067143</td>
      <td>3.251429</td>
      <td>3.041429</td>
      <td>2.778781</td>
      <td>746015200</td>
      <td>AAPL</td>
      <td>4</td>
      <td>-0.070954</td>
      <td>3.115322</td>
      <td>2.480241</td>
      <td>45.440191</td>
      <td>-32.098615</td>
      <td>2.140064</td>
      <td>2.781833</td>
      <td>2.895179</td>
      <td>[[0.0013661525204023803, 0.0004339387254358675...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>58.590000</td>
      <td>59.080002</td>
      <td>57.750000</td>
      <td>45.998844</td>
      <td>6547900</td>
      <td>AMGN</td>
      <td>4</td>
      <td>0.249875</td>
      <td>46.122329</td>
      <td>43.932164</td>
      <td>52.756857</td>
      <td>93.201866</td>
      <td>0.814217</td>
      <td>44.259691</td>
      <td>43.796767</td>
      <td>[[0.0013661525204023803, 0.0004339387254358675...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>18.570000</td>
      <td>19.520000</td>
      <td>18.400000</td>
      <td>15.618540</td>
      <td>10955700</td>
      <td>AXP</td>
      <td>4</td>
      <td>-0.855307</td>
      <td>18.979334</td>
      <td>12.997874</td>
      <td>43.957545</td>
      <td>-42.761346</td>
      <td>16.335101</td>
      <td>16.182792</td>
      <td>17.988661</td>
      <td>[[0.0013661525204023803, 0.0004339387254358675...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>42.799999</td>
      <td>45.560001</td>
      <td>42.779999</td>
      <td>33.941090</td>
      <td>7010200</td>
      <td>BA</td>
      <td>4</td>
      <td>-0.002010</td>
      <td>32.948623</td>
      <td>28.452134</td>
      <td>50.822025</td>
      <td>272.812705</td>
      <td>20.494464</td>
      <td>30.469479</td>
      <td>32.344130</td>
      <td>[[0.0013661525204023803, 0.0004339387254358675...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>44.910000</td>
      <td>46.980000</td>
      <td>44.709999</td>
      <td>32.475788</td>
      <td>7117200</td>
      <td>CAT</td>
      <td>4</td>
      <td>0.870226</td>
      <td>32.221769</td>
      <td>26.565582</td>
      <td>53.661244</td>
      <td>129.733606</td>
      <td>34.637448</td>
      <td>28.123536</td>
      <td>27.598978</td>
      <td>[[0.0013661525204023803, 0.0004339387254358675...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>2020-06-30</td>
      <td>112.470001</td>
      <td>114.489998</td>
      <td>112.099998</td>
      <td>110.630821</td>
      <td>1464500</td>
      <td>TRV</td>
      <td>1</td>
      <td>1.826301</td>
      <td>121.687415</td>
      <td>104.149844</td>
      <td>52.925515</td>
      <td>19.009508</td>
      <td>1.892194</td>
      <td>108.457672</td>
      <td>102.220518</td>
      <td>[[0.0006523830864902699, 0.0004061940497212106...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>2020-06-30</td>
      <td>288.570007</td>
      <td>296.450012</td>
      <td>287.660004</td>
      <td>289.569763</td>
      <td>2932900</td>
      <td>UNH</td>
      <td>1</td>
      <td>-0.019601</td>
      <td>305.819490</td>
      <td>272.941249</td>
      <td>52.413046</td>
      <td>-25.789735</td>
      <td>1.846804</td>
      <td>289.815185</td>
      <td>282.752202</td>
      <td>[[0.0006523830864902699, 0.0004061940497212106...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>2020-06-30</td>
      <td>54.919998</td>
      <td>55.290001</td>
      <td>54.360001</td>
      <td>51.604496</td>
      <td>17414800</td>
      <td>VZ</td>
      <td>1</td>
      <td>-0.447764</td>
      <td>55.232495</td>
      <td>49.916930</td>
      <td>48.097037</td>
      <td>-50.926694</td>
      <td>8.508886</td>
      <td>52.255363</td>
      <td>52.718949</td>
      <td>[[0.0006523830864902699, 0.0004061940497212106...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>2020-06-30</td>
      <td>42.119999</td>
      <td>42.580002</td>
      <td>41.759998</td>
      <td>40.278061</td>
      <td>4782100</td>
      <td>WBA</td>
      <td>1</td>
      <td>-0.086659</td>
      <td>43.965360</td>
      <td>37.648307</td>
      <td>48.830189</td>
      <td>-14.417124</td>
      <td>1.500723</td>
      <td>40.380679</td>
      <td>40.174252</td>
      <td>[[0.0006523830864902699, 0.0004061940497212106...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>2020-06-30</td>
      <td>119.220001</td>
      <td>120.129997</td>
      <td>118.540001</td>
      <td>117.465691</td>
      <td>6836400</td>
      <td>WMT</td>
      <td>1</td>
      <td>-0.896830</td>
      <td>120.856469</td>
      <td>114.824136</td>
      <td>48.159688</td>
      <td>-69.901576</td>
      <td>3.847271</td>
      <td>119.150816</td>
      <td>121.108865</td>
      <td>[[0.0006523830864902699, 0.0004061940497212106...</td>
      <td>tic             AAPL      AMGN       AXP  ... ...</td>
    </tr>
  </tbody>
</table>
<p>81004 rows × 18 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.3.2-Portfolio-(Environment)">
<a class="anchor" href="#3.3.2-Portfolio-(Environment)" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.2 Portfolio (Environment)<a class="anchor-link" href="#3.3.2-Portfolio-(Environment)"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Portfolio</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">):</span>
    <span class="sd">"""A portfolio/market environment</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">        df: DataFrame</span>
<span class="sd">            input data</span>
<span class="sd">        stock_dim : int</span>
<span class="sd">            number of unique stocks</span>
<span class="sd">        hmax : int</span>
<span class="sd">            maximum number of shares to trade</span>
<span class="sd">        initial_amount : int</span>
<span class="sd">            start money</span>
<span class="sd">        transaction_cost_pct: float</span>
<span class="sd">            transaction cost percentage per trade</span>
<span class="sd">        reward_scaling: float</span>
<span class="sd">            scaling factor for reward, good for training</span>
<span class="sd">        state_space: int</span>
<span class="sd">            the dimension of input features</span>
<span class="sd">        action_space: int</span>
<span class="sd">            equals stock dimension</span>
<span class="sd">        tech_indicator_list: list</span>
<span class="sd">            a list of technical indicator names</span>
<span class="sd">        turbulence_threshold: int</span>
<span class="sd">            a threshold to control risk aversion</span>
<span class="sd">        day: int</span>
<span class="sd">            an increment number to control date</span>
<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    _sell_stock()</span>
<span class="sd">        perform sell action based on the sign of the action</span>
<span class="sd">    _buy_stock()</span>
<span class="sd">        perform buy action based on the sign of the action</span>
<span class="sd">    step()</span>
<span class="sd">        at each step the agent will return actions, then </span>
<span class="sd">        we will calculate the reward, and return the next observation.</span>
<span class="sd">    reset()</span>
<span class="sd">        reset the environment</span>
<span class="sd">    render()</span>
<span class="sd">        use render to return other functions</span>
<span class="sd">    save_asset_memory()</span>
<span class="sd">        return account value at each time step</span>
<span class="sd">    save_action_memory()</span>
<span class="sd">        return actions/positions at each time step</span>
<span class="sd">    """</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'render.modes'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'human'</span><span class="p">]}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                <span class="n">df</span><span class="p">,</span>
                <span class="n">stock_dim</span><span class="p">,</span>
                <span class="n">hmax</span><span class="p">,</span>
                <span class="n">initial_amount</span><span class="p">,</span>
                <span class="n">transaction_cost_pct</span><span class="p">,</span>
                <span class="n">reward_scaling</span><span class="p">,</span>
                <span class="n">state_space</span><span class="p">,</span>
                <span class="n">action_space</span><span class="p">,</span>
                <span class="n">tech_indicator_list</span><span class="p">,</span>
                <span class="n">turbulence_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">lookback</span><span class="o">=</span><span class="n">LOOKBACK</span><span class="p">,</span>
                <span class="n">day</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="c1">#super(StockEnv, self).__init__()</span>
        <span class="c1">#money = 10 , scope = 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lookback</span> <span class="o">=</span> <span class="n">lookback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span> <span class="o">=</span> <span class="n">stock_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hmax</span> <span class="o">=</span> <span class="n">hmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span> <span class="o">=</span> <span class="n">initial_amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transaction_cost_pct</span> <span class="o">=</span> <span class="n">transaction_cost_pct</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reward_scaling</span> <span class="o">=</span> <span class="n">reward_scaling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_space</span> <span class="o">=</span> <span class="n">state_space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">action_space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="o">=</span> <span class="n">tech_indicator_list</span>

        <span class="c1"># action_space normalization and shape is self.stock_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action_space</span><span class="p">,))</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state_space</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_space</span><span class="p">))</span>

        <span class="c1"># load data from a pandas dataframe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'cov_list'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covs</span><span class="p">),</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">tech</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">tech</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turbulence_threshold</span> <span class="o">=</span> <span class="n">turbulence_threshold</span>
        <span class="c1"># initalize state: inital portfolio return + individual stock return + individual weights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span>

        <span class="c1"># memorize portfolio value each step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span><span class="p">]</span>
        <span class="c1"># memorize portfolio return each step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">daily_return</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(),</span> <span class="s1">'r'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'results/cumulative_reward.png'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'results/rewards.png'</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">"================================="</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"begin_total_asset:</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>           
            <span class="nb">print</span><span class="p">(</span><span class="s2">"end_total_asset:</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span><span class="p">))</span>

            <span class="n">df_daily_return</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="p">)</span>
            <span class="n">df_daily_return</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">df_daily_return</span><span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
              <span class="n">sharpe</span> <span class="o">=</span> <span class="p">(</span><span class="mi">252</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">df_daily_return</span><span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span> \
                       <span class="n">df_daily_return</span><span class="p">[</span><span class="s1">'daily_return'</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
              <span class="nb">print</span><span class="p">(</span><span class="s2">"Sharpe: "</span><span class="p">,</span><span class="n">sharpe</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"================================="</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reward</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="p">,</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">softmax_normalization</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
            <span class="n">last_day_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

            <span class="c1">#load next state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">covs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'cov_list'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covs</span><span class="p">),</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">tech</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">tech</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">portfolio_return</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">last_day_memory</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">weights</span><span class="p">)</span>
            <span class="n">log_portfolio_return</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">last_day_memory</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">*</span><span class="n">weights</span><span class="p">))</span>
            <span class="c1"># update portfolio value</span>
            <span class="n">new_portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">portfolio_return</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span> <span class="o">=</span> <span class="n">new_portfolio_value</span>

            <span class="c1"># save into memory</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">portfolio_return</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>            
            <span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_portfolio_value</span><span class="p">)</span>

            <span class="c1"># the reward is the new portfolio value or end portfolo value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reward</span> <span class="o">=</span> <span class="n">new_portfolio_value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reward</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="p">,</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asset_memory</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,:]</span>
        <span class="c1"># load states</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'cov_list'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covs</span><span class="p">),</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">tech</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">tech</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tech_indicator_list</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_amount</span>
        <span class="c1">#self.cost = 0</span>
        <span class="c1">#self.trades = 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">False</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">stock_dim</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
    
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'human'</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
        
    <span class="k">def</span> <span class="nf">softmax_normalization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">actions</span><span class="p">))</span>
        <span class="n">softmax_output</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span>
        <span class="k">return</span> <span class="n">softmax_output</span>

    <span class="k">def</span> <span class="nf">save_asset_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">date_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span>
        <span class="n">portfolio_return</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_return_memory</span>
        <span class="c1">#print(len(date_list))</span>
        <span class="c1">#print(len(asset_list))</span>
        <span class="n">df_account_value</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'date'</span><span class="p">:</span><span class="n">date_list</span><span class="p">,</span><span class="s1">'daily_return'</span><span class="p">:</span><span class="n">portfolio_return</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">df_account_value</span>

    <span class="k">def</span> <span class="nf">save_action_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># date and close price length must match actions length</span>
        <span class="n">date_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_memory</span>
        <span class="n">df_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">date_list</span><span class="p">)</span>
        <span class="n">df_date</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'date'</span><span class="p">]</span>
        
        <span class="n">action_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions_memory</span>
        <span class="n">df_actions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">action_list</span><span class="p">)</span>
        <span class="n">df_actions</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="o">.</span><span class="n">values</span>
        <span class="n">df_actions</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df_date</span><span class="o">.</span><span class="n">date</span>
        <span class="c1">#df_actions = pd.DataFrame({'date':date_list,'actions':action_list})</span>
        <span class="k">return</span> <span class="n">df_actions</span>

    <span class="k">def</span> <span class="nf">_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">np_random</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">seeding</span><span class="o">.</span><span class="n">np_random</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">seed</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_sb_env</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">DummyVecEnv</span><span class="p">([</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="p">])</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">obs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"hmax"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> 
    <span class="s2">"initial_amount"</span><span class="p">:</span> <span class="n">INITIAL_AMOUNT</span><span class="p">,</span> 
    <span class="s2">"transaction_cost_pct"</span><span class="p">:</span> <span class="n">TRANSACTION_COST_PCT</span><span class="p">,</span> 
    <span class="s2">"state_space"</span><span class="p">:</span> <span class="n">state_space</span><span class="p">,</span> 
    <span class="s2">"stock_dim"</span><span class="p">:</span> <span class="n">stock_dimension</span><span class="p">,</span> 
    <span class="s2">"tech_indicator_list"</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">TECHNICAL_INDICATORS_LIST</span><span class="p">,</span> 
    <span class="s2">"action_space"</span><span class="p">:</span> <span class="n">stock_dimension</span><span class="p">,</span> 
    <span class="s2">"reward_scaling"</span><span class="p">:</span> <span class="n">REWARD_SCALING</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">e_train_gym</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">train</span><span class="p">,</span> <span class="o">**</span><span class="n">env_kwargs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env_train</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">e_train_gym</span><span class="o">.</span><span class="n">get_sb_env</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">env_train</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class 'stable_baselines3.common.vec_env.dummy_vec_env.DummyVecEnv'&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.3.3-Portfolio-Manager-(Agent)">
<a class="anchor" href="#3.3.3-Portfolio-Manager-(Agent)" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.3 Portfolio Manager (Agent)<a class="anchor-link" href="#3.3.3-Portfolio-Manager-(Agent)"> </a>
</h4>
<ul>
<li>
<p>We investigate the performance of two models for the <em>agent</em>:</p>
<ul>
<li>A2C</li>
<li>PPO</li>
</ul>
</li>
</ul>
<p>Both models are based on algorithm implementations in the <em>OpenAI Baselines</em> and <em>Stable Baselines</em> libraries.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="3.3.3.1-A2C">
<a class="anchor" href="#3.3.3.1-A2C" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.3.1 A2C<a class="anchor-link" href="#3.3.3.1-A2C"> </a>
</h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env_train</span><span class="p">)</span>
<span class="n">A2C_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"n_steps"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> 
  <span class="s2">"ent_coef"</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span> 
  <span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">0.0004</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">model_a2c</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s2">"a2c"</span><span class="p">,</span> <span class="n">model_kwargs</span><span class="o">=</span><span class="n">A2C_PARAMS</span><span class="p">)</span>
<span class="n">model_a2c</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{'n_steps': 10, 'ent_coef': 0.005, 'learning_rate': 0.0004}
Using cuda device
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;stable_baselines3.a2c.a2c.A2C at 0x7f2c2b2c59d0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># train A2C agent</span>
<span class="n">trained_a2c</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_a2c</span><span class="p">,</span> <span class="n">tb_log_name</span><span class="o">=</span><span class="s1">'a2c'</span><span class="p">,</span> <span class="n">total_timesteps</span><span class="o">=</span><span class="mi">40_000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Logging to tensorboard_log/a2c/a2c_2
-------------------------------------
| time/                 |           |
|    fps                | 235       |
|    iterations         | 100       |
|    time_elapsed       | 4         |
|    total_timesteps    | 1000      |
| train/                |           |
|    entropy_loss       | -39.1     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 3099      |
|    policy_loss        | 4.24e+08  |
|    reward             | 2082528.9 |
|    std                | 0.977     |
|    value_loss         | 1.49e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 234       |
|    iterations         | 200       |
|    time_elapsed       | 8         |
|    total_timesteps    | 2000      |
| train/                |           |
|    entropy_loss       | -39.1     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 3199      |
|    policy_loss        | 8.69e+08  |
|    reward             | 4048982.2 |
|    std                | 0.978     |
|    value_loss         | 5.51e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6471035.2421458755
Sharpe:  0.982992073153757
=================================
-------------------------------------
| time/                 |           |
|    fps                | 231       |
|    iterations         | 300       |
|    time_elapsed       | 12        |
|    total_timesteps    | 3000      |
| train/                |           |
|    entropy_loss       | -39.1     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 3299      |
|    policy_loss        | 2.25e+08  |
|    reward             | 1069921.4 |
|    std                | 0.979     |
|    value_loss         | 3.68e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 400       |
|    time_elapsed       | 17        |
|    total_timesteps    | 4000      |
| train/                |           |
|    entropy_loss       | -39.1     |
|    explained_variance | -2.38e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 3399      |
|    policy_loss        | 4.91e+08  |
|    reward             | 2428200.0 |
|    std                | 0.978     |
|    value_loss         | 2.03e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 500       |
|    time_elapsed       | 21        |
|    total_timesteps    | 5000      |
| train/                |           |
|    entropy_loss       | -39.1     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 3499      |
|    policy_loss        | 8.47e+08  |
|    reward             | 4054856.2 |
|    std                | 0.978     |
|    value_loss         | 6.08e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5835240.509882443
Sharpe:  0.933579163334226
=================================
-------------------------------------
| time/                 |           |
|    fps                | 231       |
|    iterations         | 600       |
|    time_elapsed       | 25        |
|    total_timesteps    | 6000      |
| train/                |           |
|    entropy_loss       | -39.1     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 3599      |
|    policy_loss        | 2.68e+08  |
|    reward             | 1312348.2 |
|    std                | 0.976     |
|    value_loss         | 6.16e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 700       |
|    time_elapsed       | 30        |
|    total_timesteps    | 7000      |
| train/                |           |
|    entropy_loss       | -39       |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 3699      |
|    policy_loss        | 5.6e+08   |
|    reward             | 2694707.0 |
|    std                | 0.975     |
|    value_loss         | 2.43e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 800       |
|    time_elapsed       | 34        |
|    total_timesteps    | 8000      |
| train/                |           |
|    entropy_loss       | -39       |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 3799      |
|    policy_loss        | 9.67e+08  |
|    reward             | 4816259.0 |
|    std                | 0.975     |
|    value_loss         | 7.87e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6498413.205034829
Sharpe:  0.9895239691615925
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 900       |
|    time_elapsed       | 38        |
|    total_timesteps    | 9000      |
| train/                |           |
|    entropy_loss       | -39       |
|    explained_variance | -2.38e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 3899      |
|    policy_loss        | 2.93e+08  |
|    reward             | 1437959.9 |
|    std                | 0.974     |
|    value_loss         | 7.06e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 1000      |
|    time_elapsed       | 42        |
|    total_timesteps    | 10000     |
| train/                |           |
|    entropy_loss       | -39       |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 3999      |
|    policy_loss        | 5.5e+08   |
|    reward             | 2588818.2 |
|    std                | 0.974     |
|    value_loss         | 2.31e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 1100      |
|    time_elapsed       | 47        |
|    total_timesteps    | 11000     |
| train/                |           |
|    entropy_loss       | -39       |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 4099      |
|    policy_loss        | 9.76e+08  |
|    reward             | 4423758.5 |
|    std                | 0.973     |
|    value_loss         | 7.8e+14   |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5695186.910671866
Sharpe:  0.9260963309753596
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 1200      |
|    time_elapsed       | 51        |
|    total_timesteps    | 12000     |
| train/                |           |
|    entropy_loss       | -39       |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 4199      |
|    policy_loss        | 2.92e+08  |
|    reward             | 1435156.9 |
|    std                | 0.973     |
|    value_loss         | 6.59e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 1300      |
|    time_elapsed       | 55        |
|    total_timesteps    | 13000     |
| train/                |           |
|    entropy_loss       | -38.9     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 4299      |
|    policy_loss        | 5.94e+08  |
|    reward             | 3035968.0 |
|    std                | 0.971     |
|    value_loss         | 3.1e+14   |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 1400      |
|    time_elapsed       | 60        |
|    total_timesteps    | 14000     |
| train/                |           |
|    entropy_loss       | -38.9     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 4399      |
|    policy_loss        | 1.05e+09  |
|    reward             | 5257825.0 |
|    std                | 0.972     |
|    value_loss         | 9.6e+14   |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5707319.064386405
Sharpe:  0.9261500834480171
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 1500      |
|    time_elapsed       | 64        |
|    total_timesteps    | 15000     |
| train/                |           |
|    entropy_loss       | -38.9     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 4499      |
|    policy_loss        | 3.43e+08  |
|    reward             | 1668015.6 |
|    std                | 0.97      |
|    value_loss         | 9.65e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 1600      |
|    time_elapsed       | 68        |
|    total_timesteps    | 16000     |
| train/                |           |
|    entropy_loss       | -38.9     |
|    explained_variance | 5.96e-08  |
|    learning_rate      | 0.0004    |
|    n_updates          | 4599      |
|    policy_loss        | 6.23e+08  |
|    reward             | 3063482.5 |
|    std                | 0.97      |
|    value_loss         | 3.4e+14   |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 1700      |
|    time_elapsed       | 72        |
|    total_timesteps    | 17000     |
| train/                |           |
|    entropy_loss       | -38.8     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 4699      |
|    policy_loss        | 1.14e+09  |
|    reward             | 5369624.0 |
|    std                | 0.969     |
|    value_loss         | 9.63e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5962072.1969115
Sharpe:  0.9431990958215473
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 1800      |
|    time_elapsed       | 77        |
|    total_timesteps    | 18000     |
| train/                |           |
|    entropy_loss       | -38.8     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 4799      |
|    policy_loss        | 3.47e+08  |
|    reward             | 1686547.6 |
|    std                | 0.968     |
|    value_loss         | 9.83e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 1900      |
|    time_elapsed       | 81        |
|    total_timesteps    | 19000     |
| train/                |           |
|    entropy_loss       | -38.8     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 4899      |
|    policy_loss        | 6.59e+08  |
|    reward             | 3169809.5 |
|    std                | 0.968     |
|    value_loss         | 3.54e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 2000      |
|    time_elapsed       | 85        |
|    total_timesteps    | 20000     |
| train/                |           |
|    entropy_loss       | -38.8     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 4999      |
|    policy_loss        | 1.15e+09  |
|    reward             | 5675731.0 |
|    std                | 0.968     |
|    value_loss         | 1.1e+15   |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5867912.907758107
Sharpe:  0.9356056960177895
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 2100      |
|    time_elapsed       | 90        |
|    total_timesteps    | 21000     |
| train/                |           |
|    entropy_loss       | -38.8     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 5099      |
|    policy_loss        | 3.22e+08  |
|    reward             | 1654335.9 |
|    std                | 0.966     |
|    value_loss         | 9.58e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 2200      |
|    time_elapsed       | 94        |
|    total_timesteps    | 22000     |
| train/                |           |
|    entropy_loss       | -38.7     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 5199      |
|    policy_loss        | 6.21e+08  |
|    reward             | 3039328.8 |
|    std                | 0.966     |
|    value_loss         | 3.41e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 2300      |
|    time_elapsed       | 98        |
|    total_timesteps    | 23000     |
| train/                |           |
|    entropy_loss       | -38.7     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 5299      |
|    policy_loss        | 1.28e+09  |
|    reward             | 5901983.5 |
|    std                | 0.966     |
|    value_loss         | 1.25e+15  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5802637.727659458
Sharpe:  0.9392089708149494
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 2400      |
|    time_elapsed       | 103       |
|    total_timesteps    | 24000     |
| train/                |           |
|    entropy_loss       | -38.7     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 5399      |
|    policy_loss        | 4.11e+08  |
|    reward             | 1879426.5 |
|    std                | 0.965     |
|    value_loss         | 1.37e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 2500      |
|    time_elapsed       | 107       |
|    total_timesteps    | 25000     |
| train/                |           |
|    entropy_loss       | -38.7     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 5499      |
|    policy_loss        | 6.58e+08  |
|    reward             | 3281025.5 |
|    std                | 0.965     |
|    value_loss         | 3.97e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 2600      |
|    time_elapsed       | 111       |
|    total_timesteps    | 26000     |
| train/                |           |
|    entropy_loss       | -38.7     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 5599      |
|    policy_loss        | 1.16e+09  |
|    reward             | 5591346.0 |
|    std                | 0.965     |
|    value_loss         | 1.06e+15  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5839747.269809463
Sharpe:  0.942568571792511
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 2700      |
|    time_elapsed       | 115       |
|    total_timesteps    | 27000     |
| train/                |           |
|    entropy_loss       | -38.7     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 5699      |
|    policy_loss        | 4.07e+08  |
|    reward             | 2025016.2 |
|    std                | 0.964     |
|    value_loss         | 1.52e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 2800      |
|    time_elapsed       | 120       |
|    total_timesteps    | 28000     |
| train/                |           |
|    entropy_loss       | -38.7     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 5799      |
|    policy_loss        | 7.21e+08  |
|    reward             | 3546038.5 |
|    std                | 0.963     |
|    value_loss         | 4.57e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5934598.71535798
Sharpe:  0.9451165553501172
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 2900      |
|    time_elapsed       | 124       |
|    total_timesteps    | 29000     |
| train/                |           |
|    entropy_loss       | -38.6     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 5899      |
|    policy_loss        | 1.94e+08  |
|    reward             | 994617.1  |
|    std                | 0.962     |
|    value_loss         | 3.01e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 3000      |
|    time_elapsed       | 128       |
|    total_timesteps    | 30000     |
| train/                |           |
|    entropy_loss       | -38.6     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 5999      |
|    policy_loss        | 4.62e+08  |
|    reward             | 2356375.0 |
|    std                | 0.961     |
|    value_loss         | 1.93e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 3100      |
|    time_elapsed       | 133       |
|    total_timesteps    | 31000     |
| train/                |           |
|    entropy_loss       | -38.6     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 6099      |
|    policy_loss        | 8.44e+08  |
|    reward             | 4184154.5 |
|    std                | 0.961     |
|    value_loss         | 6.5e+14   |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6133582.149651799
Sharpe:  0.9588119618173185
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 3200      |
|    time_elapsed       | 137       |
|    total_timesteps    | 32000     |
| train/                |           |
|    entropy_loss       | -38.6     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 6199      |
|    policy_loss        | 2.51e+08  |
|    reward             | 1218142.1 |
|    std                | 0.961     |
|    value_loss         | 4.91e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 3300      |
|    time_elapsed       | 141       |
|    total_timesteps    | 33000     |
| train/                |           |
|    entropy_loss       | -38.6     |
|    explained_variance | -1.19e-07 |
|    learning_rate      | 0.0004    |
|    n_updates          | 6299      |
|    policy_loss        | 5.08e+08  |
|    reward             | 2279872.2 |
|    std                | 0.961     |
|    value_loss         | 1.89e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 3400      |
|    time_elapsed       | 145       |
|    total_timesteps    | 34000     |
| train/                |           |
|    entropy_loss       | -38.6     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 6399      |
|    policy_loss        | 8.23e+08  |
|    reward             | 4013993.0 |
|    std                | 0.96      |
|    value_loss         | 5.81e+14  |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5567368.588035281
Sharpe:  0.9135830885033946
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 3500      |
|    time_elapsed       | 150       |
|    total_timesteps    | 35000     |
| train/                |           |
|    entropy_loss       | -38.6     |
|    explained_variance | 1.19e-07  |
|    learning_rate      | 0.0004    |
|    n_updates          | 6499      |
|    policy_loss        | 2.78e+08  |
|    reward             | 1408755.8 |
|    std                | 0.959     |
|    value_loss         | 6.8e+13   |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 3600      |
|    time_elapsed       | 154       |
|    total_timesteps    | 36000     |
| train/                |           |
|    entropy_loss       | -38.5     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 6599      |
|    policy_loss        | 5.55e+08  |
|    reward             | 2751289.2 |
|    std                | 0.959     |
|    value_loss         | 2.8e+14   |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 3700      |
|    time_elapsed       | 158       |
|    total_timesteps    | 37000     |
| train/                |           |
|    entropy_loss       | -38.5     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 6699      |
|    policy_loss        | 1.03e+09  |
|    reward             | 5447341.5 |
|    std                | 0.958     |
|    value_loss         | 1e+15     |
-------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6491852.7053341335
Sharpe:  0.984850464628264
=================================
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 3800      |
|    time_elapsed       | 163       |
|    total_timesteps    | 38000     |
| train/                |           |
|    entropy_loss       | -38.5     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 6799      |
|    policy_loss        | 2.68e+08  |
|    reward             | 1374876.0 |
|    std                | 0.958     |
|    value_loss         | 6.13e+13  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 232       |
|    iterations         | 3900      |
|    time_elapsed       | 167       |
|    total_timesteps    | 39000     |
| train/                |           |
|    entropy_loss       | -38.5     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 6899      |
|    policy_loss        | 5.74e+08  |
|    reward             | 2856792.5 |
|    std                | 0.957     |
|    value_loss         | 2.87e+14  |
-------------------------------------
-------------------------------------
| time/                 |           |
|    fps                | 233       |
|    iterations         | 4000      |
|    time_elapsed       | 171       |
|    total_timesteps    | 40000     |
| train/                |           |
|    entropy_loss       | -38.5     |
|    explained_variance | 0         |
|    learning_rate      | 0.0004    |
|    n_updates          | 6999      |
|    policy_loss        | 1.06e+09  |
|    reward             | 4800850.5 |
|    std                | 0.956     |
|    value_loss         | 8.76e+14  |
-------------------------------------
CPU times: user 2min 50s, sys: 1.48 s, total: 2min 52s
Wall time: 2min 51s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="3.3.3.2-PPO">
<a class="anchor" href="#3.3.3.2-PPO" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3.3.2 PPO<a class="anchor-link" href="#3.3.3.2-PPO"> </a>
</h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="p">(</span><span class="n">env</span> <span class="o">=</span> <span class="n">env_train</span><span class="p">)</span>
<span class="n">PPO_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"n_steps"</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
  <span class="s2">"ent_coef"</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span>
  <span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
  <span class="s2">"batch_size"</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">model_ppo</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="s2">"ppo"</span><span class="p">,</span><span class="n">model_kwargs</span> <span class="o">=</span> <span class="n">PPO_PARAMS</span><span class="p">)</span>
<span class="n">model_ppo</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{'n_steps': 2048, 'ent_coef': 0.005, 'learning_rate': 0.001, 'batch_size': 128}
Using cuda device
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;stable_baselines3.ppo.ppo.PPO at 0x7f2bafa7d690&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># train PPO agent</span>
<span class="n">trained_ppo</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_ppo</span><span class="p">,</span> <span class="n">tb_log_name</span><span class="o">=</span><span class="s1">'ppo'</span><span class="p">,</span> <span class="n">total_timesteps</span><span class="o">=</span><span class="mi">40_000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Logging to tensorboard_log/ppo/ppo_1
----------------------------------
| time/              |           |
|    fps             | 289       |
|    iterations      | 1         |
|    time_elapsed    | 7         |
|    total_timesteps | 2048      |
| train/             |           |
|    reward          | 4264698.0 |
----------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6047209.767025409
Sharpe:  0.9482672037903711
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 261          |
|    iterations           | 2            |
|    time_elapsed         | 15           |
|    total_timesteps      | 4096         |
| train/                  |              |
|    approx_kl            | 9.662472e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 9.54e+14     |
|    n_updates            | 10           |
|    policy_gradient_loss | -5.26e-06    |
|    reward               | 2367457.0    |
|    std                  | 1            |
|    value_loss           | 1.82e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5456253.146291008
Sharpe:  0.9009155756443198
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 254          |
|    iterations           | 3            |
|    time_elapsed         | 24           |
|    total_timesteps      | 6144         |
| train/                  |              |
|    approx_kl            | 9.400537e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 2.11e+15     |
|    n_updates            | 20           |
|    policy_gradient_loss | -4e-06       |
|    reward               | 1362187.4    |
|    std                  | 1            |
|    value_loss           | 3.8e+15      |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 253          |
|    iterations           | 4            |
|    time_elapsed         | 32           |
|    total_timesteps      | 8192         |
| train/                  |              |
|    approx_kl            | 9.720679e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | -2.38e-07    |
|    learning_rate        | 0.001        |
|    loss                 | 1.84e+15     |
|    n_updates            | 30           |
|    policy_gradient_loss | -3.9e-06     |
|    reward               | 5052093.5    |
|    std                  | 1            |
|    value_loss           | 3.65e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5972338.417276716
Sharpe:  0.93843821167953
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 250          |
|    iterations           | 5            |
|    time_elapsed         | 40           |
|    total_timesteps      | 10240        |
| train/                  |              |
|    approx_kl            | 8.643838e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 5.96e-08     |
|    learning_rate        | 0.001        |
|    loss                 | 1.35e+15     |
|    n_updates            | 40           |
|    policy_gradient_loss | -3.49e-06    |
|    reward               | 3227055.2    |
|    std                  | 1            |
|    value_loss           | 2.6e+15      |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6161172.303125634
Sharpe:  0.9589365667784778
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 248          |
|    iterations           | 6            |
|    time_elapsed         | 49           |
|    total_timesteps      | 12288        |
| train/                  |              |
|    approx_kl            | 9.546056e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.35e+15     |
|    n_updates            | 50           |
|    policy_gradient_loss | -5.47e-06    |
|    reward               | 1639736.2    |
|    std                  | 1            |
|    value_loss           | 2.81e+15     |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 248          |
|    iterations           | 7            |
|    time_elapsed         | 57           |
|    total_timesteps      | 14336        |
| train/                  |              |
|    approx_kl            | 9.400537e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | -1.19e-07    |
|    learning_rate        | 0.001        |
|    loss                 | 2e+15        |
|    n_updates            | 60           |
|    policy_gradient_loss | -4.5e-06     |
|    reward               | 6495811.0    |
|    std                  | 1            |
|    value_loss           | 4.2e+15      |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6120673.608505497
Sharpe:  0.952029601057897
=================================
-----------------------------------------
| time/                   |             |
|    fps                  | 247         |
|    iterations           | 8           |
|    time_elapsed         | 66          |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 9.57516e-09 |
|    clip_fraction        | 0           |
|    clip_range           | 0.2         |
|    entropy_loss         | -39.7       |
|    explained_variance   | 1.79e-07    |
|    learning_rate        | 0.001       |
|    loss                 | 1.99e+15    |
|    n_updates            | 70          |
|    policy_gradient_loss | -2.79e-06   |
|    reward               | 3644347.5   |
|    std                  | 1           |
|    value_loss           | 4.02e+15    |
-----------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5856952.745435607
Sharpe:  0.9271842203954493
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 247          |
|    iterations           | 9            |
|    time_elapsed         | 74           |
|    total_timesteps      | 18432        |
| train/                  |              |
|    approx_kl            | 1.033186e-08 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.08e+15     |
|    n_updates            | 80           |
|    policy_gradient_loss | -5.99e-06    |
|    reward               | 2349878.2    |
|    std                  | 1            |
|    value_loss           | 1.97e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5780678.776974752
Sharpe:  0.9311743380822141
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 245          |
|    iterations           | 10           |
|    time_elapsed         | 83           |
|    total_timesteps      | 20480        |
| train/                  |              |
|    approx_kl            | 8.934876e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 2.19e+15     |
|    n_updates            | 90           |
|    policy_gradient_loss | -3.73e-06    |
|    reward               | 1385949.2    |
|    std                  | 1            |
|    value_loss           | 3.77e+15     |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 245          |
|    iterations           | 11           |
|    time_elapsed         | 91           |
|    total_timesteps      | 22528        |
| train/                  |              |
|    approx_kl            | 9.313226e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 1.19e-07     |
|    learning_rate        | 0.001        |
|    loss                 | 2.19e+15     |
|    n_updates            | 100          |
|    policy_gradient_loss | -3.6e-06     |
|    reward               | 5118786.5    |
|    std                  | 1            |
|    value_loss           | 4.52e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5749798.357827723
Sharpe:  0.9201778526473151
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 245          |
|    iterations           | 12           |
|    time_elapsed         | 100          |
|    total_timesteps      | 24576        |
| train/                  |              |
|    approx_kl            | 9.749783e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.21e+15     |
|    n_updates            | 110          |
|    policy_gradient_loss | -4.74e-06    |
|    reward               | 3029267.8    |
|    std                  | 1            |
|    value_loss           | 2.33e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5915004.379978999
Sharpe:  0.9420634499700777
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 245          |
|    iterations           | 13           |
|    time_elapsed         | 108          |
|    total_timesteps      | 26624        |
| train/                  |              |
|    approx_kl            | 9.720679e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.7e+15      |
|    n_updates            | 120          |
|    policy_gradient_loss | -4.1e-06     |
|    reward               | 1907587.6    |
|    std                  | 1            |
|    value_loss           | 3.2e+15      |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 245          |
|    iterations           | 14           |
|    time_elapsed         | 116          |
|    total_timesteps      | 28672        |
| train/                  |              |
|    approx_kl            | 9.255018e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 2.16e+15     |
|    n_updates            | 130          |
|    policy_gradient_loss | -4.34e-06    |
|    reward               | 6415988.5    |
|    std                  | 1            |
|    value_loss           | 4.17e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6667618.802437189
Sharpe:  0.9934771051374055
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 245          |
|    iterations           | 15           |
|    time_elapsed         | 125          |
|    total_timesteps      | 30720        |
| train/                  |              |
|    approx_kl            | 8.702045e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.96e+15     |
|    n_updates            | 140          |
|    policy_gradient_loss | -3.37e-06    |
|    reward               | 3035074.0    |
|    std                  | 1            |
|    value_loss           | 4.06e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5686067.470317899
Sharpe:  0.9212753940458989
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 244          |
|    iterations           | 16           |
|    time_elapsed         | 133          |
|    total_timesteps      | 32768        |
| train/                  |              |
|    approx_kl            | 1.033186e-08 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.45e+15     |
|    n_updates            | 150          |
|    policy_gradient_loss | -4.74e-06    |
|    reward               | 2031158.0    |
|    std                  | 1            |
|    value_loss           | 2.58e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5724902.54857743
Sharpe:  0.9219779031064367
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 244          |
|    iterations           | 17           |
|    time_elapsed         | 142          |
|    total_timesteps      | 34816        |
| train/                  |              |
|    approx_kl            | 9.807991e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | -1.19e-07    |
|    learning_rate        | 0.001        |
|    loss                 | 1.88e+15     |
|    n_updates            | 160          |
|    policy_gradient_loss | -3.87e-06    |
|    reward               | 1089068.9    |
|    std                  | 1            |
|    value_loss           | 3.66e+15     |
------------------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 244          |
|    iterations           | 18           |
|    time_elapsed         | 150          |
|    total_timesteps      | 36864        |
| train/                  |              |
|    approx_kl            | 8.876668e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 1.19e-07     |
|    learning_rate        | 0.001        |
|    loss                 | 2.23e+15     |
|    n_updates            | 170          |
|    policy_gradient_loss | -4.14e-06    |
|    reward               | 4243537.0    |
|    std                  | 1            |
|    value_loss           | 4.39e+15     |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:5530907.400073219
Sharpe:  0.9046012263316776
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 244          |
|    iterations           | 19           |
|    time_elapsed         | 159          |
|    total_timesteps      | 38912        |
| train/                  |              |
|    approx_kl            | 9.837095e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | 0            |
|    learning_rate        | 0.001        |
|    loss                 | 1.01e+15     |
|    n_updates            | 180          |
|    policy_gradient_loss | -4.77e-06    |
|    reward               | 2929927.5    |
|    std                  | 1            |
|    value_loss           | 2e+15        |
------------------------------------------
=================================
begin_total_asset:1000000
end_total_asset:6722283.085569916
Sharpe:  1.0049628189137338
=================================
------------------------------------------
| time/                   |              |
|    fps                  | 244          |
|    iterations           | 20           |
|    time_elapsed         | 167          |
|    total_timesteps      | 40960        |
| train/                  |              |
|    approx_kl            | 9.371433e-09 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -39.7        |
|    explained_variance   | -1.19e-07    |
|    learning_rate        | 0.001        |
|    loss                 | 1.81e+15     |
|    n_updates            | 190          |
|    policy_gradient_loss | -5.13e-06    |
|    reward               | 1502412.0    |
|    std                  | 1            |
|    value_loss           | 3.35e+15     |
------------------------------------------
CPU times: user 2min 47s, sys: 2.02 s, total: 2min 49s
Wall time: 2min 48s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.4-Evaluation">
<a class="anchor" href="#3.4-Evaluation" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4 Evaluation<a class="anchor-link" href="#3.4-Evaluation"> </a>
</h3>
<p>We now use the most recent data to evaluate the performance of the two models of the agent. This is also referred to as <em>back-testing</em> or simply <em>trading</em>. This data has never been seen by the training process. The start date of this data is captured in the parameter TRADE_START.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TRADE_START</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'2020-07-01'</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trade</span> <span class="o">=</span> <span class="n">data_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">TRADE_START</span><span class="p">,</span> <span class="n">DATA_END</span><span class="p">)</span>
<span class="n">e_trade_gym</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">trade</span><span class="p">,</span> <span class="o">**</span><span class="n">env_kwargs</span><span class="p">)</span>
<span class="n">e_trade_gym</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__.Portfolio at 0x7f2bb0e2aad0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baseline_df</span> <span class="o">=</span> <span class="n">get_baseline</span><span class="p">(</span>
        <span class="n">ticker</span><span class="o">=</span><span class="s2">"^DJI"</span><span class="p">,</span> 
        <span class="n">start</span><span class="o">=</span><span class="n">TRADE_START</span><span class="p">,</span>
        <span class="n">end</span><span class="o">=</span><span class="n">DATA_END</span><span class="p">)</span>
<span class="n">baseline_df_stats</span> <span class="o">=</span> <span class="n">backtest_stats</span><span class="p">(</span><span class="n">baseline_df</span><span class="p">,</span> <span class="n">value_col_name</span> <span class="o">=</span> <span class="s1">'close'</span><span class="p">)</span>
<span class="n">baseline_returns</span> <span class="o">=</span> <span class="n">get_daily_return</span><span class="p">(</span><span class="n">baseline_df</span><span class="p">,</span> <span class="n">value_col_name</span><span class="o">=</span><span class="s2">"close"</span><span class="p">)</span>
<span class="n">dji_cumpod</span> <span class="o">=</span><span class="p">(</span><span class="n">baseline_returns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[*********************100%***********************]  1 of 1 completed
Shape of DataFrame:  (252, 8)
Annual return          0.340686
Cumulative returns     0.340686
Annual volatility      0.145825
Sharpe ratio           2.092401
Calmar ratio           3.814740
Stability              0.945610
Max drawdown          -0.089308
Omega ratio            1.416513
Sortino ratio          3.133042
Skew                        NaN
Kurtosis                    NaN
Tail ratio             1.080042
Daily value at risk   -0.017161
dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_daily_return_a2c</span><span class="p">,</span> <span class="n">df_actions_a2c</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="o">.</span><span class="n">DRL_prediction</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">trained_a2c</span><span class="p">,</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">e_trade_gym</span><span class="p">)</span>
<span class="n">df_daily_return_ppo</span><span class="p">,</span> <span class="n">df_actions_ppo</span> <span class="o">=</span> <span class="n">DRLAgent</span><span class="o">.</span><span class="n">DRL_prediction</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">trained_ppo</span><span class="p">,</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">e_trade_gym</span><span class="p">)</span>
<span class="n">time_ind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">df_daily_return_a2c</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<span class="n">a2c_cumpod</span> <span class="o">=</span><span class="p">(</span><span class="n">df_daily_return_a2c</span><span class="o">.</span><span class="n">daily_return</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">ppo_cumpod</span> <span class="o">=</span><span class="p">(</span><span class="n">df_daily_return_ppo</span><span class="o">.</span><span class="n">daily_return</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">DRL_strat_a2c</span> <span class="o">=</span> <span class="n">convert_daily_return_to_pyfolio_ts</span><span class="p">(</span><span class="n">df_daily_return_a2c</span><span class="p">)</span>
<span class="n">DRL_strat_ppo</span> <span class="o">=</span> <span class="n">convert_daily_return_to_pyfolio_ts</span><span class="p">(</span><span class="n">df_daily_return_ppo</span><span class="p">)</span>

<span class="n">perf_func</span> <span class="o">=</span> <span class="n">timeseries</span><span class="o">.</span><span class="n">perf_stats</span>
<span class="n">perf_stats_all_a2c</span> <span class="o">=</span> <span class="n">perf_func</span><span class="p">(</span><span class="n">returns</span><span class="o">=</span><span class="n">DRL_strat_a2c</span><span class="p">,</span> <span class="n">factor_returns</span><span class="o">=</span><span class="n">DRL_strat_a2c</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">turnover_denom</span><span class="o">=</span><span class="s2">"AGB"</span><span class="p">)</span>
<span class="n">perf_stats_all_ppo</span> <span class="o">=</span> <span class="n">perf_func</span><span class="p">(</span><span class="n">returns</span><span class="o">=</span><span class="n">DRL_strat_ppo</span><span class="p">,</span> <span class="n">factor_returns</span><span class="o">=</span><span class="n">DRL_strat_ppo</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">turnover_denom</span><span class="o">=</span><span class="s2">"AGB"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>=================================
begin_total_asset:1000000
end_total_asset:1381325.590340156
Sharpe:  2.291521681307043
=================================
hit end!
=================================
begin_total_asset:1000000
end_total_asset:1353893.672843339
Sharpe:  2.190025565631849
=================================
hit end!
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.4.1-Inspect-actions">
<a class="anchor" href="#3.4.1-Inspect-actions" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4.1 Inspect actions<a class="anchor-link" href="#3.4.1-Inspect-actions"> </a>
</h4>
<p>For the sake of interest, we inspect some the actions taken by the A2C agent.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Inspect the actions taken by the A2C agent (for interest sake)</span>
<span class="c1"># A2C actions</span>
<span class="n">df_actions_a2c</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAPL</th>
      <th>AMGN</th>
      <th>AXP</th>
      <th>BA</th>
      <th>CAT</th>
      <th>CRM</th>
      <th>CSCO</th>
      <th>CVX</th>
      <th>DIS</th>
      <th>GS</th>
      <th>HD</th>
      <th>HON</th>
      <th>IBM</th>
      <th>INTC</th>
      <th>JNJ</th>
      <th>JPM</th>
      <th>KO</th>
      <th>MCD</th>
      <th>MMM</th>
      <th>MRK</th>
      <th>MSFT</th>
      <th>NKE</th>
      <th>PG</th>
      <th>TRV</th>
      <th>UNH</th>
      <th>VZ</th>
      <th>WBA</th>
      <th>WMT</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-07-01</th>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
      <td>0.035714</td>
    </tr>
    <tr>
      <th>2020-07-02</th>
      <td>0.022926</td>
      <td>0.022926</td>
      <td>0.022926</td>
      <td>0.022926</td>
      <td>0.062319</td>
      <td>0.022926</td>
      <td>0.022926</td>
      <td>0.062319</td>
      <td>0.022926</td>
      <td>0.022926</td>
      <td>0.022926</td>
      <td>0.033573</td>
      <td>0.035840</td>
      <td>0.022926</td>
      <td>0.062319</td>
      <td>0.037898</td>
      <td>0.022926</td>
      <td>0.022926</td>
      <td>0.062319</td>
      <td>0.022926</td>
      <td>0.062319</td>
      <td>0.022926</td>
      <td>0.062319</td>
      <td>0.062319</td>
      <td>0.062319</td>
      <td>0.027327</td>
      <td>0.022926</td>
      <td>0.022926</td>
    </tr>
    <tr>
      <th>2020-07-06</th>
      <td>0.022539</td>
      <td>0.022539</td>
      <td>0.022539</td>
      <td>0.022539</td>
      <td>0.022776</td>
      <td>0.022539</td>
      <td>0.022539</td>
      <td>0.061269</td>
      <td>0.022539</td>
      <td>0.022539</td>
      <td>0.022539</td>
      <td>0.061269</td>
      <td>0.022539</td>
      <td>0.061269</td>
      <td>0.061269</td>
      <td>0.061269</td>
      <td>0.024966</td>
      <td>0.022539</td>
      <td>0.061269</td>
      <td>0.048798</td>
      <td>0.061269</td>
      <td>0.022539</td>
      <td>0.034668</td>
      <td>0.061269</td>
      <td>0.040551</td>
      <td>0.022539</td>
      <td>0.022539</td>
      <td>0.022539</td>
    </tr>
    <tr>
      <th>2020-07-07</th>
      <td>0.040818</td>
      <td>0.023074</td>
      <td>0.023074</td>
      <td>0.023074</td>
      <td>0.052600</td>
      <td>0.023074</td>
      <td>0.023074</td>
      <td>0.062721</td>
      <td>0.023074</td>
      <td>0.023074</td>
      <td>0.023074</td>
      <td>0.042016</td>
      <td>0.026930</td>
      <td>0.023074</td>
      <td>0.062721</td>
      <td>0.035630</td>
      <td>0.023314</td>
      <td>0.023074</td>
      <td>0.062721</td>
      <td>0.023074</td>
      <td>0.062721</td>
      <td>0.023074</td>
      <td>0.062721</td>
      <td>0.047909</td>
      <td>0.062721</td>
      <td>0.031422</td>
      <td>0.023074</td>
      <td>0.023074</td>
    </tr>
    <tr>
      <th>2020-07-08</th>
      <td>0.022382</td>
      <td>0.022382</td>
      <td>0.022382</td>
      <td>0.022382</td>
      <td>0.060841</td>
      <td>0.022382</td>
      <td>0.022382</td>
      <td>0.060841</td>
      <td>0.022382</td>
      <td>0.022382</td>
      <td>0.022382</td>
      <td>0.022382</td>
      <td>0.054799</td>
      <td>0.022382</td>
      <td>0.060841</td>
      <td>0.060841</td>
      <td>0.022382</td>
      <td>0.022382</td>
      <td>0.055844</td>
      <td>0.045687</td>
      <td>0.060841</td>
      <td>0.022382</td>
      <td>0.060841</td>
      <td>0.027040</td>
      <td>0.060841</td>
      <td>0.032633</td>
      <td>0.022382</td>
      <td>0.022382</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-06-24</th>
      <td>0.023142</td>
      <td>0.027773</td>
      <td>0.023142</td>
      <td>0.023142</td>
      <td>0.029840</td>
      <td>0.023142</td>
      <td>0.023142</td>
      <td>0.062906</td>
      <td>0.023142</td>
      <td>0.023142</td>
      <td>0.052508</td>
      <td>0.062906</td>
      <td>0.027666</td>
      <td>0.023142</td>
      <td>0.051607</td>
      <td>0.062906</td>
      <td>0.023142</td>
      <td>0.023142</td>
      <td>0.062906</td>
      <td>0.023142</td>
      <td>0.062906</td>
      <td>0.023142</td>
      <td>0.062906</td>
      <td>0.023142</td>
      <td>0.062906</td>
      <td>0.023142</td>
      <td>0.023142</td>
      <td>0.023142</td>
    </tr>
    <tr>
      <th>2021-06-25</th>
      <td>0.023193</td>
      <td>0.023193</td>
      <td>0.023193</td>
      <td>0.023193</td>
      <td>0.063046</td>
      <td>0.023193</td>
      <td>0.023193</td>
      <td>0.063046</td>
      <td>0.023193</td>
      <td>0.023193</td>
      <td>0.034455</td>
      <td>0.063046</td>
      <td>0.043412</td>
      <td>0.023193</td>
      <td>0.063046</td>
      <td>0.063046</td>
      <td>0.023193</td>
      <td>0.023193</td>
      <td>0.029043</td>
      <td>0.023193</td>
      <td>0.063046</td>
      <td>0.023193</td>
      <td>0.063046</td>
      <td>0.043204</td>
      <td>0.023193</td>
      <td>0.023193</td>
      <td>0.023193</td>
      <td>0.037472</td>
    </tr>
    <tr>
      <th>2021-06-28</th>
      <td>0.022995</td>
      <td>0.022995</td>
      <td>0.022995</td>
      <td>0.022995</td>
      <td>0.022995</td>
      <td>0.022995</td>
      <td>0.022995</td>
      <td>0.062508</td>
      <td>0.022995</td>
      <td>0.022995</td>
      <td>0.053000</td>
      <td>0.062508</td>
      <td>0.022995</td>
      <td>0.022995</td>
      <td>0.062508</td>
      <td>0.062508</td>
      <td>0.062508</td>
      <td>0.022995</td>
      <td>0.023493</td>
      <td>0.022995</td>
      <td>0.062508</td>
      <td>0.022995</td>
      <td>0.062508</td>
      <td>0.022995</td>
      <td>0.062508</td>
      <td>0.022995</td>
      <td>0.032521</td>
      <td>0.022995</td>
    </tr>
    <tr>
      <th>2021-06-29</th>
      <td>0.020690</td>
      <td>0.020690</td>
      <td>0.020690</td>
      <td>0.020690</td>
      <td>0.056241</td>
      <td>0.020690</td>
      <td>0.020690</td>
      <td>0.056241</td>
      <td>0.020690</td>
      <td>0.020690</td>
      <td>0.052683</td>
      <td>0.038600</td>
      <td>0.056241</td>
      <td>0.022292</td>
      <td>0.056241</td>
      <td>0.056241</td>
      <td>0.055183</td>
      <td>0.020690</td>
      <td>0.056241</td>
      <td>0.037155</td>
      <td>0.056241</td>
      <td>0.020690</td>
      <td>0.049668</td>
      <td>0.056241</td>
      <td>0.025517</td>
      <td>0.020690</td>
      <td>0.020690</td>
      <td>0.020690</td>
    </tr>
    <tr>
      <th>2021-06-30</th>
      <td>0.021377</td>
      <td>0.021377</td>
      <td>0.021377</td>
      <td>0.021377</td>
      <td>0.021377</td>
      <td>0.021377</td>
      <td>0.021377</td>
      <td>0.058109</td>
      <td>0.021377</td>
      <td>0.021377</td>
      <td>0.029448</td>
      <td>0.058109</td>
      <td>0.058109</td>
      <td>0.021377</td>
      <td>0.021377</td>
      <td>0.058109</td>
      <td>0.058109</td>
      <td>0.021377</td>
      <td>0.058109</td>
      <td>0.042063</td>
      <td>0.058109</td>
      <td>0.021377</td>
      <td>0.058109</td>
      <td>0.021377</td>
      <td>0.058109</td>
      <td>0.026741</td>
      <td>0.021377</td>
      <td>0.058109</td>
    </tr>
  </tbody>
</table>
<p>252 rows × 28 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is a visualization of the A2C agent's actions specifically on AAPL:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_actions_a2c</span><span class="p">[</span><span class="s1">'AAPL'</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'AAPL A2C'</span><span class="p">))</span>
<span class="c1"># fig.add_trace(go.Scatter(x=time_ind, y=-df_actions_ppo['AAPL'], mode='lines', name='AAPL PPO'))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">traceorder</span><span class="o">=</span><span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="s2">"sans-serif"</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span>
        <span class="p">),</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">"White"</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span> <span class="s2">"AAPL actions of A2C &amp; PPO"</span><span class="p">,</span>
        <span class="s1">'y'</span><span class="p">:</span> <span class="mf">0.87</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span> <span class="mf">0.48</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
        <span class="s1">'yanchor'</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Daily Actions"</span><span class="p">),</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="c1"># fig.update_layout(font_size = 20)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zerolinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">'Grey'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="c7b2cbe2-a4ef-41af-ae23-ef5c18f61d1c" class="plotly-graph-div" style="height:600px; width:900px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("c7b2cbe2-a4ef-41af-ae23-ef5c18f61d1c")) {
                    Plotly.newPlot(
                        'c7b2cbe2-a4ef-41af-ae23-ef5c18f61d1c',
                        [{"line": {"width": 2}, "mode": "lines", "name": "AAPL A2C", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30"], "y": [0.03571428571428571, 0.022925760596990585, 0.022539472207427025, 0.04081813246011734, 0.022381994873285294, 0.021243691444396973, 0.019887849688529968, 0.022902652621269226, 0.022553160786628723, 0.03748958185315132, 0.023404840379953384, 0.022189633920788765, 0.022112801671028137, 0.023320795968174934, 0.02243964932858944, 0.05856000632047653, 0.027876952663064003, 0.029198549687862396, 0.02420741505920887, 0.0240379236638546, 0.025045951828360558, 0.021638447418808937, 0.022621193900704384, 0.021788984537124634, 0.022087449207901955, 0.022756023332476616, 0.020457647740840912, 0.025156909599900246, 0.02079792134463787, 0.021812936291098595, 0.023489076644182205, 0.020993994548916817, 0.022418152540922165, 0.023273585364222527, 0.020858338102698326, 0.02281736209988594, 0.02420133724808693, 0.02298864908516407, 0.02084648609161377, 0.0235366839915514, 0.023688429966568947, 0.023240167647600174, 0.02377338334918022, 0.021859778091311455, 0.02211902290582657, 0.021346060559153557, 0.022261574864387512, 0.023201286792755127, 0.020438654348254204, 0.023554353043437004, 0.02130413055419922, 0.024228835478425026, 0.022227957844734192, 0.021968424320220947, 0.02473882958292961, 0.023122884333133698, 0.056133247911930084, 0.022519085556268692, 0.04559450224041939, 0.023020366206765175, 0.05498826503753662, 0.022319955751299858, 0.021472131833434105, 0.02236309088766575, 0.020591342821717262, 0.020617511123418808, 0.022131314501166344, 0.023031648248434067, 0.02274520881474018, 0.02148015797138214, 0.022264471277594566, 0.021876228973269463, 0.022500352934002876, 0.023670721799135208, 0.019811006262898445, 0.020531699061393738, 0.0220752265304327, 0.023281987756490707, 0.023234721273183823, 0.02190200798213482, 0.041668619960546494, 0.022953512147068977, 0.02170146256685257, 0.02396335080265999, 0.020750680938363075, 0.026405617594718933, 0.022361135110259056, 0.02064937725663185, 0.02088327705860138, 0.02329285442829132, 0.022326147183775902, 0.02270086668431759, 0.02136872336268425, 0.024503448978066444, 0.02153741754591465, 0.02158881351351738, 0.02106861025094986, 0.023118648678064346, 0.023292753845453262, 0.02128531225025654, 0.023916257545351982, 0.021151205524802208, 0.022049488499760628, 0.021979736164212227, 0.022486742585897446, 0.023564834147691727, 0.022430747747421265, 0.02165006473660469, 0.0224164891988039, 0.02200484275817871, 0.022454429417848587, 0.021497804671525955, 0.02040853165090084, 0.020497597754001617, 0.024613650515675545, 0.02606971561908722, 0.022294677793979645, 0.021690063178539276, 0.0205970611423254, 0.02220778353512287, 0.020033501088619232, 0.021386899054050446, 0.024724960327148438, 0.021056460216641426, 0.02104959636926651, 0.02402368001639843, 0.02190835028886795, 0.02140239253640175, 0.02193894051015377, 0.04393244534730911, 0.022681448608636856, 0.020396459847688675, 0.02356133982539177, 0.02391662634909153, 0.02242700569331646, 0.022664757445454597, 0.02075383998453617, 0.023425396531820297, 0.022513816133141518, 0.025539129972457886, 0.023032715544104576, 0.02536339871585369, 0.022711483761668205, 0.02416202612221241, 0.022826876491308212, 0.021664002910256386, 0.022946797311306, 0.022150954231619835, 0.019863998517394066, 0.022367946803569794, 0.023203736171126366, 0.02210317552089691, 0.022425111383199692, 0.022303052246570587, 0.020453445613384247, 0.021400950849056244, 0.022890647873282433, 0.023151153698563576, 0.02207084745168686, 0.02180611528456211, 0.021308880299329758, 0.021781569346785545, 0.022408483549952507, 0.023300109431147575, 0.021812323480844498, 0.022520756348967552, 0.023561522364616394, 0.022814255207777023, 0.021027125418186188, 0.02171524055302143, 0.022038355469703674, 0.021349556744098663, 0.02048483118414879, 0.021235883235931396, 0.022869035601615906, 0.021718861535191536, 0.02380417101085186, 0.020372355356812477, 0.022469526156783104, 0.05594625324010849, 0.02297137677669525, 0.02329392544925213, 0.021718358621001244, 0.02495001070201397, 0.023657506331801414, 0.022227315232157707, 0.020748430863022804, 0.0221420731395483, 0.021361246705055237, 0.019504843279719353, 0.021354103460907936, 0.022270822897553444, 0.021909775212407112, 0.020866166800260544, 0.022229645401239395, 0.06271657347679138, 0.022079112008213997, 0.022917751222848892, 0.022314002737402916, 0.019553862512111664, 0.021915996447205544, 0.022070851176977158, 0.03030426986515522, 0.021949825808405876, 0.05688063055276871, 0.023246049880981445, 0.021340416744351387, 0.020621582865715027, 0.025521930307149887, 0.02337174117565155, 0.022552374750375748, 0.022211112082004547, 0.02279266156256199, 0.024475712329149246, 0.022240573540329933, 0.022451141849160194, 0.022647647187113762, 0.02124512940645218, 0.022592851892113686, 0.025917503982782364, 0.020394785329699516, 0.052319616079330444, 0.019298192113637924, 0.022190861403942108, 0.02352026291191578, 0.021350843831896782, 0.01972143165767193, 0.02329065650701523, 0.023776143789291382, 0.02192472480237484, 0.02305847778916359, 0.022894710302352905, 0.021538913249969482, 0.022031527012586594, 0.022533586248755455, 0.022642815485596657, 0.02091444469988346, 0.02340788207948208, 0.023029519245028496, 0.023573698475956917, 0.020072955638170242, 0.02102505974471569, 0.020422793924808502, 0.023703590035438538, 0.02125639095902443, 0.022521674633026123, 0.023350918665528297, 0.02314166910946369, 0.023193320259451866, 0.02299540862441063, 0.020690076053142548, 0.021377142518758774]}],
                        {"font": {"size": 15}, "height": 600, "legend": {"bgcolor": "White", "bordercolor": "white", "borderwidth": 2, "font": {"color": "black", "family": "sans-serif", "size": 20}, "traceorder": "normal", "x": 0, "y": 1}, "paper_bgcolor": "rgba(1, 1, 0, 0)", "plot_bgcolor": "rgba(1, 1, 0, 0)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "AAPL actions of A2C & PPO", "x": 0.48, "xanchor": "center", "y": 0.87, "yanchor": "top"}, "width": 900, "xaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Date"}}, "yaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Daily Actions"}, "zeroline": true, "zerolinecolor": "Grey", "zerolinewidth": 1}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('c7b2cbe2-a4ef-41af-ae23-ef5c18f61d1c');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.4.2-Inspect-daily-return">
<a class="anchor" href="#3.4.2-Inspect-daily-return" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4.2 Inspect daily return<a class="anchor-link" href="#3.4.2-Inspect-daily-return"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is a visualization of the daily return of the portfolio:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="c1"># fig.add_trace(go.Scatter(x=time_ind, y=df_actions_a2c['AAPL'], mode='lines', name='AAPL'))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">DRL_strat_a2c</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'A2C'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">DRL_strat_ppo</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'PPO'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">traceorder</span><span class="o">=</span><span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="s2">"sans-serif"</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span>
        <span class="p">),</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">"White"</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span> <span class="s2">"Daily Return of A2C &amp; PPO"</span><span class="p">,</span>
        <span class="s1">'y'</span><span class="p">:</span> <span class="mf">0.87</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span> <span class="mf">0.48</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
        <span class="s1">'yanchor'</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Daily Return"</span><span class="p">),</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="c1"># fig.update_layout(font_size = 20)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zerolinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">'Grey'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="25df5e85-cb7e-4e9c-940c-a8eb78d283b5" class="plotly-graph-div" style="height:600px; width:900px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("25df5e85-cb7e-4e9c-940c-a8eb78d283b5")) {
                    Plotly.newPlot(
                        '25df5e85-cb7e-4e9c-940c-a8eb78d283b5',
                        [{"line": {"width": 2}, "mode": "lines", "name": "A2C", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30"], "y": [0.0, 0.005267264981902435, 0.015010847632546358, -0.013624754045277639, 0.005473261049238967, -0.015644980266118512, 0.01616672618715636, -0.00019511575884572025, 0.02117653969688419, 0.006799898115789129, -0.0013249104525428846, -0.00013280271872169783, -0.0010006106616979767, 0.007195926830314279, 0.005578915476361293, -0.010306558175668539, -0.006681209144640638, 0.001960187298159393, -0.004712741570316163, 0.005793779314404335, -0.009301273581769779, -0.002418260019320397, 0.007302898582867445, 0.003009051463416792, 0.01473131637679101, 0.004098107063233603, 0.005426232287235608, 0.012400437754399436, -0.001992130954463035, 0.009107754778918429, -0.005050776435192723, 0.0007943926925775507, -0.004148837540683497, -0.002455952649199398, -0.005064936933641537, -9.86084503595716e-05, 0.002433939852539226, 0.01259157898752102, 0.0027931221439031744, 0.004696605639827006, 0.009263156543872697, 0.005619608331822112, -0.007527253235557564, 0.0029180345984576765, 0.018779734532432566, -0.02367487517329621, -0.0022982620195835866, -0.02276576283141981, 0.014799268743997404, -0.01502287681864651, 0.006728575889602413, 0.008996245873474135, -0.002985560690438858, 0.0033195064681204077, -0.0019365997305883674, -0.008465769283667325, -0.018803577224918964, 0.00358162136851239, -0.01953693058545144, 0.001979532628757246, 0.012058433502230357, 0.015332584237262482, -0.00685829340305459, 0.010760746004435736, -0.0015271132496393496, -0.0017918526560429548, 0.016777229072001562, -0.011431529336665986, 0.018843781802145645, 0.011546256480377007, 0.003935946051055807, 0.008089979986785928, -0.0075439034176145395, -0.0043093835103371276, 0.001714161275179692, 0.0035839051945612574, -0.014601317858813237, 0.004628957865081299, -0.0015244957003254713, 0.008749637680750644, -0.001532337906034978, -0.022185170367501533, -0.01000329447608974, -0.03393738534546231, 0.00528907418108713, -0.0023129347826645564, 0.018436728389757333, 0.019065283957757584, 0.002151097515185275, 0.019803768083041153, -0.0023815618780880614, 0.03904169002042501, 0.013413710869782224, -0.0008857532874819731, -0.010282651208286803, 0.01592415406331463, 0.018026407737049645, -0.00826908624996308, -0.013372624323332222, 0.001782615285398515, -0.00472000089690529, 0.01060998250320911, 0.016483998078216187, -0.005660061464767479, 0.00014778873509679142, -0.010107330631223368, 0.008938214107591358, 0.006374260475308234, 0.0042142747083038865, 0.010095905455050397, -0.008922067115799143, 0.004109988623227738, -0.0018599806814543892, -0.001864786499824772, 0.0009783929470796283, -0.008797358590868656, 0.011263421471150547, -0.001805430599736873, 0.004059558921681302, -0.0037893059525057156, -0.001116034044522527, -0.007214499489724786, 0.004313216494848643, 0.002687517870546456, 0.005295954009366015, -0.001543795583132922, 0.0012484906138025753, 0.007228950503498296, -0.011083089173252543, 0.005199272006871614, 0.01647385968590948, 0.005884269594660598, 0.001017608097979168, -0.0005157924223253638, 0.00386815141933696, 0.0005785938307643216, 0.0009948431699969321, -0.007429345535537869, 0.005381050731147922, 0.006777928282857144, -0.0012886214584873735, -0.009012054290126671, 0.0014797625783637119, -0.0011852826311885625, -0.01434329963101762, 0.010320903308930337, -0.021530708949730935, 0.006552882197141166, 0.010271719671301218, 0.0019181973789985504, 0.008852066777246988, 0.004746617097444507, 0.008860982551440369, 4.1085232360223134e-05, 0.0023256681657400345, 6.725581668557819e-05, 0.001814758177379077, 0.001068589539543021, 0.004939916661333188, -0.0015936774608957005, -0.0002564021514309989, 0.0032408995508601763, 0.001567209520707555, 0.012434785170530687, -0.013392894191370073, -0.014826704855130785, 0.01808729662681011, -0.004914510154203627, -0.001828972556391067, -0.009888313323160787, 0.020705681775806475, 0.009586015185248185, 0.000641887998241733, 0.014098887015255678, 0.0036761493728171717, 0.008469543178673376, 0.006011640218502174, -0.004241624635155255, 0.003859827206578708, -0.006608704862996123, -0.007124541333788299, 0.0035902541919266276, -0.0071615610381025405, 0.002478085961884985, 0.007248562459785392, 0.016110104584181127, 0.002721925232666891, -0.004588138114133803, -0.0029250709045217697, 0.003222437546727142, 0.011720931385052289, -0.004381877584676897, 0.0019929538401065065, -6.967682070333242e-05, 0.008247836986169625, -0.002500002392192471, -0.0035125679657227846, 0.0007032697094559658, 0.006485301249812925, 0.005914152144952499, -0.0026564725820132687, -0.005080410050493662, 0.009828405693373283, -0.01035892160670523, 0.005422041699098472, -0.004673109358165278, -0.000802426867830105, -0.0021492086903626096, 0.006256876746497988, -0.005521784129605923, 0.00857008553409808, 0.0015909036951555016, 0.0033995546012283943, 0.009835576155811323, 0.005134067821759505, 0.0012451370028880116, -0.013799752998758722, -0.01746563023861088, 0.013910622345128148, 0.009990769277742303, -0.0004791133041008083, -0.009087041208619247, -0.004409412772826067, 0.0056224083188260035, 0.002386230456779886, 0.006024761249412493, -0.0030148573737420028, -0.0006035735125900164, 0.0036841996229602762, 0.0013597253574142705, 0.0004709255941019353, 0.0026725741343630693, 0.0005053891431180302, 0.005518010732722032, -0.004375576812876139, -0.0016952751951073775, -0.004197403050011492, 0.003326917295310606, -0.0003177118038679575, -0.001995925256840727, -0.0018106331644964567, -0.006796348752927954, -0.0076620637386697445, -0.01672752226800054, 0.01696531174986767, 0.0011958872582201027, -0.003230019112259702, 0.007997029194274544, 0.006917124061645096, -0.003398932451447049, -0.0006357038308420253, 0.007404763588846296]}, {"line": {"width": 2}, "mode": "lines", "name": "PPO", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30"], "y": [0.0, 0.00489902936206337, 0.017708926689813602, -0.01226383100988487, 0.005365386317135856, -0.013573686430157602, 0.014834311492433637, -0.0016481834235941586, 0.019530396848993086, 0.007147543664349688, -0.001570863587029401, 0.0009698902533069298, -0.0009241243036957617, 0.005805993836486677, 0.004644421656338988, -0.009015664304930442, -0.012345454499719282, 0.0018872150115034128, -0.00629179151555907, 0.00500015740017995, -0.010596982543063006, -0.002395480082216338, 0.004874230322358171, 0.004355428488659524, 0.010190230683686356, 0.003839782097570188, 0.002507044235415858, 0.012281518772134103, -0.002718075528589609, 0.009055539619101704, -0.004057905373382057, 0.0015725614065547982, -0.005973280229359711, -0.0013204632013283273, -0.00385582524951274, 0.0001244912513595675, 0.0018658950921012231, 0.011271273272817598, 0.0036023623061115944, 0.00902105562557492, 0.009016727916710144, 0.003102188547363143, -0.007407936941056322, 0.00404975615241914, 0.017167353457700568, -0.023611460811227523, 0.0009691523949343797, -0.020887039211116443, 0.01364664444183439, -0.014489121330963452, 0.006612159022092482, 0.00966859211961825, -0.00236553630844694, 0.005783911084470614, -0.003716581921642259, -0.008009444874446417, -0.021404774714947693, 0.005750355932985351, -0.017895147170865718, 0.0012152152020670948, 0.012000397800363296, 0.014960332779219255, -0.006351694680421808, 0.010473714200132097, -0.0006144376566806279, -0.005869402664035756, 0.017299972266136377, -0.011561269020233784, 0.017276533130010888, 0.005740991016348628, 0.0009411936532530456, 0.00952735588537652, -0.00559107401025297, -0.005505961390403572, 0.00024340417592693997, 0.002480041706120984, -0.01410263256895714, 0.0040462815226599965, -0.0011101968699646699, 0.007778298385482153, -0.002277925783070782, -0.022250796018608732, -0.010001025098055248, -0.03213228076935674, 0.0045885909582932495, -0.0030928252649442367, 0.01626814573018169, 0.01780135463555016, 0.003688986412041737, 0.019322923689694044, -0.0014932527605646963, 0.03997120146449646, 0.011712610731002266, 0.001341770755325576, -0.011935562499565565, 0.019959938507220578, 0.01829201928167177, -0.0065786569135413775, -0.012067364627732842, 0.0012775046476429075, -0.006526448328350767, 0.012709463764225297, 0.01596121982501482, -0.003210364158960634, -0.00039848886835228885, -0.009427471331847152, 0.006743925277692122, 0.0026129742886345088, 0.006969345013573457, 0.008490987362569199, -0.006789871733984057, 0.003937459229319486, -0.0023168661370857914, -0.002360889659021427, 0.0011823372836585492, -0.005666551400271734, 0.010095054857039312, -0.0031783706020264576, 0.003492281107127755, -0.005425166038684968, -0.0005857435716335633, -0.008075693012673012, 0.003008566256077202, 0.002534261249493349, 0.0050888625966665785, -0.0032009843511893077, 0.001799739876924175, 0.007333924560767935, -0.010644637235848816, 0.0045076597054253325, 0.016671683669510943, 0.00911128154612001, 0.0015192736086678672, -0.00041935962816072657, 0.003985451726044334, -0.0011439553788387977, -0.0008862854078694637, -0.0056383853489596495, 0.003463914175146329, 0.009244238737930507, -0.002059424556462179, -0.008453165830817403, 1.2457197180308085e-05, -0.0010385977757607298, -0.019674357369287156, 0.00985145594810448, -0.01774896966581402, 0.007738653852764528, 0.013801760253756894, 0.0010403344306532264, 0.0095843370760368, 0.005102634849118756, 0.00906177615980735, 0.0007262779838407173, 0.0006766855655873931, -0.0002452192482305202, 0.0014708044740293985, 0.0003234610485110743, 0.005876438822292042, -0.002293124845460352, 0.001914041649180082, 0.0007175264349402938, 0.0002276280413430671, 0.012377092734221669, -0.015226812469789384, -0.014174846443091244, 0.01889712015816292, -0.004958654147223697, -0.0036143715711499285, -0.009041689981872705, 0.020459289126860618, 0.007781315529706365, 0.005135424388587832, 0.01424247428694118, 0.0033105065704381567, 0.00478273315867036, 0.009458726794859817, -0.0010296549942015313, 0.004490195374995405, -0.005191229012269081, -0.003930479885334926, 0.004940810617283228, -0.007899626462521302, 0.0006166039976985717, 0.006179803261842256, 0.0157273804381363, 0.0031093497804299966, -0.00562334020828632, -0.0030655389621494474, 0.002852542742848785, 0.012705044369336598, -0.0034664951769085074, 0.0011762399596598715, -0.0007898008205746509, 0.006444247690148949, -0.003819776035980969, -0.0020772789637565664, 0.001009537212192474, 0.005779083941143093, 0.004638328273541791, -0.0034573572109291026, -0.005771200717736158, 0.008011415609370789, -0.009371145015753236, 0.004204109682102944, -0.002782366082426328, -0.0015314698379457164, -0.004703923354206159, 0.004845780268916264, -0.005270440278336256, 0.0055539015537614984, -0.0004591639673585049, 0.004209950654303729, 0.009629741279506186, 0.007415922817137806, 0.0005667064274581014, -0.011388210912099498, -0.016711900480064757, 0.013172840056178055, 0.010705338108797098, -0.0017744067038100103, -0.006893820933034571, -0.0046496421228401615, 0.00551451850658653, 0.0016256172081389622, 0.006496715572870591, -0.004108810868810835, -0.0008028827953097111, 0.0046201368980633775, 0.00283057175074474, 0.0014800816511559836, 0.0025913363094932132, 0.0007153725616448679, 0.005796419521679462, -0.004775197826746996, -0.0015856005759080918, -0.0016710263627376242, 0.0025869295188825736, 0.0002038035528504539, -0.0031579247079341517, -0.0031026295011841293, -0.006925894069320585, -0.006005391673214559, -0.016348111988514262, 0.015374776342428401, 0.0015949445992293624, -0.002107153075679429, 0.008434977119029815, 0.0088368402243734, -0.0022625026414554586, -0.0009424411961503415, 0.00605543659876799]}],
                        {"font": {"size": 15}, "height": 600, "legend": {"bgcolor": "White", "bordercolor": "white", "borderwidth": 2, "font": {"color": "black", "family": "sans-serif", "size": 20}, "traceorder": "normal", "x": 0, "y": 1}, "paper_bgcolor": "rgba(1, 1, 0, 0)", "plot_bgcolor": "rgba(1, 1, 0, 0)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "Daily Return of A2C & PPO", "x": 0.48, "xanchor": "center", "y": 0.87, "yanchor": "top"}, "width": 900, "xaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Date"}}, "yaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Daily Return"}, "zeroline": true, "zerolinecolor": "Grey", "zerolinewidth": 1}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('25df5e85-cb7e-4e9c-940c-a8eb78d283b5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3.4.3-Inspect-cumulative-return">
<a class="anchor" href="#3.4.3-Inspect-cumulative-return" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4.3 Inspect cumulative return<a class="anchor-link" href="#3.4.3-Inspect-cumulative-return"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we inspect the cumulative return of the portfolio brought about by each of the agents. The DJIA index is used as a baseline for reference. Both agents end up with a larger cumulative return than the DJIA.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">900</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dji_cumpod</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'DJIA'</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"#a9a9a9"</span><span class="p">)))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">a2c_cumpod</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'A2C'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_ind</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ppo_cumpod</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'PPO'</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">traceorder</span><span class="o">=</span><span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="s2">"sans-serif"</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span>
        <span class="p">),</span>
        <span class="n">bgcolor</span><span class="o">=</span><span class="s2">"White"</span><span class="p">,</span>
        <span class="n">bordercolor</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span>
        <span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span> <span class="s2">"Cumulative Return of A2C &amp; PPO against DJIA"</span><span class="p">,</span>
        <span class="s1">'y'</span><span class="p">:</span> <span class="mf">0.92</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span> <span class="mf">0.48</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span> <span class="s1">'center'</span><span class="p">,</span>
        <span class="s1">'yanchor'</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">'rgba(1, 1, 0, 0)'</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Cumulative Return"</span><span class="p">),</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="c1"># fig.update_layout(font_size = 20)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">'Black'</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zerolinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">'Grey'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="5d1a72a6-df1c-4103-b75c-d6f3259dcb8c" class="plotly-graph-div" style="height:900px; width:900px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("5d1a72a6-df1c-4103-b75c-d6f3259dcb8c")) {
                    Plotly.newPlot(
                        '5d1a72a6-df1c-4103-b75c-d6f3259dcb8c',
                        [{"line": {"color": "#a9a9a9", "width": 2}, "mode": "lines", "name": "DJIA", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30"], "y": [null, 0.0035900049368924325, 0.021451689225469472, 0.006031053470604952, 0.01291272477375105, -0.0011222417817438046, 0.013224420655107982, 0.013632425782493796, 0.035267929817957455, 0.044108420380372326, 0.03884753730275681, 0.03640876558337114, 0.036755372617740756, 0.04295437909186228, 0.049382964343949176, 0.03564641225290388, 0.028557247270763586, 0.03302116944014255, 0.025036305701787942, 0.031264834868348634, 0.022486121868004583, 0.02694192339961754, 0.03611543600425149, 0.04249081969489921, 0.05698661347016465, 0.06419318617776382, 0.06600006602761543, 0.07990950421988563, 0.07584774335445332, 0.08711372421934693, 0.08400048420251371, 0.08533325541568781, 0.08198724908083133, 0.07939001108429133, 0.07607975073436779, 0.07790021557637017, 0.08530646490044091, 0.0999997343716621, 0.09766744166896602, 0.10091129493435425, 0.10714210091524179, 0.11342147893510401, 0.10472442767528567, 0.11310249724790111, 0.13077649614212827, 0.0993884856186924, 0.09319380509179198, 0.06861946501693783, 0.08570050556662157, 0.0699285573611117, 0.07502125975377805, 0.08775449566475624, 0.08784268427301933, 0.08927191651984412, 0.08420486623526124, 0.07470182270370973, 0.05489528361706886, 0.06035402185969452, 0.039951868145128966, 0.04198445618859026, 0.055915751798398805, 0.07185125116639313, 0.06674534325063086, 0.0795310217849392, 0.08089885593874802, 0.0756884422453794, 0.09378949561352767, 0.07918365581246056, 0.09980544621576404, 0.10454797456494846, 0.11081923194704446, 0.1205576980800005, 0.1144295005314464, 0.10798649545528893, 0.1072170840004083, 0.11157346463974527, 0.09560722827833734, 0.10001248453189238, 0.0962056509772653, 0.10214464525525124, 0.10105314046692104, 0.07578831850052015, 0.06715448678517966, 0.030502405644070807, 0.03590983967052974, 0.029789383290687255, 0.04624369274997808, 0.0678088432227395, 0.08209410756657487, 0.10317513141962009, 0.10058024613121797, 0.13300967152779153, 0.14322725528894464, 0.1423222974878009, 0.12998651746449386, 0.1455156054751312, 0.16380312993665513, 0.15731041441435978, 0.14390726383458796, 0.14564849553801307, 0.13710953108629464, 0.14984663758162853, 0.16752572136118582, 0.1607734490056203, 0.16224609251227862, 0.15168736607114064, 0.158886880654326, 0.16121325363977235, 0.16454453657531465, 0.1742099928621872, 0.16844077303917926, 0.17248553369097053, 0.16840275023991946, 0.16570017163385353, 0.16753073035270516, 0.16034912670889145, 0.1734736711088578, 0.17173395728165053, 0.17751714156586385, 0.17268642460841632, 0.17413963929948495, 0.16633160814052195, 0.17077382467998437, 0.17349537673877458, 0.18142627997758098, 0.1787722734104895, 0.18164348806437003, 0.18929532976050556, 0.17442879471900485, 0.18094556857935506, 0.197957469867311, 0.20618481433148372, 0.2083934760162276, 0.2049242181324733, 0.2072556760032498, 0.20693631484699226, 0.20425703564087194, 0.1973691410452323, 0.20188672013891606, 0.21190660052268084, 0.21142588912445515, 0.2044692347361421, 0.2030322613206057, 0.20214005367969268, 0.17750940039715246, 0.18917405145069144, 0.16505355636500552, 0.17396326208295898, 0.19244279788605412, 0.19384630213098464, 0.20675712955946324, 0.21034683092111206, 0.21957627726437767, 0.21919043312977404, 0.2215984678557461, 0.22132251795932234, 0.22239891987928395, 0.2248993932669292, 0.22840705341899747, 0.22375658426243206, 0.22379468295550264, 0.22485818292761173, 0.22546669950338916, 0.24196214340818667, 0.2202077137710463, 0.20195859157783658, 0.2253952075335237, 0.2198000881127149, 0.2150816181015851, 0.20163885095252465, 0.22387163927975307, 0.23576746288128625, 0.2369448794635527, 0.2549856731458482, 0.2623130688003963, 0.27370032797510424, 0.2804934312009326, 0.2755386278626675, 0.2828991132187668, 0.27695116347109483, 0.26784565172102526, 0.27185686730839964, 0.2598868195598085, 0.2597667555509684, 0.26751574132505307, 0.2851337305868378, 0.2889609036827854, 0.2849037723398178, 0.2815849359892628, 0.288255243029059, 0.30278723815212283, 0.2990198693791626, 0.299642502203767, 0.30186937840312633, 0.3134113091644435, 0.31126624649323187, 0.30861891858149937, 0.310702507265884, 0.32255787946620873, 0.32895709381347826, 0.32417593551454704, 0.314215631772337, 0.3264949468003362, 0.31400570949139395, 0.3228493117000557, 0.3204433261069779, 0.3205738634617219, 0.3141798098935933, 0.32350488243858977, 0.31629648827952916, 0.3255593278995894, 0.32632873935447004, 0.33010992080101365, 0.3424740851095964, 0.351381438119412, 0.3500236978424527, 0.3316183861864157, 0.3051369105375141, 0.3219929259378862, 0.33600808420873673, 0.3338965666019418, 0.32351657008546764, 0.31711978434014676, 0.324429269055323, 0.3292356240994725, 0.3364686078532637, 0.3333009519740169, 0.333712448216704, 0.33921429414391957, 0.3417326025771259, 0.34351458925700307, 0.3444887622136854, 0.3435818311734584, 0.3505510080405694, 0.345649026794689, 0.34446705658376864, 0.33853428559827603, 0.33927637528123333, 0.33979564073539503, 0.336459652383577, 0.3327906419895401, 0.32246786940648287, 0.3142991149643233, 0.2935735777215227, 0.3163787571705412, 0.3190447549597544, 0.31627265762290624, 0.32880743121838685, 0.3380174487460623, 0.33216664307633925, 0.3325171206950648, 0.34068587513722437]}, {"line": {"width": 2}, "mode": "lines", "name": "A2C", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30"], "y": [0.0, 0.005267264981902331, 0.0203571787265322, 0.006455063128049776, 0.011963654422877834, -0.0038684969805972136, 0.012235688275118006, 0.012038185140669455, 0.033469651943063505, 0.04049714028203644, 0.03911857474503577, 0.038980576973235426, 0.0379409619306188, 0.04540990914685761, 0.051242162668138524, 0.04040747416188384, 0.03345629423136098, 0.03548206213251626, 0.030602102772987694, 0.036573183917415486, 0.026931733146273507, 0.02444834519343453, 0.03192978756176856, 0.03503491739917486, 0.05028234422840794, 0.054586513721679886, 0.060308945112119705, 0.0734572401864153, 0.07131877278994758, 0.08107608146257017, 0.07561580786566857, 0.07647026920345801, 0.07200416893915706, 0.06937137746049804, 0.06395507887501917, 0.063850163913439, 0.06643951122451841, 0.0798676685655153, 0.08288387086307081, 0.08796974935824409, 0.09804778346154763, 0.10421838193422683, 0.09590665054605019, 0.09910454406902347, 0.11974543563003004, 0.09323560221562088, 0.09072306035259214, 0.06589191784584458, 0.08166633879010021, 0.06541659862358018, 0.07258533506146114, 0.08223457645595666, 0.07900349944665597, 0.08258525854219378, 0.08048872422216213, 0.07134155596929315, 0.051196502287359724, 0.05496149014245777, 0.034350780739220044, 0.03639831185927389, 0.048895651984652844, 0.06497793292480591, 0.05767400179302906, 0.06905536308181892, 0.06742279447225852, 0.06551013010286266, 0.08338643763413667, 0.07100167378937594, 0.09118339563999567, 0.10378247899318382, 0.10812690728260166, 0.11709163178533699, 0.10866440040652292, 0.10388674032091316, 0.10577898022335552, 0.10974198725461459, 0.093538291757439, 0.09860023443383725, 0.09692542310006647, 0.10652312311499612, 0.10482755578954284, 0.08031676823764156, 0.06951004147750295, 0.0332136670690395, 0.03867841079908074, 0.03627601537474079, 0.05538155480702489, 0.07550270383320057, 0.07781621502699121, 0.09916103738552695, 0.09654331736100996, 0.139354221651387, 0.15463718975888452, 0.15361446607220675, 0.14175225088875232, 0.1599336896340411, 0.18084312727132468, 0.17107863360424203, 0.15541823898397134, 0.15747790519781257, 0.15201460844713077, 0.16423746328619604, 0.18342875139359283, 0.17673047192153213, 0.17690437942952708, 0.16500901774529808, 0.1754221177831803, 0.1829145645303687, 0.18789969146175323, 0.1998926144368347, 0.18918709199907768, 0.19407463741808306, 0.19185368166027073, 0.18963112900494417, 0.19079505571118904, 0.18031920459786432, 0.19361363726974323, 0.1914586506847531, 0.19629544727995452, 0.19176231782062114, 0.19043227050095424, 0.18184389749287333, 0.18694144608587582, 0.19013137243352407, 0.19643425344703558, 0.1945872035310552, 0.19607863444203244, 0.20472502768870582, 0.1913729527775827, 0.1975672248207032, 0.2172957792468435, 0.22445867578837442, 0.22570469485249745, 0.22507248565888394, 0.22981125153307613, 0.23052281273621777, 0.23174698995199372, 0.2225959159512816, 0.22917476659870983, 0.23750602501381346, 0.23591134819497328, 0.22477324802725662, 0.2265856216466684, 0.22513177101366488, 0.20755933893453649, 0.2200224421114758, 0.19375449399823363, 0.2015770265697121, 0.2139192889501118, 0.21624782574849166, 0.2270141327196986, 0.23283829898087216, 0.24376245763688908, 0.24381355790646198, 0.24670625550220082, 0.24679010374958166, 0.24905272628583663, 0.25038745096348336, 0.2565642607656198, 0.2545617026250706, 0.25424003030541464, 0.2583048962563024, 0.26027692366966826, 0.27594819647087787, 0.25885955728187393, 0.24019481817199484, 0.26262658972330466, 0.25642139852714196, 0.2541234382699733, 0.2417222727664401, 0.2674329790002732, 0.2795826107832542, 0.28040395950387476, 0.29845623026280577, 0.3032295493193171, 0.3142673082590002, 0.3221682104671926, 0.31656006921385593, 0.3216417635881026, 0.3129074232379392, 0.303553560033643, 0.3082336486669546, 0.29886465353992664, 0.3020833518042525, 0.3115215843076522, 0.33265033419525936, 0.3362777087662274, 0.33014668207956976, 0.3262559087210726, 0.3305296855579041, 0.3461247327081036, 0.34022617891567086, 0.342897187825552, 0.34280361901897294, 0.35387884437308004, 0.3504941440234086, 0.3457504415552157, 0.34669686707724856, 0.3554306019524238, 0.3634468247542948, 0.359824865647302, 0.35291639773295636, 0.36621340895909293, 0.35206091135765605, 0.3593918419987583, 0.3530392552605004, 0.3519535402088505, 0.3490479099112671, 0.3574887364087025, 0.3499929766478822, 0.3615625319281861, 0.36372864679141603, 0.36836471678744287, 0.38182337216833084, 0.3889177470787355, 0.3906471399595912, 0.3714565529197187, 0.34750319987810285, 0.366247808000459, 0.3798976746264129, 0.3792365472922017, 0.3667033679505236, 0.3606770086632183, 0.3683272903959618, 0.37159243465114766, 0.37985595160142105, 0.3756958827110337, 0.37486554911485026, 0.3799308282525202, 0.3818071551911728, 0.38245788354666566, 0.386152604728079, 0.38685315120521313, 0.39450582177827287, 0.388404054439079, 0.38605032748480195, 0.38023251561274773, 0.3848244350404897, 0.3843844599711925, 0.38162133206235804, 0.37911972265775007, 0.36974674405052665, 0.3592516571917761, 0.3365147448282839, 0.35918913413259057, 0.3608145710996109, 0.35641911402671766, 0.3672664372812613, 0.3767239888532592, 0.3720445970108601, 0.3711723830044542, 0.38132559034015734]}, {"line": {"width": 2}, "mode": "lines", "name": "PPO", "type": "scatter", "x": ["2020-07-01", "2020-07-02", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-27", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31", "2021-01-04", "2021-01-05", "2021-01-06", "2021-01-07", "2021-01-08", "2021-01-11", "2021-01-12", "2021-01-13", "2021-01-14", "2021-01-15", "2021-01-19", "2021-01-20", "2021-01-21", "2021-01-22", "2021-01-25", "2021-01-26", "2021-01-27", "2021-01-28", "2021-01-29", "2021-02-01", "2021-02-02", "2021-02-03", "2021-02-04", "2021-02-05", "2021-02-08", "2021-02-09", "2021-02-10", "2021-02-11", "2021-02-12", "2021-02-16", "2021-02-17", "2021-02-18", "2021-02-19", "2021-02-22", "2021-02-23", "2021-02-24", "2021-02-25", "2021-02-26", "2021-03-01", "2021-03-02", "2021-03-03", "2021-03-04", "2021-03-05", "2021-03-08", "2021-03-09", "2021-03-10", "2021-03-11", "2021-03-12", "2021-03-15", "2021-03-16", "2021-03-17", "2021-03-18", "2021-03-19", "2021-03-22", "2021-03-23", "2021-03-24", "2021-03-25", "2021-03-26", "2021-03-29", "2021-03-30", "2021-03-31", "2021-04-01", "2021-04-05", "2021-04-06", "2021-04-07", "2021-04-08", "2021-04-09", "2021-04-12", "2021-04-13", "2021-04-14", "2021-04-15", "2021-04-16", "2021-04-19", "2021-04-20", "2021-04-21", "2021-04-22", "2021-04-23", "2021-04-26", "2021-04-27", "2021-04-28", "2021-04-29", "2021-04-30", "2021-05-03", "2021-05-04", "2021-05-05", "2021-05-06", "2021-05-07", "2021-05-10", "2021-05-11", "2021-05-12", "2021-05-13", "2021-05-14", "2021-05-17", "2021-05-18", "2021-05-19", "2021-05-20", "2021-05-21", "2021-05-24", "2021-05-25", "2021-05-26", "2021-05-27", "2021-05-28", "2021-06-01", "2021-06-02", "2021-06-03", "2021-06-04", "2021-06-07", "2021-06-08", "2021-06-09", "2021-06-10", "2021-06-11", "2021-06-14", "2021-06-15", "2021-06-16", "2021-06-17", "2021-06-18", "2021-06-21", "2021-06-22", "2021-06-23", "2021-06-24", "2021-06-25", "2021-06-28", "2021-06-29", "2021-06-30"], "y": [0.0, 0.004899029362063434, 0.02269471260370115, 0.010152557473626533, 0.01557241618371541, 0.0017873546593201173, 0.01664818032751758, 0.01497255764907468, 0.0347953744907985, 0.04219161961363871, 0.04055447874768037, 0.04156370239465246, 0.04060116806342218, 0.04664289203143923, 0.05150394294564342, 0.04202393638073487, 0.02915967728652813, 0.031101922878737254, 0.024614444548692216, 0.029737678045933524, 0.018825565847746528, 0.016384989497505442, 0.02133908403250384, 0.025787453375680558, 0.036240464158009855, 0.04021940174106153, 0.04282727779576412, 0.055634780584106425, 0.0527654855198727, 0.0622988450836206, 0.057988136892018316, 0.059651888204687475, 0.053322290530870786, 0.05193141720708594, 0.04787535348786309, 0.04800580480188765, 0.04996127368956116, 0.0617956741311918, 0.06562064684447444, 0.07523366997541969, 0.08492875942447387, 0.0882944129966654, 0.08023239661188208, 0.08460707440610338, 0.1032269074151555, 0.07717810852483087, 0.07822205826847872, 0.05570119185913436, 0.07010797066125685, 0.05460304643711478, 0.06157624948534002, 0.07184019724548785, 0.06930472034205071, 0.07548948376671394, 0.0714923389944302, 0.06291028017186262, 0.04015892508258201, 0.046140209128678444, 0.027419376124960593, 0.02866791176972594, 0.04101233591543174, 0.05658622688799886, 0.04987511377126741, 0.060871205658738825, 0.060219366441093936, 0.05399651206724232, 0.0722306224946101, 0.05983427581621714, 0.078144537794677, 0.08433415590048154, 0.08535472432602065, 0.09569528504654934, 0.08956917161516897, 0.08357004582408178, 0.08383379129814461, 0.08652174430306725, 0.07119892736497868, 0.07553329979186896, 0.07433924608889719, 0.08269577731221056, 0.08022947668584934, 0.05619351094682412, 0.045630493135441874, 0.012032000549012878, 0.016675801436235593, 0.013531400831296114, 0.030019677362134845, 0.04835542292045325, 0.05222279183059708, 0.0725548125416966, 0.07095321710701175, 0.11376050390704662, 0.12680554713687475, 0.12831746186696158, 0.11485035828149726, 0.1371027028775489, 0.15790260744382612, 0.15028516345015808, 0.1364042529569338, 0.13785601467168762, 0.13042985618682956, 0.14479701348203444, 0.16306937026924162, 0.1593354940485443, 0.1588735117594804, 0.14794826495013091, 0.15568994227161093, 0.15870973037640024, 0.16678517825797812, 0.1766923364613997, 0.16870274642646477, 0.17330446584171266, 0.17058607645631252, 0.16782245189341238, 0.16920321191897947, 0.16257786182127787, 0.1743141491119431, 0.17058174354286204, 0.17466974405018565, 0.16829696564809393, 0.16761264321070657, 0.15818336194642124, 0.16166783332752344, 0.16461180310230827, 0.17053835254675187, 0.1667914775977828, 0.1688913987480709, 0.17746396008621979, 0.1649302833728159, 0.17018139267080534, 0.1896902866853607, 0.2005298898400354, 0.20235382321808615, 0.20184960456586376, 0.20663951814682635, 0.2052591763797229, 0.20419097275899678, 0.1974012800208429, 0.20154897528804527, 0.21265638087092387, 0.21015900654160768, 0.19992933177765426, 0.19994427953394256, 0.1986980200741817, 0.17511440684938528, 0.18669099466244488, 0.1656284521954865, 0.17464884730796126, 0.19086106908085743, 0.1920999628531468, 0.20352545072546246, 0.20966660163213557, 0.2206283296041207, 0.22151484508636443, 0.22234142655018507, 0.2220416849044855, 0.22383906928209352, 0.22423493355065216, 0.23142907524177536, 0.22860525463391612, 0.23095685626168683, 0.23184010034632574, 0.2321205016956156, 0.24737057140483798, 0.22837709363372238, 0.21096503695725377, 0.23384878876796922, 0.22773055935449804, 0.22329308492373512, 0.2122324480928861, 0.23703386223738065, 0.2466596130403811, 0.25306173922145625, 0.27090843882226756, 0.27511578955941407, 0.28121432812728386, 0.2933329844226997, 0.2920012976561235, 0.2978026359073471, 0.2910654452116257, 0.2859909384485704, 0.2923447761309872, 0.28213573513876167, 0.28292630515864037, 0.29085453732396305, 0.31115629772275155, 0.3152331412691851, 0.30783713786261524, 0.3038279121603513, 0.30754713700910785, 0.3241595813998077, 0.319569388597428, 0.32112151884184015, 0.32007809598218007, 0.32858500620302955, 0.32351010903457156, 0.3207608093267549, 0.3220941665121757, 0.3297346596785453, 0.3359024055468409, 0.331283713731926, 0.32360060820772585, 0.33420452278089385, 0.3217014987172404, 0.32725807678484764, 0.3235651589293751, 0.3215381588099189, 0.3153217446012184, 0.32169550475848374, 0.31472958753450864, 0.3220314662334929, 0.3214244370204844, 0.3269875686937316, 0.33976611566137316, 0.3497017177681343, 0.3504666024067449, 0.33508720390879043, 0.3127753594248588, 0.3300683392642543, 0.3443071705438845, 0.3419218228884915, 0.3326708541353669, 0.3264744115960978, 0.333789279287358, 0.33595751009179886, 0.3446368460523057, 0.33911198756464245, 0.33803683758883385, 0.344218750953146, 0.34802365857641515, 0.3500188436587983, 0.3535171965068713, 0.35448546557096683, 0.3623366315654335, 0.3558312046430845, 0.3536813979041682, 0.3514193606015228, 0.3549153872378521, 0.3551915238075829, 0.35091193101056795, 0.346720551799913, 0.3373933079171698, 0.32936173728199125, 0.3076291827276594, 0.32773368895092947, 0.3298513506273366, 0.3270491502636659, 0.3382427794819678, 0.3500686171056715, 0.3470140832933237, 0.34574460172943344, 0.35389367284334017]}],
                        {"font": {"size": 15}, "height": 900, "legend": {"bgcolor": "White", "bordercolor": "white", "borderwidth": 2, "font": {"color": "black", "family": "sans-serif", "size": 16}, "traceorder": "normal", "x": 0, "y": 1}, "paper_bgcolor": "rgba(1, 1, 0, 0)", "plot_bgcolor": "rgba(1, 1, 0, 0)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "Cumulative Return of A2C & PPO against DJIA", "x": 0.48, "xanchor": "center", "y": 0.92, "yanchor": "top"}, "width": 900, "xaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Date"}}, "yaxis": {"gridcolor": "Black", "gridwidth": 1, "linecolor": "black", "mirror": true, "showgrid": false, "showline": true, "title": {"text": "Cumulative Return"}, "zeroline": true, "zerolinecolor": "Grey", "zerolinewidth": 1}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('5d1a72a6-df1c-4103-b75c-d6f3259dcb8c');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

</div>


</body>
  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="LearnableLoopAI/portfolio2"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/portfolio2/investment_industry/reinforcement_learning/a2c/ppo/openai/gym/finrl/stable_baselines3/pyfolio/2021/11/11/PortfolioManagement.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/portfolio2/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/portfolio2/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/portfolio2/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Portfolio of Data Science Projects</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/LearnableLoopAI" title="LearnableLoopAI"><svg class="svg-icon grey"><use xlink:href="/portfolio2/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/portfolio2/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
